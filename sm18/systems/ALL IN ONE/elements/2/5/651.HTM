<h1 id="nav_point_217">&#31532; 14 &#31456;&#12288;&#26381;&#21153;&#37197;&#32622;&#31649;&#29702;</h1><blockquote>
<p><strong>&#26412;&#31456;&#20869;&#23481;</strong></p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">Spring Cloud Config &#30340;&#22522;&#26412;&#29992;&#27861;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">Spring Cloud Config &#30340;&#23454;&#29616;&#21407;&#29702;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#20960;&#31181;&#24120;&#29992;&#30340;&#37197;&#32622;&#20013;&#24515;</li>
</ul>
</blockquote><p>&#22312;&#19968;&#20010;&#22797;&#26434;&#31995;&#32479;&#20013;&#65292;&#19968;&#23450;&#20250;&#23384;&#22312;&#22823;&#37327;&#30340;&#37197;&#32622;&#65292;&#29305;&#21035;&#26159;&#36825;&#20010;&#31995;&#32479;&#30001;&#22823;&#37327;&#24494;&#26381;&#21153;&#26500;&#25104;&#26102;&#65292;&#38382;&#39064;&#20250;&#26356;&#21152;&#20005;&#37325;&#65292;&#22240;&#20026;&#36825;&#20123;&#37197;&#32622;&#21487;&#33021;&#25955;&#33853;&#22312;&#21508;&#22788;&#65292;&#31649;&#29702;&#36215;&#26469;&#38750;&#24120;&#40635;&#28902;&#12290;Spring Cloud &#26082;&#28982;&#26159;&#22823;&#37327;&#20248;&#31168;&#23454;&#36341;&#30340;&#27785;&#28096;&#65292;&#33258;&#28982;&#20063;&#27880;&#24847;&#21040;&#20102;&#36825;&#20010;&#38382;&#39064;&#65292;&#20026;&#25105;&#20204;&#25552;&#20379;&#20102;&#19968;&#22871;&#27604;&#36739;&#25104;&#29087;&#30340;&#35299;&#20915;&#26041;&#26696;&#12290;&#20363;&#22914;&#65292;&#22312;&#19978;&#19968;&#31456;&#20171;&#32461; Netflix OSS &#26102;&#23601;&#25552;&#21040;&#20102;&#20998;&#24067;&#24335;&#37197;&#32622;&#20013;&#24515; Archaius&#12290;&#26412;&#31456;&#20013;&#65292;&#35753;&#25105;&#20204;&#30475;&#30475;&#22914;&#20309;&#22312; Spring Cloud Config &#30340;&#24110;&#21161;&#19979;&#35299;&#20915;&#24494;&#26381;&#21153;&#30340;&#37197;&#32622;&#31649;&#29702;&#38590;&#39064;&#12290;</p><h2 id="nav_point_218">14.1&#12288;&#20351;&#29992; Spring Cloud Config &#23454;&#29616;&#37197;&#32622;&#31649;&#29702;</h2><p>&#22312; Spring Cloud &#30340;&#24120;&#29992;&#21151;&#33021;&#20013;&#65292;&#19982;&#26381;&#21153;&#21457;&#29616;&#21516;&#31561;&#37325;&#35201;&#30340;&#24212;&#35813;&#23601;&#26159;&#26381;&#21153;&#37197;&#32622;&#31649;&#29702;&#20102;&#12290;&#26412;&#33410;&#20013;&#25105;&#20204;&#23601;&#26469;&#19968;&#36215;&#20102;&#35299;&#19968;&#19979;&#37197;&#32622;&#35813;&#22914;&#20309;&#31649;&#29702;&#65292;Spring Cloud &#25552;&#20379;&#20102;&#21738;&#20123;&#20415;&#20110;&#37197;&#32622;&#31649;&#29702;&#30340;&#32452;&#20214;&#65292;&#36825;&#20123;&#32452;&#20214;&#21448;&#33021;&#22914;&#20309;&#20445;&#25252;&#25105;&#20204;&#30340;&#37197;&#32622;&#39033;&#12290;</p><h3 id="nav_point_219">14.1.1&#12288;&#20026;&#20309;&#38656;&#35201;&#37197;&#32622;&#20013;&#24515;</h3><p>&#8220;&#26089;&#26399;&#30340;&#31995;&#32479;&#24182;&#19981;&#22797;&#26434;&#65292;&#24320;&#21457;&#36816;&#32500;&#20063;&#27604;&#36739;&#31616;&#21333;&#31895;&#26292;&#65292;&#24320;&#21457;&#32773;&#20204;&#27809;&#26377;&#22826;&#22810;&#37197;&#32622;&#30340;&#27010;&#24565;&#65292;&#25152;&#26377;&#19996;&#35199;&#30828;&#32534;&#30721;&#19968;&#19979;&#65292;&#22914;&#26524;&#38656;&#35201;&#38024;&#23545;&#26032;&#29615;&#22659;&#20570;&#20123;&#35843;&#25972;&#65292;&#37027;&#23601;&#22312;&#20195;&#30721;&#37324;&#25913;&#25913;&#65292;&#37325;&#26032;&#25171;&#20010;&#21253;&#21457;&#19978;&#21435;&#12290;&#8221;&#22914;&#26524;&#26377;&#20154;&#26159;&#36825;&#20040;&#21578;&#35785;&#20320;&#30340;&#65292;&#37027;&#35201;&#20040;&#20182;&#26159;&#20010;&#20960;&#21313;&#24180;&#21069;&#30340;&#8220;&#21476;&#33891;&#8221;&#31243;&#24207;&#21592;&#65292;&#23436;&#20840;&#19981;&#25509;&#35302;&#26032;&#25216;&#26415;&#65292;&#35201;&#20040;&#23601;&#26159;&#20182;&#26681;&#26412;&#19981;&#25026;&#36719;&#20214;&#24320;&#21457;&#19982;&#36816;&#32500;&#12290;</p><p>&#22312; Java &#31995;&#32479;&#20013;&#65292;&#21487;&#20197;&#36890;&#36807; <code>-D</code> &#22312;&#21629;&#20196;&#34892;&#20013;&#20256;&#20837;&#31995;&#32479;&#21442;&#25968;&#65292;&#21738;&#24597;&#26159;&#21551;&#21160; Tomcat &#36825;&#26679;&#30340;&#23481;&#22120;&#65292;&#20063;&#33021;&#22312;&#20195;&#30721;&#37324;&#36731;&#26494;&#33719;&#21462; <code>-D</code> &#20256;&#20837;&#30340;&#31995;&#32479;&#21442;&#25968;&#12290;&#20687;&#25968;&#25454;&#24211;&#36830;&#25509;&#27744;&#37197;&#32622;&#36825;&#26679;&#30340;&#20869;&#23481;&#65292;&#38543;&#30528;&#29615;&#22659;&#30340;&#21464;&#21270;&#19968;&#23450;&#20250;&#21464;&#65292;&#25105;&#20204;&#21487;&#20197;&#23558;&#25968;&#25454;&#28304;&#37197;&#32622;&#22312;&#23481;&#22120;&#37324;&#65292;&#28982;&#21518;&#20197; JNDI&#65288;Java Naming and Directory Interface&#65292;Java &#21629;&#21517;&#21644;&#30446;&#24405;&#25509;&#21475;&#65289;&#30340;&#26041;&#24335;&#33719;&#21462;&#25968;&#25454;&#28304;&#12290;&#25152;&#20197;&#35828;&#22312; Java &#31995;&#32479;&#37324;&#19981;&#32570;&#37197;&#32622;&#30340;&#25163;&#27573;&#65292;&#21482;&#26159;&#37197;&#32622;&#36215;&#26469;&#31616;&#21333;&#19968;&#20123;&#25110;&#32773;&#22797;&#26434;&#19968;&#20123;&#32780;&#24050;&#12290;</p><p>&#20294;&#23545;&#22823;&#37096;&#20998;&#24320;&#21457;&#32773;&#26469;&#35828;&#65292;&#26356;&#29087;&#24713;&#30340;&#26041;&#24335;&#24212;&#35813;&#26159;&#23558;&#38656;&#35201;&#21464;&#21160;&#30340;&#20869;&#23481;&#20316;&#20026;&#37197;&#32622;&#39033;&#25277;&#35937;&#20986;&#26469;&#65292;&#38543;&#21518;&#23558;&#20854;&#20889;&#22312;&#19968;&#20010;&#25110;&#20960;&#20010;&#37197;&#32622;&#25991;&#20214;&#37324;&#65292;&#36935;&#21040;&#19981;&#21516;&#30340;&#29615;&#22659;&#23601;&#36873;&#25321;&#21152;&#36733;&#19981;&#21516;&#30340;&#37197;&#32622;&#25991;&#20214;&#12290;&#36890;&#24120;&#30456;&#20851;&#21151;&#33021;&#20250;&#27785;&#28096;&#21040;&#24320;&#21457;&#26694;&#26550;&#37324;&#65292;&#30001;&#26694;&#26550;&#26469;&#25552;&#20379;&#36825;&#20123;&#22522;&#30784;&#30340;&#33021;&#21147;&#65292;&#24320;&#21457;&#32773;&#33258;&#24049;&#24182;&#19981;&#38656;&#35201;&#22826;&#25805;&#24515;&#12290;&#22914;&#26524;&#26159;&#20010;&#21333;&#20307;&#24212;&#29992;&#65292;&#21482;&#26377;&#19968;&#20010;&#22823;&#38598;&#32676;&#65292;&#29992;&#36825;&#20010;&#26041;&#24335;&#26469;&#31649;&#29702;&#37197;&#32622;&#36824;&#22909;&#65307;&#20294;&#21040;&#20102;&#24494;&#26381;&#21153;&#30340;&#26102;&#20195;&#65292;&#19968;&#20010;&#20998;&#24067;&#24335;&#31995;&#32479;&#28041;&#21450;&#20960;&#21313;&#20010;&#12289;&#19978;&#30334;&#20010;&#29978;&#33267;&#19978;&#21315;&#20010;&#24494;&#26381;&#21153;&#65292;&#27599;&#20010;&#24494;&#26381;&#21153;&#36824;&#26377;&#22810;&#20010;&#23454;&#20363;&#65292;&#36825;&#20040;&#22810;&#37197;&#32622;&#25991;&#20214;&#30340;&#31649;&#29702;&#23601;&#21464;&#25104;&#20102;&#38590;&#39064;&#65292;&#23601;&#31639;&#29992; Puppet &#38598;&#20013;&#31649;&#29702;&#21193;&#24378;&#21487;&#20197;&#36807;&#24471;&#21435;&#65292;&#20294;&#26032;&#38382;&#39064;&#21448;&#25509;&#36405;&#32780;&#33267;&#12290;</p><p>&#20462;&#25913;&#37197;&#32622;&#25991;&#20214;&#21518;&#65292;&#24456;&#22810;&#24773;&#20917;&#19979;&#38656;&#35201;&#37325;&#21551;&#24212;&#29992;&#25165;&#33021;&#35753;&#37197;&#32622;&#29983;&#25928;&#65307;&#20294;&#25105;&#20204;&#21448;&#24076;&#26395;&#37197;&#32622;&#21464;&#26356;&#33021;&#24555;&#36895;&#29983;&#25928;&#8212;&#8212;&#19981;&#35201;&#37325;&#21551;&#23601;&#33021;&#29983;&#25928;&#65292;&#32780;&#19988;&#33021;&#24555;&#36895;&#24212;&#29992;&#21040;&#25972;&#20010;&#38598;&#32676;&#65292;&#36825;&#23601;&#38656;&#35201;&#37197;&#32622;&#21464;&#26356;&#25512;&#36865;&#12290;&#20363;&#22914;&#65292;&#29992; Zookeeper &#26469;&#31649;&#29702;&#37197;&#32622;&#65292;&#23458;&#25143;&#31471;&#30417;&#21548;&#26576;&#20010;&#33410;&#28857;&#30340;&#21464;&#21270;&#65292;&#22312;&#37197;&#32622;&#21464;&#26356;&#26102; Zookeeper &#33021;&#20027;&#21160;&#23558;&#21464;&#26356;&#25512;&#36865;&#36807;&#26469;&#65292;&#23458;&#25143;&#31471;&#22312;&#25910;&#21040;&#21464;&#26356;&#20449;&#24687;&#21518;&#20877;&#20570;&#23545;&#24212;&#30340;&#22788;&#29702;&#12290;</p><p>&#27492;&#22806;&#65292;&#22312;&#19968;&#20123;&#24212;&#29992;&#22330;&#26223;&#20013;&#65292;&#37197;&#32622;&#39033;&#30340;&#21464;&#26356;&#36824;&#19981;&#33021;&#21482;&#26159;&#31616;&#21333;&#22320;&#25226;&#20540;&#25913;&#20102;&#12290;&#35841;&#33021;&#20462;&#25913;&#37197;&#32622;&#38656;&#35201;&#26377;&#32479;&#19968;&#30340;&#26435;&#38480;&#31649;&#29702;&#65292;&#32780;&#25913;&#21464;&#37197;&#32622;&#36825;&#20010;&#21160;&#20316;&#26412;&#36523;&#20063;&#38656;&#35201;&#30041;&#19979;&#30165;&#36857;&#65292;&#21487;&#20379;&#36861;&#36394;&#23457;&#35745;&#12290;&#20877;&#36827;&#19968;&#27493;&#65292;&#26377;&#20123;&#37197;&#32622;&#39033;&#28041;&#21450;&#25935;&#24863;&#20449;&#24687;&#65292;&#36825;&#20123;&#25935;&#24863;&#20449;&#24687;&#38656;&#35201;&#25353;&#29031;&#25351;&#23450;&#30340;&#21152;&#23494;&#31639;&#27861;&#36827;&#34892;&#21152;&#23494;&#20445;&#23384;&#12290;&#35832;&#22914;&#27492;&#31867;&#30340;&#38468;&#21152;&#21151;&#33021;&#65292;&#22312;&#37329;&#34701;&#31561;&#39046;&#22495;&#36824;&#26159;&#27604;&#36739;&#24120;&#35265;&#30340;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#26222;&#36890;&#30340;&#37197;&#32622;&#25991;&#20214;&#24456;&#38590;&#28385;&#36275;&#25105;&#20204;&#30340;&#19994;&#21153;&#35201;&#27714;&#65292;&#26377;&#20010;&#19987;&#38376;&#30340;&#37197;&#32622;&#20013;&#24515;&#20250;&#26356;&#21152;&#26041;&#20415;&#12290;</p><p>&#32508;&#21512;&#19978;&#36848;&#24773;&#20917;&#65292;&#30446;&#21069;&#25105;&#20204;&#32463;&#24120;&#20351;&#29992;&#30340;&#37197;&#32622;&#26041;&#27861;&#26377;&#22914;&#19979;&#20960;&#31181;&#65306;<strong>&#29615;&#22659;&#21464;&#37327;</strong>&#12289;<strong>&#31995;&#32479;&#21442;&#25968;</strong>&#12289;<strong>&#37197;&#32622;&#25991;&#20214;</strong>&#21644;<strong>&#37197;&#32622;&#20013;&#24515;</strong>&#12290;&#22312;&#24403;&#19979;&#30340;&#24494;&#26381;&#21153;&#31995;&#32479;&#20013;&#65292;&#20351;&#29992;&#37197;&#32622;&#20013;&#24515;&#30340;&#26041;&#24335;&#24448;&#24448;&#26159;&#26356;&#21512;&#36866;&#30340;&#36873;&#25321;&#12290;</p><h3 id="nav_point_220">14.1.2&#12288;&#22522;&#20110; Spring Cloud Config Server &#30340;&#37197;&#32622;&#20013;&#24515;</h3><p>Spring Cloud Config &#26159; Spring Cloud &#20013;&#19987;&#38376;&#29992;&#26469;&#25552;&#20379;&#37197;&#32622;&#31649;&#29702;&#35299;&#20915;&#26041;&#26696;&#30340;&#32452;&#20214;&#65292;&#21516;&#26102;&#25552;&#20379;&#20102;&#26381;&#21153;&#31471;&#19982;&#23458;&#25143;&#31471;&#30340;&#25903;&#25345;&#12290;&#22312;&#26381;&#21153;&#31471;&#26041;&#38754;&#65292;&#23427;&#25552;&#20379;&#20102; Spring Cloud Config Server &#20316;&#20026;&#37197;&#32622;&#20013;&#24515;&#65288;14.1.3 &#33410;&#20250;&#35762; Spring Cloud Config Client&#65289;&#65292;&#21482;&#38656;&#19968;&#20010; <code>@EnableConfigServer</code> &#27880;&#35299;&#23601;&#33021;&#24320;&#21551;&#65292;&#36890;&#36807; <code>HTTP</code> &#25509;&#21475;&#21521;&#23458;&#25143;&#31471;&#25552;&#20379;&#37197;&#32622;&#20449;&#24687;&#65292;&#21487;&#20197;&#23454;&#29616;&#24212;&#29992;&#12289;Profile &#21644;&#26631;&#31614;&#30340;&#22810;&#37325;&#32452;&#21512;&#65292;&#32780;&#19988;&#20854;&#32972;&#21518;&#25903;&#25345;&#22810;&#31181;&#19981;&#21516;&#30340;&#23384;&#20648;&#21518;&#31471;&#65292;&#20855;&#20307;&#22914;&#34920; 14-1 &#25152;&#31034;&#12290;</p><p><strong>&#34920; 14-1&#12288;Spring Cloud Config Server &#25903;&#25345;&#30340;&#24120;&#29992;&#23384;&#20648;&#21518;&#31471;</strong></p><table border="1" width="90%">
<thead>
<tr>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#23384;&#20648;&#21518;&#31471;</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#35828;&#26126;</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">Git</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#40664;&#35748;&#30340;&#21518;&#31471;&#23384;&#20648;&#26041;&#24335;&#65292;&#26082;&#33021;&#25903;&#25345;&#26412;&#22320; Git &#20179;&#24211;&#65292;&#20063;&#21487;&#20197;&#25903;&#25345; SSH &#21644; HTTPS &#31561;&#26041;&#24335;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">JDBC</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#22312;&#20851;&#31995;&#22411;&#25968;&#25454;&#24211;&#20013;&#23384;&#20648;&#37197;&#32622;&#65292;&#22312; Spring JDBC &#30340;&#25903;&#25345;&#19979;&#65292;&#36890;&#36807;&#20960;&#24352;&#34920;&#23601;&#33021;&#23454;&#29616;&#37197;&#32622;&#30340;&#31649;&#29702;&#20102;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">Redis</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#22312; Redis &#20013;&#23384;&#20648;&#37197;&#32622;&#65292;&#20351;&#29992;&#30340;&#25968;&#25454;&#32467;&#26500;&#26159; Redis &#30340;&#25955;&#21015;&#34920;&#65292;&#20854;&#32972;&#21518;&#30340;&#21508;&#31181;&#25805;&#20316;&#26159;&#36890;&#36807; Spring Data Redis &#26469;&#23454;&#29616;&#30340;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#25991;&#20214;&#31995;&#32479;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#30452;&#25509;&#22312;&#26576;&#20010;&#26412;&#22320;&#30446;&#24405;&#20013;&#23384;&#20648;&#37197;&#32622;&#65292;&#36866;&#21512;&#22312;&#31616;&#21333;&#30340;&#22330;&#26223;&#20013;&#65292;&#20363;&#22914;&#26412;&#22320;&#27979;&#35797;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">Vault</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#24403;&#23384;&#20648;&#30340;&#20869;&#23481;&#20026;&#25935;&#24863;&#20449;&#24687;&#26102;&#65292;&#21487;&#20197;&#32771;&#34385;&#23558;&#20854;&#23384;&#20648;&#22312; HashiCorp Vault &#20013;</p></td>
</tr>
</tbody>
</table><p>&#25509;&#19979;&#26469;&#65292;&#35753;&#25105;&#20204;&#36890;&#36807;&#23454;&#38469;&#30340;&#20363;&#23376;&#26469;&#30475;&#30475; Spring Cloud Config Server &#30340;&#20855;&#20307;&#20351;&#29992;&#26041;&#24335;&#65292;&#20197;&#21450;&#22914;&#20309;&#36890;&#36807;&#23427;&#26469;&#25552;&#20379;&#37197;&#32622;&#31649;&#29702;&#26381;&#21153;&#65292;&#22312;&#20363;&#23376;&#20013;&#25105;&#20204;&#20250;&#20351;&#29992;&#30446;&#21069;&#27604;&#36739;&#22522;&#30784;&#30340; Git &#26469;&#23384;&#20648;&#37197;&#32622;&#12290;</p><blockquote>
<p><strong>&#38656;&#27714;&#25551;&#36848;</strong>&#12288;&#22902;&#33590;&#24215;&#26102;&#19981;&#26102;&#35201;&#25630;&#19968;&#20123;&#20419;&#38144;&#27963;&#21160;&#65292;&#20363;&#22914;&#20840;&#21333;&#25171;&#25240;&#65292;&#19981;&#21516;&#30340;&#38376;&#24215;&#36824;&#21487;&#20197;&#26377;&#19981;&#21516;&#30340;&#25240;&#25187;&#12290;&#36825;&#31181;&#38656;&#27714;&#24403;&#28982;&#21487;&#20197;&#36890;&#36807;&#22312;&#25968;&#25454;&#24211;&#37324;&#22686;&#21152;&#19968;&#24352;&#27963;&#21160;&#25240;&#25187;&#34920;&#26469;&#23454;&#29616;&#65292;&#20294;&#25105;&#20204;&#26159;&#19981;&#26159;&#20063;&#21487;&#20197;&#25226;&#25240;&#25187;&#35270;&#20026;&#19968;&#31181;&#37197;&#32622;&#21602;&#65311;&#19981;&#22914;&#20808;&#25630;&#20010;&#37197;&#32622;&#20013;&#24515;&#65292;&#25226;&#36825;&#20123;&#8220;&#37197;&#32622;&#39033;&#8221;&#38598;&#20013;&#31649;&#29702;&#36215;&#26469;&#21543;&#65281;</p>
</blockquote><ol>
<li><p><strong>&#25645;&#24314;&#22522;&#20110; Git &#30340;&#37197;&#32622;&#20013;&#24515;&#26381;&#21153;</strong></p>
<p>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807; Spring Initializr &#26469;&#29983;&#25104;&#29420;&#31435;&#30340; Spring Cloud Config Server &#39033;&#30446;&#65292;&#21482;&#38656;&#21246;&#36873; Config Server&#65288;Spring Cloud Config&#65289;&#19968;&#39033;&#20381;&#36182;&#23601;&#34892;&#20102;&#65292;&#20854;&#20182;&#20449;&#24687;&#26681;&#25454;&#33258;&#24049;&#30340;&#24773;&#20917;&#22635;&#20889;&#21363;&#21487;&#12290;&#20551;&#35774;&#25105;&#20204;&#39033;&#30446;&#30340; ArtifactId &#20026; config-server&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#20027;&#31243;&#24207; <code>ConfigServerApplication</code> &#19978;&#21152;&#19978; <code>@EnableConfigServer</code> &#27880;&#35299;&#65292;&#23601;&#20687;&#20195;&#30721;&#31034;&#20363; 14-1 &#37027;&#26679;&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">1</span></p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-1</strong>&#12288;&#22686;&#21152;&#20102; Spring Cloud Config Server &#27880;&#35299;&#30340;&#31867;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@SpringBootApplication
@EnableConfigServer
public class ConfigServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(ConfigServerApplication.class, args);
    }
}</code></pre>
<p>&#38543;&#21518;&#65292;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#20570;&#20123;&#35843;&#25972;&#65292;&#31867;&#20284;&#20195;&#30721;&#31034;&#20363; 14-2&#12290;&#25105;&#20204;&#25351;&#23450;&#20102; Spring &#24212;&#29992;&#21517;&#65292;HTTP &#26381;&#21153;&#30417;&#21548; <code>8888</code> &#31471;&#21475;&#65292;&#26368;&#37325;&#35201;&#30340;&#26159;&#25351;&#23450;&#20102; Git &#26381;&#21153;&#30340; URI &#22320;&#22336;&#65292;&#27492;&#22788;&#20351;&#29992;&#20102; <code>file://</code> &#26412;&#22320;&#30446;&#24405;&#65292;&#22823;&#23478;&#20063;&#21487;&#20197;&#29992; <code>ssh://</code> &#25110;&#32773; <code>https://</code> &#31561;&#21069;&#32512;&#25351;&#23450;&#19981;&#21516;&#30340;&#22320;&#22336;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-2</strong>&#12288;&#37197;&#32622;&#20013;&#24515;&#26381;&#21153;&#23545;&#24212;&#30340; <code>application.properties</code> &#25991;&#20214;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.application.name=config-server

server.port=8888
spring.cloud.config.server.git.uri=file://${user.home}/Codes/configs</code></pre>
<p>&#22312;&#21551;&#21160;&#26381;&#21153;&#21069;&#65292;&#38656;&#35201;&#20808;&#21021;&#22987;&#21270;&#19968;&#19979;&#26412;&#22320;&#30340; Git &#20179;&#24211;&#65292;&#22914;&#26524;&#20320;&#29992;&#30340;&#26159;&#36828;&#31243;&#20179;&#24211;&#65292;&#21487;&#20197;&#35774;&#32622;&#23545;&#24212;&#30340; URI &#21644;&#30331;&#24405;&#20449;&#24687;&#12290;<code>${user.home}</code> &#26159;&#19968;&#20010;&#31995;&#32479;&#21464;&#37327;&#65292;&#20250;&#35299;&#26512;&#20026;&#24403;&#21069;&#36816;&#34892;&#29992;&#25143;&#30340;&#29992;&#25143;&#30446;&#24405;&#65292;&#22312; Linux &#25110; macOS &#36825;&#26679;&#30340;&#31995;&#32479;&#37324;&#65292;&#31867;&#20284; <code>~</code> &#25351;&#20195;&#30340;&#30446;&#24405;&#12290;&#22312;&#36825;&#20010;&#30446;&#24405;&#20013;&#29992; <code>git</code> &#21629;&#20196;&#21021;&#22987;&#21270;&#20179;&#24211;&#65292;&#20877;&#28155;&#21152;&#19968;&#20010;&#37197;&#32622;&#25991;&#20214;&#25552;&#20132;&#21363;&#21487;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; mkdir -p ~/Codes/configs
&#9656; cd ~/Codes/configs
&#9656; git init .
&#9656; echo "binarytea.discount=100" &gt; application.properties
&#9656; git add application.properties
&#9656; git commit -m "add a default discount."</code></pre>
<p>&#22914;&#26524;&#26159; Windows &#31995;&#32479;&#65292;&#21487;&#33021;&#20250;&#32570;&#23569;&#19968;&#20123;&#21629;&#20196;&#65292;&#25105;&#20204;&#21487;&#20197;&#33258;&#24049;&#21019;&#24314;&#19968;&#20010;&#30446;&#24405;&#65292;&#29992; Git for Windows &#25110;&#32773; Tortoise Git &#31561;&#24037;&#20855;&#23436;&#25104;&#21021;&#22987;&#21270;&#65292;&#38543;&#21518;&#32534;&#36753; <code>application.properties</code> &#25991;&#20214;&#20877;&#25552;&#20132;&#12290;</p>
<p>&#19968;&#20999;&#20934;&#22791;&#23601;&#32490;&#20043;&#21518;&#65292;&#36816;&#34892; <code>ConfigServerApplication</code> &#31867;&#21551;&#21160;&#31243;&#24207;&#65292;&#25105;&#20204;&#23601;&#33719;&#24471;&#20102;&#19968;&#20010;&#22522;&#20110; Git &#21518;&#31471;&#23384;&#20648;&#12289;&#30417;&#21548; <code>8888</code> &#31471;&#21475;&#30340; Spring Cloud Config Server&#12290;&#22312;&#27983;&#35272;&#22120;&#20013;&#35775;&#38382; http://localhost:8888/application/ default/ &#21487;&#20197;&#30475;&#21040;&#31867;&#20284;&#22270; 14-1 &#30340;&#36755;&#20986;&#65292;&#36825;&#26159; JSON &#26684;&#24335;&#30340;&#65292;&#21518;&#32493;&#25105;&#20204;&#20250;&#30475;&#21040;&#22914;&#20309;&#33719;&#21462; YAML &#21644; Properties &#26684;&#24335;&#30340;&#37197;&#32622;&#39033;&#12290;</p>
<p class="p-img"><img alt="{%}" src="file:///[PrimaryStorage]local_pic/XueTouSpring_CongRuMenDaoXiangMuShiZhan/image00795.jpeg"/></p>
<p class="p-img-title"><strong>&#22270; 14-1&#12288;&#22312;&#27983;&#35272;&#22120;&#20013;&#35775;&#38382;&#40664;&#35748;&#30340;&#37197;&#32622;&#39033;</strong></p>
<p>&#160;</p>
</li>
<li><p><strong>&#37197;&#32622;&#30340;&#33719;&#21462;&#26041;&#24335;</strong></p>
<p>Spring Cloud Config Server &#23545;&#22806;&#25552;&#20379;&#20102;&#19968;&#31995;&#21015; <code>REST</code> &#25509;&#21475;&#65292;&#26041;&#20415;&#22823;&#23478;&#33719;&#21462;&#25351;&#23450;&#24212;&#29992;&#30340;&#21442;&#25968;&#65292;&#36807;&#31243;&#20013;&#38656;&#35201;&#20256;&#36882;&#19977;&#20010;&#37325;&#35201;&#21442;&#25968;&#65306;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#24212;&#29992;&#21517;&#65292;&#27599;&#20010;&#24212;&#29992;&#30340;&#21442;&#25968;&#37117;&#26159;&#20998;&#24320;&#23384;&#20648;&#30340;&#65292;&#36825;&#20010;&#21517;&#23383;&#23601;&#26159;&#21508;&#33258;&#30340; <code>spring.application.name</code>&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">Profile&#65292;&#21516;&#19968;&#24212;&#29992;&#19981;&#21516; Profile &#30340;&#37197;&#32622;&#20063;&#26159;&#20998;&#24320;&#30340;&#65292;&#21487;&#20197;&#23545;&#40664;&#35748;&#30340;&#37197;&#32622;&#36827;&#34892;&#35206;&#30422;&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#26631;&#31614;&#65288;label&#65289;&#65292;&#36825;&#26159; Git &#30340;&#26631;&#31614;&#65292;&#20043;&#21069;&#40664;&#35748;&#26159; <code>master</code>&#65292;&#29616;&#22312;&#25913;&#25104;&#20102; <code>main</code>&#65292;&#22914;&#26524;&#25214;&#19981;&#21040; <code>main</code> &#20998;&#25903;&#65292;&#21017;&#20250;&#38477;&#32423;&#20351;&#29992; <code>master</code> &#20998;&#25903;&#12290;</li>
</ul>
<p>&#37197;&#32622;&#20013;&#24515;&#23545;&#22806;&#25552;&#20379;&#30340;&#37117;&#26159; <code>GET</code> &#25509;&#21475;&#65292;&#36164;&#28304;&#30340; URI &#32452;&#25104;&#38750;&#24120;&#28789;&#27963;&#65292;&#26377;&#24456;&#22810;&#31181;&#26041;&#24335;&#65292;&#20855;&#20307;&#22914;&#34920; 14-2 &#25152;&#31034;&#12290;&#22914;&#26524;&#20351;&#29992; Spring Cloud Config Client &#26469;&#33719;&#21462;&#37197;&#32622;&#65292;&#25105;&#20204;&#26681;&#26412;&#23601;&#19981;&#29992;&#25805;&#24515;&#36825;&#20123; URI &#20855;&#20307;&#24590;&#20040;&#29992;&#12290;&#20294;&#22914;&#26524;&#26159;&#33258;&#24049;&#35201;&#29992;&#65292;&#37027;&#36824;&#26159;&#38656;&#35201;&#20102;&#35299;&#19968;&#19979;&#12290;</p>
<p><strong>&#34920; 14-2&#12288;&#33719;&#21462;&#37197;&#32622;&#30340; HTTP &#36164;&#28304; URI</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>URI</th><th>&#36164;&#28304;&#26684;&#24335;</th><th>&#35828;&#26126;</th></tr><tr><td><code>/{ &#24212;&#29992;&#21517; }/{Profile}[/{ &#26631;&#31614; }]</code></td><td>JSON</td><td>&#26368;&#21518;&#37027;&#37096;&#20998; <code>/{ &#26631;&#31614; }</code> &#26159;&#21487;&#36873;&#30340;</td></tr><tr><td><code>/{ &#24212;&#29992;&#21517; }-{Profile}.yml</code></td><td>YAML</td><td>&#21508;&#39033;&#37117;&#26159;&#24517;&#38656;&#30340;&#65292;&#23601;&#31639;&#27809;&#26377; Profile&#65292;&#20063;&#24471;&#20889;&#19968;&#20010;</td></tr><tr><td><code>/{ &#24212;&#29992;&#21517; }-{Profile}.properties</code></td><td>Properties</td><td>&#21516;&#19978;</td></tr><tr><td><code>/{ &#26631;&#31614; }/{ &#24212;&#29992;&#21517; }-{Profile}.yml</code></td><td>YAML</td><td>&#21508;&#39033;&#37117;&#26159;&#24517;&#38656;&#30340;&#65292;&#23601;&#31639;&#27809;&#26377;&#26631;&#31614;&#65292;&#20063;&#24471;&#20889;&#19968;&#20010;</td></tr><tr><td><code>/{ &#26631;&#31614; }/{ &#24212;&#29992;&#21517; }-{Profile}.properties</code></td><td>Properties</td><td>&#21516;&#19978;</td></tr></table>
<p>&#25105;&#20204;&#22312; 4.3.2 &#33410;&#37324;&#20171;&#32461;&#20102; Spring Boot &#39033;&#30446;&#37197;&#32622;&#25991;&#20214;&#30340;&#30456;&#20851;&#32454;&#33410;&#65292;&#22312; Spring Cloud Config Server &#20351;&#29992;&#30340;&#26412;&#22320;&#30446;&#24405;&#25110;&#32773; Git &#37324;&#65292;&#23384;&#20648;&#37197;&#32622;&#30340;&#26041;&#24335;&#20063;&#26159;&#31867;&#20284;&#30340;&#65292;&#29992; <code>{ &#24212;&#29992;&#21517; }.properties</code> &#25110; <code>{ &#24212;&#29992;&#21517; }-{Profile}.properties</code> &#30340;&#25991;&#20214;&#26469;&#20445;&#23384;&#37197;&#32622;&#65288;<code>.yml</code> &#25991;&#20214;&#30340;&#21629;&#21517;&#26041;&#24335;&#20063;&#26159;&#31867;&#20284;&#30340;&#65289;&#12290;&#21508;&#24212;&#29992;&#38388;&#20844;&#20849;&#30340;&#37197;&#32622;&#34987;&#23384;&#22312;&#21517;&#20026; <code>application</code> &#30340;&#24212;&#29992;&#19979;&#65292;&#20063;&#23601;&#26159;&#25918;&#22312; <code>application.properties</code> &#25110; <code>application-{Profile}.properties</code> &#37324;&#12290;</p>
<p>&#19981;&#21516;&#25991;&#20214;&#37324;&#30340;&#37197;&#32622;&#65292;&#22312;&#33719;&#21462;&#26102;&#20250;&#25353;&#29031;&#19979;&#38754;&#30340;&#20248;&#20808;&#32423;&#25490;&#21015;&#65292;<code>{ &#24212;&#29992;&#21517; }-{Profile}.properties</code> &#30340;&#20248;&#20808;&#32423;&#26368;&#39640;&#12290;&#36825;&#37324;&#29992;&#30340;&#26159; <code>.properties</code> &#21518;&#32512;&#65292;<code>.yml</code> &#20063;&#26159;&#19968;&#26679;&#30340;&#65306;</p>
<p>(1) <code>{ &#24212;&#29992;&#21517; }-{Profile}.properties</code></p>
<p>(2) <code>{ &#24212;&#29992;&#21517; }.properties</code></p>
<p>(3) <code>application-{Profile}.properties</code></p>
<p>(4) <code>application.properties</code></p>
<p>&#20026;&#20102;&#24110;&#21161;&#22823;&#23478;&#26356;&#22909;&#22320;&#29702;&#35299;&#37197;&#32622;&#30340;&#33719;&#21462;&#26041;&#24335;&#65292;&#35753;&#25105;&#20204;&#36890;&#36807;&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#30340;&#20363;&#23376;&#26469;&#20570;&#20010;&#28436;&#31034;&#12290;</p>
<blockquote>
<p><strong>&#38656;&#27714;&#25551;&#36848;</strong>&#12288;&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#20250;&#26032;&#24320;&#19968;&#20123;&#20998;&#24215;&#65292;&#22312;&#27491;&#24335;&#24320;&#19994;&#21069;&#26399;&#65292;&#36825;&#20123;&#24215;&#26377;&#30340;&#20250;&#26242;&#19981;&#23545;&#22806;&#24320;&#25918;&#65292;&#26377;&#30340;&#20250;&#32553;&#30701;&#33829;&#19994;&#26102;&#38388;&#65292;&#20363;&#22914;&#65292;&#26032;&#24215;&#35797;&#33829;&#19994;&#26399;&#38388;&#21482;&#22312; 9:00~19:30 &#33829;&#19994;&#65292;&#36824;&#33021;&#32473;&#20123;&#25240;&#25187;&#12290;&#36825;&#20123;&#37197;&#32622;&#21407;&#20808;&#25918;&#22312; <code>application.properties</code> &#37324;&#65292;&#29616;&#22312;&#35831;&#32771;&#34385;&#23558;&#23427;&#20204;&#25386;&#21040;&#37197;&#32622;&#20013;&#24515;&#37324;&#12290;</p>
</blockquote>
<p>&#38656;&#27714;&#20013;&#25552;&#21040;&#30340;&#33829;&#19994;&#26102;&#38388;&#20854;&#23454;&#23601;&#26159;&#20043;&#21069;&#30340; <code>binarytea.ready</code> &#21644; <code>binarytea.open-hours</code> &#36825;&#20004;&#20010;&#21442;&#25968;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>binarytea.ready=true
binarytea.open-hours=8:30-22:00</code></pre>
<p>&#25105;&#20204;&#22312; <code>~/Codes/configs</code> &#30446;&#24405;&#20013;&#20998;&#21035;&#32534;&#36753; <code>application.properties</code>&#12289;<code>binarytea.properties</code> &#21644; <code>binarytea-trial.properties</code> &#19977;&#20010;&#25991;&#20214;&#24182;&#25552;&#20132;&#33267; Git &#20179;&#24211;&#65292;&#23427;&#20204;&#20998;&#21035;&#20195;&#34920;&#20102;&#24212;&#29992;&#31243;&#24207;&#37197;&#32622;&#30340;&#20844;&#20849;&#40664;&#35748;&#37197;&#32622;&#12289;BinaryTea &#39033;&#30446;&#30340;&#40664;&#35748; Profile &#37197;&#32622;&#21644; <code>trial</code> &#35797;&#33829;&#19994; Profile &#37197;&#32622;&#12290;&#19977;&#20010;&#37197;&#32622;&#25991;&#20214;&#30340;&#20869;&#23481;&#35831;&#35265;&#20195;&#30721;&#31034;&#20363; 14-3&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-3</strong>&#12288;&#21253;&#21547;&#20102;&#38376;&#24215;&#33829;&#19994;&#26102;&#38388;&#30340;&#20960;&#20010;&#37197;&#32622;&#25991;&#20214;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code># application.properties
binarytea.ready=false
binarytea.open-hours=8:30-22:00
binarytea.discount=100

# binarytea.properties
binarytea.ready=true
binarytea.open-hours=9:00-21:00

# binarytea-trial.properties
binarytea.open-hours=9:30-19:30
binarytea.discount=80</code></pre>
<p>&#25105;&#20204;&#21487;&#20197;&#29992; curl &#21629;&#20196;&#26469;&#35775;&#38382;&#37197;&#32622;&#20013;&#24515;&#65292;&#20808;&#33719;&#21462; BinaryTea &#39033;&#30446;&#30340;&#40664;&#35748;&#37197;&#32622;&#12290;&#21629;&#20196;&#31867;&#20284;&#19979;&#38754;&#36825;&#26679;&#65292;&#20854;&#20013;&#30340; <code>-default</code> &#26159;&#38543;&#20415;&#20889;&#30340;&#65292;&#19981;&#23384;&#22312;&#30340; Profile &#20250;&#21152;&#36733;&#40664;&#35748;&#30340;&#20869;&#23481;&#65292;<code>order.discount</code> &#26159;&#20174; <code>application.properties</code> &#33719;&#21462;&#30340;&#65292;&#32780;&#21478;&#20004;&#20010;&#21017;&#26159;&#20174; <code>binarytea.properties</code> &#33719;&#21462;&#30340;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl http://localhost:8888/binarytea-default.yml
binarytea:
  ready: 'true'
  open-hours: 9:00-21:00
  discount: '100'</code></pre>
<p>&#19978;&#38754;&#28436;&#31034;&#30340;&#26159;&#33719;&#21462; YAML &#26684;&#24335;&#30340;&#20869;&#23481;&#65292;&#25509;&#19979;&#26469;&#25442;&#25104; Properties&#65292;&#25105;&#20204;&#26469;&#33719;&#21462;&#35797;&#33829;&#19994;&#30340;&#37197;&#32622;&#12290;&#20854;&#20013;&#30340; <code>order.discount</code> &#21644; <code>binarytea.open-hours</code> &#26159;&#20174; <code>binarytea-trial.properties</code> &#33719;&#21462;&#30340;&#65292;<code>binarytea.ready</code> &#21017;&#26159;&#20174; <code>binarytea.properties</code> &#33719;&#21462;&#30340;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl http://localhost:8888/binarytea-trial.properties
binarytea.ready: true
binarytea.open-hours: 9:30-19:30
binarytea.discount: 80</code></pre>
<p>Spring Cloud Config Server &#26412;&#36136;&#19978;&#20063;&#26159;&#19968;&#20010;&#26381;&#21153;&#12290;&#26082;&#28982;&#26159;&#26381;&#21153;&#65292;&#37027;&#19968;&#26679;&#20063;&#21487;&#20197;&#27880;&#20876;&#21040;&#26381;&#21153;&#30340;&#27880;&#20876;&#20013;&#24515;&#37324;&#65292;&#28982;&#21518;&#36890;&#36807;&#27880;&#20876;&#20013;&#24515;&#23454;&#29616;&#37197;&#32622;&#26381;&#21153;&#30340;&#21457;&#29616;&#12290;&#20351;&#29992;&#19978;&#19968;&#31456;&#20171;&#32461;&#30340;&#26041;&#27861;&#65292;&#23601;&#33021;&#36731;&#26494;&#22320;&#23436;&#25104;&#27880;&#20876;&#65292;&#31245;&#21518;&#25105;&#20204;&#20250;&#22312; 14.1.3 &#20013;&#30475;&#21040;&#22914;&#20309;&#20174;&#27880;&#20876;&#20013;&#24515;&#25214;&#21040;&#37197;&#32622;&#20013;&#24515;&#12290;&#27492;&#22806;&#65292;&#26082;&#28982;&#26159; HTTP &#26381;&#21153;&#65292;&#37027;&#25105;&#20204;&#20063;&#21487;&#20197;&#29992; Spring Security &#26469;&#23545;&#36825;&#20123; URL &#36827;&#34892;&#24517;&#35201;&#30340;&#38450;&#25252;&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#21152;&#23494;&#20445;&#25252;&#37197;&#32622;&#39033;</strong></p>
<p>&#31867;&#20284;&#25105;&#20204;&#31034;&#20363;&#20013;&#30340;&#37197;&#32622;&#39033;&#37117;&#26159;&#21487;&#20197;&#26126;&#25991;&#20445;&#23384;&#12289;&#21363;&#20351;&#27844;&#38706;&#20102;&#20063;&#19981;&#20250;&#36896;&#25104;&#22826;&#22823;&#24433;&#21709;&#30340;&#20869;&#23481;&#65307;&#20294;&#26159;&#26377;&#20123;&#37197;&#32622;&#21364;&#23646;&#20110;&#25935;&#24863;&#20449;&#24687;&#65292;&#20197;&#26126;&#25991;&#30340;&#24418;&#24335;&#20445;&#23384;&#22312;&#37197;&#32622;&#25991;&#20214;&#37324;&#19981;&#23433;&#20840;&#65292;&#36825;&#31867;&#37197;&#32622;&#21253;&#25324;&#20294;&#19981;&#38480;&#20110;&#36134;&#25143;&#12289;&#23494;&#30721;&#31561;&#20449;&#24687;&#12290;&#35797;&#24819;&#19968;&#19979;&#65292;&#25105;&#20204;&#25226;&#29983;&#20135;&#25968;&#25454;&#24211;&#30340;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;&#20445;&#23384;&#22312;&#37197;&#32622;&#25991;&#20214;&#37324;&#65292;&#32780;&#36825;&#20123;&#37197;&#32622;&#25991;&#20214;&#21448;&#34987;&#25552;&#20132;&#21040;&#20102; Git &#19978;&#65292;&#38543;&#21518;&#26377;&#26435;&#35775;&#38382;&#35813;&#20179;&#24211;&#30340;&#20154;&#23601;&#37117;&#30475;&#21040;&#20102;&#36825;&#20123;&#23494;&#30721;&#65292;&#21518;&#26524;&#19981;&#22570;&#35774;&#24819;&#12290;</p>
<p>&#20316;&#20026;&#37197;&#32622;&#20013;&#24515;&#65292;Spring Cloud Config Server &#24403;&#28982;&#19981;&#20250;&#23545;&#36825;&#20040;&#24120;&#35265;&#30340;&#38382;&#39064;&#35270;&#32780;&#19981;&#35265;&#12290;&#23427;&#25552;&#20379;&#20102;&#37197;&#32622;&#39033;&#21152;&#23494;&#21151;&#33021;&#65306;&#21487;&#20197;&#21152;&#23494;&#23384;&#20648;&#25105;&#20204;&#30340;&#37197;&#32622;&#39033;&#65292;&#22312;&#36820;&#22238;&#21069;&#36827;&#34892;&#35299;&#23494;&#65307;&#20063;&#21487;&#20197;&#30452;&#25509;&#20026;&#23458;&#25143;&#31471;&#25552;&#20379;&#23494;&#25991;&#37197;&#32622;&#39033;&#65292;&#35753;&#23458;&#25143;&#31471;&#33258;&#34892;&#35299;&#23494;&#12290;&#20294;&#32771;&#34385;&#21040;&#35753;&#23458;&#25143;&#31471;&#35299;&#23494;&#38656;&#35201;&#23558;&#35299;&#23494;&#29992;&#21040;&#30340;&#23494;&#38053;&#20998;&#21457;&#20986;&#21435;&#65292;&#24314;&#35758;&#36824;&#26159;&#36873;&#25321;&#21069;&#32773;&#12290;</p>
<p>&#35201;&#21152;&#23494;&#37197;&#32622;&#39033;&#65292;&#31532;&#19968;&#27493;&#33258;&#28982;&#26159;&#37197;&#32622;&#21152;&#23494;&#29992;&#30340;&#23494;&#38053;&#65292;Spring Cloud Config Server &#21516;&#26102;&#25903;&#25345;&#23545;&#31216;&#21644;&#38750;&#23545;&#31216;&#21152;&#23494;&#31639;&#27861;&#65292;&#20004;&#31181;&#21152;&#23494;&#30340;&#37197;&#32622;&#26041;&#24335;&#31245;&#26377;&#19981;&#21516;&#12290;&#23545;&#31216;&#23494;&#38053;&#30340;&#37197;&#32622;&#30456;&#23545;&#31616;&#21333;&#65292;&#21482;&#38656;&#35201;&#19968;&#20010; <code>encrypt.key</code> &#37197;&#32622;&#39033;&#23601;&#33021;&#25630;&#23450;&#12290;&#20363;&#22914;&#65292;&#22312; <code>application.properties</code> &#20013;&#22686;&#21152;&#22914;&#19979;&#37197;&#32622;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>encrypt.key=binarytea</code></pre>
<p>&#22312;&#36816;&#34892; Spring Cloud Config Server &#31243;&#24207;&#21518;&#65292;&#36890;&#36807; <code>/encrypt</code> &#21644; <code>/decrypt</code> &#36825;&#20004;&#20010; URL &#21487;&#20197;&#36827;&#34892;&#31616;&#21333;&#30340;&#21152;&#35299;&#23494;&#12290;&#29992; curl &#21629;&#20196;&#26469;&#20570;&#20010;&#28436;&#31034;&#65292;&#22823;&#27010;&#23601;&#26159;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl http://localhost:8888/encrypt/status
{"status":"OK"}

&#9656; curl http://localhost:8888/encrypt -s -d password
0e796a32ff53ad9d994c43cea5ebc7f9dd45e242a4144d21420a21474f9d0770

&#9656; curl http://localhost:8888/decrypt -s -d 0e796a32ff53ad9d994c43cea5ebc7f9dd45e242a4144d21420a21474f9d0770
password</code></pre>
<p>&#22914;&#26524;&#21518;&#32493;&#22312;&#37197;&#32622;&#20179;&#24211;&#20013;&#35201;&#20445;&#23384;&#21152;&#23494;&#21518;&#30340;&#23494;&#25991;&#65292;&#21487;&#20197;&#22312;&#20540;&#21069;&#22686;&#21152; <code>{cipher}</code> &#21069;&#32512;&#65292;&#20363;&#22914;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>password={cipher}0e796a32ff53ad9d994c43cea5ebc7f9dd45e242a4144d21420a21474f9d0770</code></pre>
<p>&#22914;&#26524;&#35273;&#24471;&#30452;&#25509;&#22312;&#24037;&#31243;&#30340; <code>application.properties</code> &#25991;&#20214;&#20013;&#20889;&#20837;&#31192;&#38053;&#26126;&#25991; <code>encrypt.key</code> &#19981;&#20445;&#38505;&#65292;&#20063;&#21487;&#20197;&#36873;&#25321;&#25226;&#23427;&#25918;&#22312; <code>ENCRYPT_KEY</code> &#29615;&#22659;&#21464;&#37327;&#37324;&#8212;&#8212;&#20294;&#20004;&#32773;&#26412;&#36136;&#19978;&#26159;&#19968;&#26679;&#30340;&#12290;&#21487;&#20197;&#26681;&#25454;&#23454;&#38469;&#24773;&#20917;&#36873;&#25321;&#65292;&#27605;&#31455;&#24635;&#26377;&#19968;&#20010;&#22320;&#26041;&#35201;&#37197;&#32622;&#31192;&#38053;&#26126;&#25991;&#65292;&#32780;&#36825;&#20010;&#31192;&#38053;&#20320;&#26377;&#26102;&#36824;&#19981;&#24471;&#19981;&#32473;&#21035;&#20154;&#65292;&#22240;&#20026;&#20182;&#20204;&#21487;&#33021;&#35201;&#33258;&#24049;&#21152;&#23494;&#20123;&#19996;&#35199;&#12290;&#36825;&#26102;&#65292;&#36873;&#29992;&#38750;&#23545;&#31216;&#21152;&#23494;&#31639;&#27861;&#20063;&#35768;&#26356;&#21512;&#36866;&#65292;&#20294;&#23427;&#30340;&#37197;&#32622;&#23601;&#20250;&#22797;&#26434;&#19968;&#20123;&#65292;&#28041;&#21450;&#19981;&#23569;&#37197;&#32622;&#39033;&#65292;&#20855;&#20307;&#22914;&#34920; 14-3 &#25152;&#31034;&#12290;</p>
<p><strong>&#34920; 14-3&#12288;&#38750;&#23545;&#31216;&#21152;&#23494;&#28041;&#21450;&#30340;&#37197;&#32622;&#39033;</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>&#37197;&#32622;&#39033;</th><th>&#35828;&#26126;</th></tr><tr><td><code>encrypt.key-store.location</code></td><td>&#23494;&#38053;&#24211;&#25991;&#20214;&#30340;&#20301;&#32622;&#65292;&#21487;&#20197;&#26159; CLASSPATH</td></tr><tr><td><code>encrypt.key-store.password</code></td><td>&#23494;&#38053;&#24211;&#25991;&#20214;&#30340;&#23494;&#30721;&#65292;&#20063;&#23601;&#26159;&#25171;&#24320;&#23494;&#38053;&#24211;&#30340;&#23494;&#30721;</td></tr><tr><td><code>encrypt.key-store.alias</code></td><td>&#23494;&#38053;&#23545;&#30340;&#21035;&#21517;</td></tr><tr><td><code>encrypt.key-store.type</code></td><td>&#23494;&#38053;&#24211;&#25991;&#20214;&#30340;&#31867;&#22411;&#65292;&#20363;&#22914; JKS &#21644; PKCS12</td></tr><tr><td><code>encrypt.key-store.secret</code></td><td>&#33719;&#21462;&#29305;&#23450;&#21035;&#21517;&#23494;&#38053;&#30340;&#23494;&#30721;</td></tr></table>
<p>&#25105;&#20204;&#21487;&#20197;&#36890;&#36807; JDK &#33258;&#24102;&#30340; keytool &#24037;&#20855;&#26469;&#29983;&#25104;&#38750;&#23545;&#31216;&#23494;&#38053;&#23545;&#65292;&#24182;&#23558;&#23427;&#20445;&#23384;&#21040; JKS &#25991;&#20214;&#37324;&#12290;keytool &#30340;&#21629;&#20196;&#34892;&#26684;&#24335;&#22823;&#33268;&#22914;&#19979;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>keytool -genkeypair -alias &#21035;&#21517; -keyalg &#31639;&#27861; -keysize &#38271;&#24230; \
        -keystore &#25991;&#20214;&#21517; -storepass &#23494;&#38053;&#24211;&#23494;&#30721; -keypass &#23494;&#38053;&#23494;&#30721;</code></pre>
<p>&#20363;&#22914;&#65292;&#25105;&#20204;&#21487;&#20197;&#29992;&#19979;&#38754;&#30340;&#21629;&#20196;&#26469;&#29983;&#25104;&#19968;&#23545; 2048 &#20301;&#30340; RSA &#23494;&#38053;&#23545;&#65292;&#20445;&#23384;&#21040; server.jks &#37324;&#12290;&#36755;&#20837;&#21629;&#20196;&#21518;&#65292;&#20250;&#26377;&#20123;&#20132;&#20114;&#30340;&#25552;&#31034;&#65292;&#34917;&#20805;&#19968;&#20123;&#20449;&#24687;&#12290;&#28436;&#31034;&#30340;&#20004;&#20010;&#23494;&#30721;&#37117;&#26159; <code>binarytea</code>&#65292;&#21487;&#20197;&#32771;&#34385;&#29992;&#19968;&#26679;&#30340;&#65292;&#20294;&#22312;&#29983;&#20135;&#20013;&#35831;&#35880;&#24910;&#35774;&#32622;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; keytool -genkeypair -alias binarytea -keyalg RSA -keysize 2048 \
           -keystore server.jks -storepass binarytea -keypass binarytea</code></pre>
<p>&#23494;&#38053;&#23545;&#20013;&#30340;&#20844;&#38053;&#20250;&#34987;&#29992;&#26469;&#21152;&#23494;&#26126;&#25991;&#65292;&#31169;&#38053;&#21017;&#29992;&#26469;&#35299;&#23494;&#12290;&#21487;&#20197;&#32771;&#34385;&#23558;&#20844;&#38053;&#20998;&#21457;&#32473;&#22823;&#23478;&#65292;&#35753;&#22823;&#23478;&#20998;&#21035;&#21152;&#23494;&#33258;&#24049;&#30340;&#25935;&#24863;&#37197;&#32622;&#65292;&#32780;&#22312; Spring Cloud Config Server &#30340;&#26381;&#21153;&#31471;&#37096;&#32626;&#31169;&#38053;&#65292;&#23545;&#36825;&#20960;&#21488;&#26381;&#21153;&#22120;&#20570;&#21152;&#22266;&#21363;&#21487;&#12290;</p>
<p>&#20551;&#35774;&#25105;&#20204;&#23558; server.jks &#25991;&#20214;&#25918;&#22312;&#24037;&#31243;&#30340; src/resources &#30446;&#24405;&#37324;&#65292;&#20063;&#23601;&#26159;&#23558;&#23427;&#25918;&#22312; CLASSPATH &#20013;&#65292;&#22312; <code>application.properties</code> &#20013;&#27880;&#37322;&#25481;&#23545;&#31216;&#23494;&#38053;&#30340;&#37197;&#32622;&#65292;&#20877;&#20570;&#19979;&#38754;&#36825;&#26679;&#30340;&#37197;&#32622;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code># &#23545;&#31216;&#21152;&#23494;&#29992;&#30340;&#23494;&#38053;
# encrypt.key=binarytea

# &#38750;&#23545;&#31216;&#21152;&#23494;&#29992;&#30340;&#23494;&#38053;&#24211;
encrypt.key-store.location=classpath:/server.jks
encrypt.key-store.password=binarytea
encrypt.key-store.alias=binarytea
encrypt.key-store.type=jks</code></pre>
<p>&#37325;&#26032;&#36816;&#34892;&#25105;&#20204;&#30340;&#37197;&#32622;&#26381;&#21153;&#22120;&#65292;&#21516;&#26679;&#20351;&#29992; curl &#21629;&#20196;&#26469;&#21152;&#23494; <code>password</code> &#23383;&#31526;&#20018;&#65292;&#25928;&#26524;&#22823;&#27010;&#26159;&#19979;&#38754;&#36825;&#26679;&#30340;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl http://localhost:8888/encrypt/status
{"status":"OK"}

&#9656; curl http://localhost:8888/encrypt -s -d password
AQB/duN0R8Dbsi6VrNOOnoAW1x/ge/0Y/b7P0WqRt/CsYNItRNl68Tu4ah/6Cfzx5KJaIlYi41XriBHbuI8xMELU5KpYjYY3YLbUx/
90XMAj96hQwiieqF6uC4suiJuzlQU6hs29BI78LCVeMps6mT0VcqkDfB+bBvy7mrpzh7NdVElmz3rq3ZhlH7hjN9A3qoWcuNKXkCeA
HghakIRnBWrCFBJEsrwt4sOomIkKg29Ej7+rscv4EhxKMnCFB+Gb0wmmQ4wwQoOi0+uO+UnDyar71+vhhpxyi1hxIp8VFC/A5s/
LqTKkdv/MvzRXTSXm1eqWXgUn5DUXBP3Dm5z2E3riG8q6cY6gPhzV9wS73Y549vQs758p1qyE2cRRM+hOKZo=

&#9656; curl http://localhost:8888/decrypt -s -d AQB/duN0R8Dbsi6VrNOOnoAW1x/ge/0Y/b7P0WqRt/CsYNItRNl68Tu4ah/
6Cfzx5KJaIlYi41XriBHbuI8xMELU5KpYjYY3YLbUx/90XMAj96hQwiieqF6uC4suiJuzlQU6hs29BI78LCVeMps6mT0VcqkDfB+bBvy
7mrpzh7NdVElmz3rq3ZhlH7hjN9A3qoWcuNKXkCeAHghakIRnBWrCFBJEsrwt4sOomIkKg29Ej7+rscv4EhxKMnCFB+Gb0wmmQ4wwQo
Oi0+uO+UnDyar71+vhhpxyi1hxIp8VFC/A5s/LqTKkdv/MvzRXTSXm1eqWXgUn5DUXBP3Dm5z2E3riG8q6cY6gPhzV9wS73Y549vQs
758p1qyE2cRRM+hOKZo=
password</code></pre>
<p>&#25105;&#20204;&#21487;&#20197;&#30475;&#21040;&#23494;&#25991;&#30340;&#26679;&#24335;&#19982;&#23545;&#31216;&#30340;&#26041;&#24335;&#24046;&#21035;&#24456;&#22823;&#12290;</p>
<p>&#22238;&#21040;&#25105;&#20204;&#20043;&#21069;&#30340; BinaryTea &#24037;&#31243;&#37324;&#65292;<code>application.properties</code> &#25991;&#20214;&#20013;&#37197;&#32622;&#36807; <code>spring.security.user.password</code> &#21644; <code>jwt.secret</code>&#65292;&#36825;&#23601;&#23646;&#20110;&#38656;&#35201;&#20445;&#25252;&#30340;&#25935;&#24863;&#20449;&#24687;&#65292;&#20877;&#21152;&#19978; <code>spring.security.user.name</code>&#65292;&#25105;&#20204;&#21487;&#20197;&#23558;&#23427;&#20204;&#25644;&#21040; Git &#37324;&#30340; <code>binarytea.properties</code> &#25991;&#20214;&#20013;&#12290;&#20551;&#35774;&#29992;&#30340;&#26159;&#19978;&#38754;&#30340;&#23545;&#31216;&#23494;&#38053; <code>encrypt.key=binarytea</code>&#65292;&#37027;&#29616;&#22312;&#36825;&#20010;&#25991;&#20214;&#30340;&#20869;&#23481;&#22823;&#27010;&#20250;&#26159;&#19979;&#38754;&#36825;&#26679;&#30340;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>binarytea.ready=true
binarytea.open-hours=9:00-21:00
spring.security.user.name=binarytea
spring.security.user.password={cipher}0e687280ab9ba90be5ba59d28280b502d2b4169355e6be78a997cbd7b6043f24
jwt.secret={cipher}e6492d2828b20f613de2b006d216d90666d84172a0fd856e615902c0e9ff8f775488d8c6e1dc5771295981
c5f84cfad8c8ca94aacbc62790ebd4c3589f4921ef36c6f37d812e3adab903200971a5ae2ba213004fdb19ec2334eb6fb241b98d2
0d126fd8fff03cb0dbb23ea0e593ab89c</code></pre>
<p>&#36825;&#37324;&#38656;&#35201;&#29305;&#21035;&#35828;&#26126;&#30340;&#26159; <code>jwt.secret</code> &#30340;&#26126;&#25991;&#21152;&#23494;&#65292;&#22914;&#26524;&#20351;&#29992; curl &#21629;&#20196;&#20250;&#31245;&#26377;&#19981;&#21516;&#12290;&#30001;&#20110;&#20854;&#20013;&#26377; <code>=</code>&#65292;&#21487;&#20197;&#36890;&#36807; <code>Content-Type: text/plain</code> &#22836;&#25351;&#23450;&#35831;&#27714;&#30340;&#20869;&#23481;&#26684;&#24335;&#65292;&#29992; <code>--data-raw</code> &#26469;&#25552;&#20379;&#20869;&#23481;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl http://localhost:8888/encrypt -H "Content-Type: text/plain" -s --data-raw gR6cytlUlgMfVh08nLFZf8h
Mk4mdJDX5rWBVlsCbKvRlWcLwNRU6+rIPcLx21x191kJgP8udtoZuHt5yUDWtgg==

e6492d2828b20f613de2b006d216d90666d84172a0fd856e615902c0e9ff8f775488d8c6e1dc5771295981c5f84cfad8c8ca94aac
bc62790ebd4c3589f4921ef36c6f37d812e3adab903200971a5ae2ba213004fdb19ec2334eb6fb241b98d20d126fd8fff03cb0dbb
23ea0e593ab89c</code></pre>
<p>&#26368;&#21518;&#65292;&#25105;&#20204;&#21487;&#20197;&#29992; curl &#21629;&#20196;&#25110;&#32773;&#27983;&#35272;&#22120;&#20877;&#26469;&#30830;&#35748;&#19968;&#19979;&#65292;&#21152;&#23494;&#20445;&#23384;&#30340;&#20449;&#24687;&#26159;&#21542;&#21487;&#20197;&#27491;&#24120;&#35835;&#21462;&#65292;&#20363;&#22914;&#21152;&#36733; BinaryTea &#24037;&#31243;&#30340; YAML &#26684;&#24335;&#37197;&#32622;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl http://localhost:8888/binarytea-default.yml
binarytea:
  ready: 'true'
  open-hours: 9:00-21:00
  discount: '100'
spring:
  security:
    user:
      name: binarytea
      password: showmethemoney
jwt:
  secret: gR6cytlUlgMfVh08nLFZf8hMk4mdJDX5rWBVlsCbKvRlWcLwNRU6+rIPcLx21x191kJgP8udtoZuHt5yUDWtgg==</code></pre>
<blockquote>
<p><strong>&#33590;&#27463;&#26102;&#38388;&#65306;&#21152;&#35299;&#23494;&#32469;&#19981;&#24320;&#30340; JCE</strong></p>
<p>&#22312;&#22788;&#29702;&#21152;&#35299;&#23494;&#30456;&#20851;&#30340;&#38382;&#39064;&#26102;&#65292;&#22810;&#23569;&#24635;&#20250;&#36935;&#21040;&#19968;&#20123;&#19982; JCE&#65288;Java Cryptography Extension&#65289;&#30456;&#20851;&#30340;&#38382;&#39064;&#12290;&#24456;&#22810;&#25991;&#31456;&#37117;&#20250;&#21578;&#35785;&#20320;&#65292;&#40664;&#35748;&#23433;&#35013;&#30340; JDK &#37324;&#38656;&#35201;&#25171;&#20123;&#34917;&#19969;&#25165;&#33021;&#20351;&#29992;&#26356;&#39640;&#20301;&#25968;&#30340;&#23494;&#38053;&#65292;&#25152;&#20197;&#38656;&#35201;&#20174; Oracle &#30340;&#32593;&#31449;&#19978;&#19979;&#36733; JDK &#23545;&#24212;&#29256;&#26412;&#30340;&#8220;Java Cryptography Extension&#65288;JCE&#65289;Unlimited Strength Jurisdiction Policy Files&#8221;&#65292;&#20363;&#22914;&#65292;&#29992;&#20110; JDK 6 &#30340; jce_policy-6.zip&#12290;&#35299;&#21387;&#21518;&#23558; local_policy.jar &#21644; US_export_policy.jar &#25991;&#20214;&#22797;&#21046;&#21040; $JAVA_HOME/jre/lib/security &#30446;&#24405;&#65292;&#20197;&#20415;&#24320;&#21551;&#23545;&#24212;&#30340;&#25903;&#25345;&#12290;</p>
<p>&#37027;&#22823;&#23478;&#26377;&#27809;&#26377;&#24819;&#36807;&#65292;&#20026;&#20160;&#20040;&#35201;&#22810;&#20570;&#36825;&#20040;&#19968;&#20010;&#27493;&#39588;&#65292;&#20026;&#20160;&#20040; Java 9 &#20043;&#21518;&#21448;&#19981;&#38656;&#35201;&#20102;&#21602;&#65311;&#36825;&#36824;&#24471;&#20174;&#32654;&#22269;&#38480;&#21046;&#21152;&#23494;&#30456;&#20851;&#25216;&#26415;&#21644;&#35774;&#22791;&#20986;&#21475;&#30340;&#27861;&#24459;&#35828;&#36215;&#12290;&#33258; 1992 &#24180;&#36215;&#65292;&#32654;&#22269;&#23601;&#26377;&#30456;&#20851;&#30340;&#38480;&#21046;&#65292;&#20363;&#22914;&#65292;&#21482;&#26377;&#22312;&#21271;&#32654;&#25165;&#33021;&#20351;&#29992;&#25903;&#25345; 1024 &#25110;&#26356;&#22823;&#20301;&#25968; RSA &#20844;&#38053;&#30340;&#36719;&#20214;&#65292;&#26356;&#26377;&#29978;&#32773;&#65292;&#35201;&#27714;&#36719;&#20214;&#21378;&#21830;&#24517;&#39035;&#22312;&#36719;&#20214;&#37324;&#28155;&#21152;&#8220;&#23494;&#38053;&#24674;&#22797;&#8221;&#21518;&#38376;&#65292;&#25165;&#33021;&#20986;&#21475;&#12290;&#20294;&#36825;&#20123;&#38480;&#21046;&#21040;&#20102; 2000 &#24180;&#21518;&#36880;&#27493;&#25918;&#23485;&#20102;&#65292;&#26681;&#25454; JDK-8170157<span class="&#27880;&#37322;&#32534;&#21495;">2</span> &#30340;&#25551;&#36848;&#65292;&#20174; 6u181&#12289;7u171 &#21644; 8u161 &#29256;&#26412;&#21518;&#65292;JDK 6&#12289;JDK 7 &#21644; JDK 8 &#37117;&#19981;&#20877;&#38656;&#35201;&#39069;&#22806;&#35206;&#30422; JCE &#25991;&#20214;&#65292;&#24403;&#28982; JDK 9 &#20197;&#21518;&#30340;&#20063;&#26159;&#22914;&#27492;&#12290;</p>
<p>&#22312;&#36825;&#20123;&#26032;&#29256;&#26412;&#30340; JDK &#37324;&#65292;&#21487;&#20197;&#36890;&#36807;&#35843;&#25972;&#23433;&#20840;&#21442;&#25968; <code>crypto.policy</code> &#30340;&#20540;&#26469;&#25913;&#21464;&#40664;&#35748;&#31574;&#30053;&#65292;&#20363;&#22914;&#23558;&#20854;&#35774;&#32622;&#20026; <code>unlimited</code>&#65292;&#23601;&#26159;&#25903;&#25345;&#39640;&#24378;&#24230;&#23494;&#38053;&#12290;&#35774;&#32622;&#26041;&#27861;&#22914;&#19979;&#65306;<code>Security.setProperty("crypto.policy", "unlimited");</code>&#12290;&#24403;&#28982;&#65292;&#26032;&#29256;&#26412;&#40664;&#35748;&#20351;&#29992;&#30340;&#23601;&#26159; <code>unlimited</code>&#65292;&#25152;&#20197;&#25105;&#20204;&#22312;&#21069;&#38754;&#30340;&#20363;&#23376;&#37324;&#27809;&#26377;&#25191;&#34892;&#20219;&#20309;&#25805;&#20316;&#12290;&#22914;&#26524;&#36935;&#21040;&#20102;&#32769;&#29256;&#26412;&#30340; JDK&#65292;&#37027;&#19981;&#35201;&#24536;&#20102;&#26356;&#25442; JCE &#25991;&#20214;&#12290;</p>
</blockquote>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">1</span>&#36825;&#33410;&#20013;&#37197;&#32622;&#20013;&#24515; Config Server &#30340;&#20363;&#23376;&#22312; ch14/configserver &#39033;&#30446;&#20013;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">2</span>&#36825;&#26159;&#31038;&#21306;&#25552;&#30340; JDK &#22686;&#24378;&#38656;&#27714;&#65292;&#23436;&#25972;&#26631;&#39064;&#26159;&#8220;JDK-8170157 : Enable unlimited cryptographic policy by default in Oracle JDK builds&#8221;&#12290;</p><h3 id="nav_point_221">14.1.3&#12288;&#36890;&#36807; Spring Cloud Config Client &#35775;&#38382;&#37197;&#32622;</h3><p>&#32842;&#23436;&#20102; Spring Cloud Config Server&#65292;&#25509;&#19979;&#26469;&#23601;&#35813;&#32842;&#23458;&#25143;&#31471;&#20102;&#12290;&#21407;&#20808;&#37197;&#32622;&#22312;&#23458;&#25143;&#31471;&#30340; <code>application.properties</code> &#37324;&#30340;&#22823;&#37096;&#20998;&#37197;&#32622;&#37117;&#33021;&#25386;&#21040;&#37197;&#32622;&#20013;&#24515;&#37324;&#38598;&#20013;&#31649;&#29702;&#65292;&#24590;&#20040;&#35753;&#25105;&#20204;&#30340;&#31243;&#24207;&#20174;&#37197;&#32622;&#20013;&#24515;&#33719;&#21462;&#37197;&#32622;&#21602;&#65311;</p><p>&#39318;&#20808;&#65292;&#19981;&#31649;&#25105;&#20204;&#20351;&#29992;&#20309;&#31181;&#26041;&#24335;&#65292;&#37117;&#38656;&#35201;&#20808;&#22312; pom.xml &#20013;&#24341;&#20837;&#25152;&#38656;&#30340;&#20381;&#36182; <code>spring-cloud-starter-config</code>&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre><p>&#20854;&#27425;&#65292;&#35201;&#35753;&#23458;&#25143;&#31471;&#36830;&#25509;&#21040; Spring Cloud Config Server&#65292;&#20197;&#20415;&#33021;&#22815;&#33719;&#21462;&#24819;&#35201;&#30340;&#37197;&#32622;&#20449;&#24687;&#12290;&#36825;&#26102;&#26377;&#20004;&#31181;&#26041;&#24335;&#65306;&#31532;&#19968;&#31181;&#26159;&#30452;&#25509;&#37197;&#32622;&#30446;&#26631;&#26381;&#21153;&#31471;&#22320;&#22336;&#65307;&#31532;&#20108;&#31181;&#26159;&#20351;&#29992;&#26381;&#21153;&#21457;&#29616;&#65292;&#20174;&#27880;&#20876;&#20013;&#24515;&#25214;&#21040;&#30446;&#26631;&#26381;&#21153;&#31471;&#22320;&#22336;&#12290;&#19979;&#38754;&#35753;&#25105;&#20204;&#20998;&#21035;&#30475;&#30475;&#36825;&#20004;&#31181;&#26041;&#24335;&#12290;</p><ol>
<li><p><strong>&#30452;&#36830; Spring Cloud Config Server</strong></p>
<p>&#20026;&#20102;&#21578;&#35785; Spring &#21435;&#37197;&#32622;&#20013;&#24515;&#21152;&#36733;&#37197;&#32622;&#65292;Spring Boot 2.4<span class="&#27880;&#37322;&#32534;&#21495;">3</span> &#21069;&#21518;&#26377;&#20004;&#31181;&#19981;&#21516;&#30340;&#26041;&#24335;&#65292;&#29616;&#22312;&#30340;&#40664;&#35748;&#26041;&#24335;&#26159;&#20351;&#29992; <code>spring.config.import</code>&#65292;&#26684;&#24335;&#26159;&#36825;&#26679;&#30340; <span class="&#27880;&#37322;&#32534;&#21495;">4</span>&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.config.import=[optional:]configserver:[&#26381;&#21153;&#31471;&#22320;&#22336;]</code></pre>
<p>&#22240;&#20026;&#30446;&#21069;&#36873;&#25321;&#30340;&#26159;&#30452;&#36830;&#30340;&#26041;&#24335;&#65292;&#32780; <code>spring.cloud.config.uri</code> &#30340;&#40664;&#35748;&#20540;&#26159; <code>http://localhost:8888</code>&#65292;&#25152;&#20197;&#36825;&#27573;&#37197;&#32622;&#40664;&#35748;&#20250;&#21435;&#36830;&#25509;&#36825;&#20010;&#22320;&#22336;&#19978;&#30340; Spring Cloud Config Server&#12290;<code>optional:</code> &#21069;&#32512;&#21017;&#26159;&#21578;&#35785;&#25105;&#20204;&#30340;&#31243;&#24207;&#22914;&#26524;&#36830;&#19981;&#19978;&#37197;&#32622;&#20013;&#24515;&#23601;&#29992;&#33258;&#24049;&#30340;&#26412;&#22320;&#37197;&#32622;&#65307;&#22914;&#26524;&#21435;&#25481;&#36825;&#20010;&#21069;&#32512;&#65292;&#36830;&#19981;&#19978;&#23601;&#30452;&#25509;&#25253;&#38169;&#65292;&#21551;&#21160;&#22833;&#36133;&#12290;&#30446;&#21069;&#25105;&#20204;&#29992;&#30340;&#37197;&#32622;&#20013;&#24515;&#23601;&#26159;&#36825;&#20010;&#22320;&#22336;&#65292;&#25152;&#20197;&#19979;&#38754;&#30340;&#36825;&#20123;&#37197;&#32622;&#25928;&#26524;&#37117;&#26159;&#19968;&#26679;&#30340;&#65288;&#37117;&#19981;&#24102; <code>optional:</code> &#30340;&#35805;&#20063;&#26159;&#23545;&#31561;&#30340;&#65289;&#65292;&#25512;&#33616;&#30452;&#25509;&#29992;&#31532;&#20108;&#31181;&#26041;&#24335;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code># &#26041;&#24335;1&#65306;&#29992;&#40664;&#35748;&#22320;&#22336;
spring.config.import=optional:configserver:

# &#26041;&#24335;2&#65306;&#26126;&#30830;&#20889;&#20986;&#22320;&#22336;
spring.config.import=optional:configserver:http://localhost:8888

# &#26041;&#24335;3&#65306;&#37197;&#32622;spring.cloud.config.uri
spring.cloud.config.uri=http://localhost:8888
spring.config.import=optional:configserver:</code></pre>
<p>&#22312;&#36830;&#19978;&#37197;&#32622;&#20013;&#24515;&#21518;&#65292;Spring Cloud Config Client &#20250;&#26681;&#25454;&#24403;&#21069;&#37197;&#32622;&#30340;&#24212;&#29992;&#21517;&#26469;&#21152;&#36733;&#37197;&#32622;&#65292;&#20063;&#23601;&#26159;&#20351;&#29992; <code>spring.application.name</code> &#37197;&#32622;&#65292;&#40664;&#35748;&#20540;&#26159; <code>application</code>&#65292;&#20687;&#25105;&#20204;&#30340;&#37197;&#32622;&#25991;&#20214;&#37324;&#23601;&#25226;&#36825;&#20010;&#37197;&#32622;&#20026; <code>binarytea</code>&#65292;&#25152;&#20197;&#20250;&#21435;&#21152;&#36733;&#23545;&#24212;&#30340;&#37197;&#32622;&#12290;</p>
<p>&#22914;&#26524;&#20320;&#36824;&#22312;&#20351;&#29992; Spring Boot 2.4 &#20197;&#21069;&#30340;&#29256;&#26412;&#65292;&#25110;&#32773;&#23545; <code>bootstrap.properties</code> &#25110; <code>bootstrap.yml</code> &#25991;&#20214;&#24773;&#26377;&#29420;&#38047;&#65292;&#20063;&#21487;&#20197;&#32487;&#32493;&#20351;&#29992; Bootstrap &#26041;&#24335;&#12290;&#26368;&#31616;&#21333;&#30340;&#26041;&#27861;&#26159;&#22312; pom.xml &#20013;&#22686;&#21152;&#19968;&#20010;&#20381;&#36182;&#65292;&#20854;&#20013;&#26377;&#19968;&#20010;&#26631;&#35760;&#31867; <code>Marker</code>&#65292;Spring Cloud &#22312; CLASSPATH &#20013;&#21457;&#29616;&#23427;&#26102;&#23601;&#20250;&#37325;&#26032;&#21551;&#21160;&#23545; Bootstrap &#30340;&#25903;&#25345;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>&#22914;&#26524;&#35201;&#28145;&#20837;&#25506;&#31350;&#30340;&#35805;&#65292;&#21487;&#20197;&#30475;&#30475; <code>ConditionalOnBootstrapEnabled.OnBootstrapEnabledCondition</code> &#36825;&#20010;&#26465;&#20214;&#31867;&#65292;&#23427;&#32487;&#25215;&#33258; <code>AnyNestedCondition</code>&#65292;&#20063;&#23601;&#26159;&#20854;&#20013;&#21253;&#21547;&#30340;&#20219;&#24847;&#26465;&#20214;&#25104;&#31435;&#21017;&#25972;&#20010;&#26465;&#20214;&#21028;&#26029;&#25104;&#31435;&#12290;<code>OnBootstrapEnabledCondition</code> &#20013;&#26377;&#19977;&#20010;&#21028;&#26029;&#65306;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">CLASSPATH &#20013;&#23384;&#22312; <code>org.springframework.cloud.bootstrap.marker.Marker</code>&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#23384;&#22312; <code>spring.config.use-legacy-processing</code> &#23646;&#24615;&#65292;&#19988;&#19981;&#20026; <code>false</code>&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#23384;&#22312; <code>spring.cloud.bootstrap.enabled</code> &#23646;&#24615;&#65292;&#19988;&#19981;&#20026; <code>false</code>&#12290;</li>
</ul>
<p>&#20851;&#20110;&#21518;&#20004;&#20010;&#21028;&#26029;&#37324;&#29992;&#21040;&#30340;&#23646;&#24615;&#65292;&#24517;&#39035;&#37197;&#32622;&#22312;&#29615;&#22659;&#21464;&#37327;&#12289;Java &#31995;&#32479;&#23646;&#24615;&#25110;&#32773;&#21629;&#20196;&#34892;&#21442;&#25968;&#37324;&#65292;&#19981;&#33021;&#25918;&#22312;&#37197;&#32622;&#25991;&#20214;&#37324;&#12290;&#21407;&#22240;&#20063;&#24456;&#31616;&#21333;&#65292;&#23427;&#23601;&#26159;&#19987;&#38376;&#29992;&#26469;&#21551;&#29992; Bootstrap &#38454;&#27573;&#30340;&#65292;&#36825;&#20010;&#38454;&#27573;&#36890;&#24120;&#29992;&#26469;&#23548;&#20837;&#37197;&#32622;&#65292;&#29305;&#21035;&#26159;&#36828;&#31243;&#30340;&#37197;&#32622;&#65292;&#22312;&#27492;&#20043;&#21069;&#36824;&#27809;&#26377;&#35835;&#21462;&#37197;&#32622;&#25991;&#20214;&#65292;&#21448;&#24590;&#20040;&#33021;&#21152;&#36733;&#21040;&#21602;&#65311;</p>
<p>&#35828;&#21040; Bootstrap&#65292;Spring Cloud &#30340; Bootstrap &#20854;&#23454;&#20063;&#23601;&#26159;&#22810;&#21152;&#36733;&#20102;&#19968;&#20123;&#37197;&#32622;&#31867;&#65292;&#25171;&#24320; spring-cloud-context &#30340; <code>META-INF/spring.factories</code> &#25991;&#20214;&#65292;&#21487;&#20197;&#30475;&#21040;&#31867;&#20284;&#19979;&#38754;&#30340;&#20869;&#23481;&#65292;&#20854;&#20013;&#25551;&#36848;&#20102;&#35201;&#21152;&#36733;&#30340;&#37197;&#32622;&#31867;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code># Spring Cloud Bootstrap components
org.springframework.cloud.bootstrap.BootstrapConfiguration=\
org.springframework.cloud.bootstrap.config.PropertySourceBootstrapConfiguration,\
org.springframework.cloud.bootstrap.encrypt.EncryptionBootstrapConfiguration,\
org.springframework.cloud.autoconfigure.ConfigurationPropertiesRebinderAutoConfiguration,\
org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration</code></pre>
<p>&#36825;&#26102;&#65292;&#21487;&#20197;&#22312; <code>bootstrap.properties</code> &#25991;&#20214;&#20013;&#37197;&#32622;&#24212;&#29992;&#21517;&#21644; Spring Cloud Config Server &#30340;&#20449;&#24687;&#65292;&#23601;&#20687;&#20195;&#30721;&#31034;&#20363; 14-4<span class="&#27880;&#37322;&#32534;&#21495;">5</span> &#37027;&#26679;&#12290;&#36825;&#26102;&#35831;&#35760;&#24471;&#21435;&#25481; <code>application.properties</code> &#37324;&#30340; <code>spring.config.import</code>&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-4</strong>&#12288;BinaryTea &#24037;&#31243;&#20013;&#26032;&#22686;&#30340; <code>bootstrap.properties</code> &#25991;&#20214;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.application.name=binarytea
spring.cloud.config.uri=http://localhost:8888</code></pre>
<p>&#160;</p>
</li>
<li><p><strong>&#36890;&#36807;&#26381;&#21153;&#21457;&#29616;&#25214;&#21040; Spring Cloud Config Server</strong></p>
<p>&#20551;&#35774;&#25105;&#20204;&#30340; Spring Cloud Config Server &#31243;&#24207;&#20351;&#29992; <code>config-server</code> &#20316;&#20026;&#24212;&#29992;&#21517;&#27880;&#20876;&#21040;&#20102; Zookeeper &#19978;&#65292;&#37027;&#25105;&#20204;&#35813;&#24590;&#20040;&#36890;&#36807;&#22522;&#20110; Zookeeper &#30340;&#26381;&#21153;&#21457;&#29616;&#26426;&#21046;&#26469;&#25214;&#21040;&#23427;&#21602;&#65311;</p>
<p>&#24403;&#28982;&#65292;&#31532;&#19968;&#27493;&#32943;&#23450;&#26159;&#22312;&#39033;&#30446;&#20013;&#24341;&#20837;&#26381;&#21153;&#21457;&#29616;&#30340;&#20381;&#36182;&#65292;&#20363;&#22914;&#20043;&#21069;&#19968;&#30452;&#22312;&#29992;&#30340; <code>spring-cloud-starter-zookeeper-discovery</code>&#12290;&#31532;&#20108;&#27493;&#23601;&#26159;&#37197;&#32622;&#26381;&#21153;&#30340;&#27880;&#20876;&#20013;&#24515;&#22320;&#22336;&#65292;&#36825;&#37324;&#25105;&#20204;&#29992;&#30340;&#26159; Zookeeper&#65292;&#25152;&#20197;&#23601;&#35201;&#37197;&#32622; Zookeeper &#30340;&#36830;&#25509;&#20449;&#24687;&#12290;&#26368;&#21518;&#19968;&#27493;&#26159;&#21578;&#35785; Spring Cloud Config Client&#65292;&#36890;&#36807;&#26381;&#21153;&#27880;&#20876;&#20013;&#24515;&#21435;&#21457;&#29616;&#37197;&#32622;&#20013;&#24515;&#12290;</p>
<p>&#20855;&#20307;&#30340;&#37197;&#32622;&#20195;&#30721;&#22914;&#20195;&#30721;&#31034;&#20363; 14-5<span class="&#27880;&#37322;&#32534;&#21495;">6</span> &#25152;&#31034;&#65292;&#20854;&#20013;&#26368;&#37325;&#35201;&#30340;&#26159; <code>spring.cloud.config.discovery.enabled</code> &#24320;&#21551;&#20102;&#30456;&#20851;&#25903;&#25345;&#65292;&#23427;&#40664;&#35748;&#26159; <code>false</code>&#65307;&#28982;&#21518;&#36890;&#36807; <code>spring.cloud.config.discovery.service-id</code> &#32473;&#20986;&#20102; Spring Cloud Config Server &#23545;&#24212;&#30340;&#26381;&#21153;&#21517;&#65292;&#23427;&#30340;&#40664;&#35748;&#20540;&#26159; <code>configserver</code>&#65292;&#20026;&#20102;&#28436;&#31034;&#65292;&#25105;&#20204;&#25925;&#24847;&#22312;&#24403;&#20013;&#21152;&#20102;&#20010; <code>-</code> &#20570;&#21306;&#21035;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-5</strong>&#12288;BinaryTea &#24037;&#31243;&#20013;&#19982;&#21457;&#29616;&#37197;&#32622;&#20013;&#24515;&#26377;&#20851;&#30340; <code>application.properties</code> &#37197;&#32622;&#29255;&#27573;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.application.name=binarytea

spring.cloud.zookeeper.connect-string=localhost:2181

spring.config.import=configserver:
spring.cloud.config.discovery.enabled=true
spring.cloud.config.discovery.service-id=config-server</code></pre>
<p>&#19978;&#38754;&#26159;&#30446;&#21069;&#25512;&#33616;&#30340;&#20351;&#29992; <code>spring.config.import</code> &#30340;&#26041;&#24335;&#65292;&#22914;&#26524;&#24819;&#29992;&#20256;&#32479;&#30340; Bootstrap &#26041;&#24335;&#20063;&#26159;&#21487;&#20197;&#30340;&#12290;&#20808;&#29992;&#21069;&#25991;&#20171;&#32461;&#30340;&#26041;&#27861;&#24320;&#21551; Bootstrap &#26041;&#24335;&#25903;&#25345;&#65292;&#38543;&#21518;&#23558;&#20195;&#30721;&#31034;&#20363; 14-5 &#20013;&#30340;&#37197;&#32622;&#21435;&#25481; <code>spring.config.import</code>&#65292;&#21097;&#19979;&#30340;&#20869;&#23481;&#25644;&#21040; <code>bootstrap.properties</code> &#20013;&#12290;</p>
<blockquote>
<p><strong>&#35831;&#27880;&#24847;</strong>&#12288;&#30001;&#20110;&#22312; Bootstrap &#38454;&#27573;&#19968;&#20123; Bean &#24050;&#32463;&#22768;&#26126;&#36807;&#20102;&#65292;&#20363;&#22914; <code>zookeeperDiscoveryProperties</code>&#65292;&#22312;&#21518;&#32493;&#27491;&#24120;&#21551;&#21160;&#38454;&#27573;&#20877;&#27425;&#22768;&#26126;&#21516; ID &#30340; Bean &#26102;&#20250;&#25243;&#20986; <code>BeanDefinitionOverrideException</code> &#24322;&#24120;&#12290;&#22914;&#26524;&#36935;&#21040;&#31867;&#20284;&#30340;&#38382;&#39064;&#65292;&#21487;&#20197;&#26681;&#25454;&#38169;&#35823;&#25552;&#31034;&#20449;&#24687;&#65292;&#22312; <code>bootstrap.properties</code> &#25991;&#20214;&#20013;&#22686;&#21152;&#22914;&#19979;&#37197;&#32622;&#65292;&#24320;&#21551; Bean &#23450;&#20041;&#35206;&#30422;&#65292;&#36825;&#20010;&#37197;&#32622;&#20174; Spring Boot 2.1 &#24320;&#22987;&#40664;&#35748;&#20026; <code>false</code>&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.main.allow-bean-definition-overriding=true</code></pre>
</blockquote>
<p>&#38500;&#20102;&#19978;&#38754;&#25552;&#21040;&#30340;&#37197;&#32622;&#65292;Spring Cloud Config Client &#36824;&#26377;&#19968;&#20123;&#20854;&#20182;&#37197;&#32622;&#65292;&#20363;&#22914;&#36229;&#26102;&#35774;&#32622;&#65292;&#34920; 14-4 &#20013;&#32599;&#21015;&#20102;&#20960;&#20010;&#24120;&#29992;&#30340;&#37197;&#32622;&#12290;</p>
<p><strong>&#34920; 14-4&#12288;Spring Cloud Config Client &#30340;&#24120;&#29992;&#37197;&#32622;</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>&#37197;&#32622;&#39033;</th><th>&#40664;&#35748;&#20540;</th><th>&#35828;&#26126;</th></tr><tr><td><code>spring.cloud.config.enabled</code></td><td><code>true</code></td><td>&#26159;&#21542;&#24320;&#21551; Spring Cloud Config &#25903;&#25345;</td></tr><tr><td><code>spring.cloud.config.uri</code></td><td>http://localhost:8888</td><td>Spring Cloud Config Server &#22320;&#22336;</td></tr><tr><td><code>spring.cloud.config.fail-fast</code></td><td><code>false</code></td><td>&#26080;&#27861;&#20174;&#26381;&#21153;&#31471;&#33719;&#21462;&#37197;&#32622;&#23601;&#24555;&#36895;&#22833;&#36133;</td></tr><tr><td><code>spring.cloud.config.username</code></td><td></td><td>&#29992;&#20110; HTTP Basic &#35748;&#35777;&#30340;&#29992;&#25143;&#21517;</td></tr><tr><td><code>spring.cloud.config.password</code></td><td></td><td>&#29992;&#20110; HTTP Basic &#35748;&#35777;&#30340;&#23494;&#30721;</td></tr><tr><td><code>spring.cloud.config.request-read-timeout</code></td><td><code>185000</code></td><td>&#35835;&#21462;&#37197;&#32622;&#26102;&#30340;&#36229;&#26102;&#26102;&#38388;&#65292;&#21333;&#20301;&#20026;&#27627;&#31186;</td></tr><tr><td><code>spring.cloud.config.request-connect-timeout</code></td><td><code>10000</code></td><td>&#36830;&#25509;&#30340;&#36229;&#26102;&#26102;&#38388;&#65292;&#21333;&#20301;&#20026;&#27627;&#31186;</td></tr><tr><td><code>spring.cloud.config.discovery.enabled</code></td><td><code>false</code></td><td>&#26159;&#21542;&#36890;&#36807;&#26381;&#21153;&#27880;&#20876;&#20013;&#24515;&#21457;&#29616;&#37197;&#32622;&#26381;&#21153;</td></tr><tr><td><code>spring.cloud.config.discovery.service-id</code></td><td><code>configserver</code></td><td>Spring Cloud Config Server &#30340;&#26381;&#21153;&#21517;</td></tr></table>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">3</span>&#23545;&#24212;&#30340; Spring Cloud &#29256;&#26412;&#26159; 2020.0.0&#65292;&#25152;&#20197;&#20063;&#21487;&#20197;&#35748;&#20026;&#26159;&#20174;&#36825;&#20010;&#29256;&#26412;&#24320;&#22987;&#65292;Bootstrap &#38454;&#27573;&#19981;&#20877;&#40664;&#35748;&#24320;&#21551;&#20102;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">4</span>&#20854;&#20013;&#30340; <code>[]</code> &#34920;&#31034;&#36825;&#37096;&#20998;&#26159;&#21487;&#36873;&#30340;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">5</span>&#36825;&#20010;&#20363;&#23376;&#22312; ch14/binarytea-directly &#39033;&#30446;&#20013;&#12290;&#36825;&#20010;&#20363;&#23376;&#28436;&#31034;&#20102;&#20351;&#29992; Bootstrap &#30452;&#36830;&#37197;&#32622;&#20013;&#24515;&#30340;&#26041;&#24335;&#12290;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#20854;&#20013;&#21435;&#25481;&#20102;&#19978;&#19968;&#31456;&#30340;&#26381;&#21153;&#21457;&#29616;&#19982;&#27880;&#20876;&#25903;&#25345;&#65292;&#21407;&#22240;&#26159;&#26377;&#36825;&#20010;&#20381;&#36182;&#23545; <code>spring.config.import</code> &#26377;&#24433;&#21709;&#65292;&#36825;&#20010;&#21151;&#33021;&#22312;&#21518;&#38754;&#20250;&#21152;&#22238;&#21435;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">6</span>&#36825;&#20010;&#20363;&#23376;&#22312; ch14/binarytea-discovery &#39033;&#30446;&#20013;&#12290;</p><h2 id="nav_point_222">14.2&#12288;&#26381;&#21153;&#37197;&#32622;&#30340;&#23454;&#29616;&#21407;&#29702;&#19982;&#24212;&#29992;</h2><p>Spring Cloud Config &#22522;&#20110; Spring Boot &#21644; Spring Framework &#25552;&#20379;&#30340;&#26426;&#21046;&#65292;&#20026;&#24320;&#21457;&#32773;&#23553;&#35013;&#20102;&#19968;&#22871;&#24320;&#31665;&#21363;&#29992;&#30340;&#20998;&#24067;&#24335;&#37197;&#32622;&#31649;&#29702;&#35299;&#20915;&#26041;&#26696;&#12290;&#22312;&#19978;&#19968;&#33410;&#37324;&#65292;&#25105;&#20204;&#24050;&#32463;&#36890;&#36807;&#23454;&#38469;&#30340;&#20363;&#23376;&#30475;&#21040;&#20102;&#22914;&#20309;&#20351;&#29992; Spring Cloud Config Server &#21644;&#23545;&#24212;&#30340;&#23458;&#25143;&#31471;&#26469;&#38598;&#20013;&#31649;&#29702;&#37197;&#32622;&#65292;&#24182;&#22312;&#24212;&#29992;&#20013;&#21152;&#36733;&#36828;&#31243;&#37197;&#32622;&#12290;&#36825;&#19968;&#20999;&#26159;&#22914;&#20309;&#23454;&#29616;&#30340;&#65311;Spring Cloud Config &#36824;&#25903;&#25345;&#29992;&#20854;&#20182;&#20960;&#31181;&#22522;&#30784;&#35774;&#26045;&#26469;&#20805;&#24403;&#37197;&#32622;&#20013;&#24515;&#65292;&#21448;&#35813;&#22914;&#20309;&#20351;&#29992;&#23427;&#20204;&#21602;&#65311;</p><h3 id="nav_point_223">14.2.1&#12288;&#26381;&#21153;&#37197;&#32622;&#30340;&#23454;&#29616;&#21407;&#29702;</h3><p>&#22312; 2.4 &#33410;&#20013;&#65292;&#25105;&#20204;&#20171;&#32461;&#36807; Spring Framework &#30340;&#29615;&#22659;&#25277;&#35937;&#65292;&#23588;&#20854;&#26159; <code>PropertySource</code>&#65292;&#21508;&#31181;&#23646;&#24615;&#20854;&#23454;&#37117;&#26159;&#22312;&#19968;&#20010;&#20010;&#30340; <code>PropertySource</code> &#37324;&#26597;&#25214;&#21644;&#35299;&#26512;&#30340;&#12290;&#25152;&#20197;&#65292;&#22914;&#26524;&#29992;&#19968;&#21477;&#35805;&#26469;&#35299;&#37322; Spring Cloud Config &#30340;&#24037;&#20316;&#21407;&#29702;&#65292;&#37027;&#23601;&#26159;&#23427;&#22312; <code>Environment</code> &#37324;&#22686;&#21152;&#20102;&#19968;&#20010;&#25110;&#20960;&#20010;&#21487;&#20197;&#20174;&#36828;&#31471;&#21152;&#36733;&#37197;&#32622;&#39033;&#30340; <code>PropertySource</code>&#12290;</p><p>&#20173;&#28982;&#20197; Spring Cloud Config Client &#20026;&#20363;&#65292;&#25105;&#20204;&#21487;&#20197;&#24819;&#35937;&#21040;&#23458;&#25143;&#31471;&#20854;&#23454;&#26159;&#29992; <code>RestTemplate</code> &#26469;&#35831;&#27714;&#26381;&#21153;&#31471;&#33719;&#21462;&#37197;&#32622;&#30340;&#65292;&#20107;&#23454;&#20063;&#26159;&#22914;&#27492;&#65292;&#20294;&#23427;&#20204;&#21448;&#26159;&#24590;&#20040;&#21464;&#25104; <code>PropertySource</code> &#30340;&#21602;&#65311;</p><ol>
<li><p><strong>&#23545; spring.config.import &#30340;&#25903;&#25345;</strong></p>
<p>Spring Boot 2.4 &#24320;&#22987;&#25552;&#20379;&#36825;&#31181;&#23548;&#20837;&#37197;&#32622;&#30340;&#26041;&#24335;&#65292;<code>ConfigDataImporter</code> &#36127;&#36131;&#29992; <code>ConfigDataLoader</code> &#21152;&#36733;&#37197;&#32622;&#24182;&#23384;&#36827; <code>ConfigData</code>&#65292;&#32780; <code>ConfigDataEnvironmentPostProcessor</code> &#21448;&#23558; <code>ConfigData</code> &#30340;&#23646;&#24615;&#25918;&#36827; <code>Environment</code>&#65292;&#25972;&#20010;&#36807;&#31243;&#19968;&#29615;&#25187;&#19968;&#29615;&#12290;</p>
<p>&#22238;&#21040; Spring Cloud Config Client&#65292;<code>META-INF/spring.factories</code> &#37324;&#26377;&#22914;&#19979;&#30340;&#23450;&#20041;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code># ConfigData Location Resolvers
org.springframework.boot.context.config.ConfigDataLocationResolver=\
org.springframework.cloud.config.client.ConfigServerConfigDataLocationResolver

# ConfigData Loaders
org.springframework.boot.context.config.ConfigDataLoader=\
org.springframework.cloud.config.client.ConfigServerConfigDataLoader</code></pre>
<p>&#25152;&#20197;&#25105;&#20204;&#21487;&#20197;&#20808;&#21435;&#35835;&#19968;&#19979; <code>ConfigServerConfigDataLocationResolver</code>&#65292;&#30475;&#21040; <code>PREFIX = "configserver:"</code> &#26159;&#21542;&#26377;&#20284;&#26366;&#30456;&#35782;&#30340;&#24863;&#35273;&#65311;&#27809;&#38169;&#65292;&#20043;&#21069; <code>spring.config.import=optional:configserver:</code> &#20013;&#30340; <code>configserver:</code> &#23601;&#26159;&#22312;&#36825;&#37324;&#23450;&#20041;&#30340;&#12290;&#32780;&#19988;&#23427;&#20250;&#36127;&#36131;&#35299;&#26512;&#20986; <code>ConfigServerConfigDataResource</code>&#65292;&#21518;&#32493; <code>ConfigServerConfigDataLoader</code> &#20877;&#20174;&#37324;&#38754;&#21435;&#21152;&#36733;&#37197;&#32622;&#65292;&#20445;&#23384;&#21040; <code>ConfigData</code> &#37324;&#65292;&#20854;&#20013;&#30340; <code>MapPropertySource</code> &#21517;&#23383;&#20026; <code>configClient</code>&#12290;&#24863;&#20852;&#36259;&#30340;&#21487;&#20197;&#30475;&#30475; <code>ConfigServerConfigDataLoader.load()</code> &#26041;&#27861;&#65292;&#23427;&#26159;&#36127;&#36131;&#21152;&#36733;&#20855;&#20307;&#37197;&#32622;&#30340;&#26041;&#27861;&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#23545; Bootstrap &#26041;&#24335;&#30340;&#25903;&#25345;</strong></p>
<p>&#20877;&#26469;&#30475;&#30475; Bootstrap &#26041;&#24335;&#21448;&#26159;&#24590;&#20040;&#23454;&#29616;&#30340;&#65292;&#21516;&#26679;&#26159;&#20174; <code>META-INF/spring.factories</code> &#37324;&#23547;&#25214;&#31361;&#30772;&#21475;&#65292;&#25105;&#20204;&#21457;&#29616;&#20102;&#20004;&#20010;&#37197;&#32622;&#31867;&#65292;<code>ConfigServiceBootstrapConfiguration</code> &#20570;&#22522;&#26412;&#37197;&#32622;&#65292;<code>DiscoveryClientConfigServiceBootstrapConfiguration</code> &#25552;&#20379;&#19968;&#20123;&#20174;&#26381;&#21153;&#27880;&#20876;&#20013;&#24515;&#33719;&#21462; Spring Cloud Config Server &#23454;&#20363;&#30340;&#37197;&#32622;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code># Bootstrap components
org.springframework.cloud.bootstrap.BootstrapConfiguration=\
org.springframework.cloud.config.client.ConfigServiceBootstrapConfiguration,\
org.springframework.cloud.config.client.DiscoveryClientConfigServiceBootstrapConfiguration</code></pre>
<p>&#36825;&#37324;&#26368;&#37325;&#35201;&#30340;&#23601;&#26159;&#26681;&#25454; <code>spring.cloud.config.enabled</code> &#37197;&#32622;&#27880;&#20876;&#20102;&#19968;&#20010; <code>ConfigServicePropertySourceLocator</code> Bean&#65292;&#32780;&#36825;&#20010; Bean &#20250;&#20351;&#29992; <code>RestTemplate</code> &#20174;&#36828;&#31471;&#21152;&#36733;&#37197;&#32622;&#65292;&#24182;&#36820;&#22238;&#21517;&#20026; <code>configService</code> &#30340; <code>OriginTrackedCompositePropertySource</code>&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#21047;&#26032;&#37197;&#32622;</strong></p>
<p>&#22312; 14.1.1 &#20013;&#25105;&#20204;&#35828;&#36807;&#65292;&#23545;&#20110;&#37197;&#32622;&#20013;&#24515;&#65292;&#25105;&#20204;&#26377;&#20004;&#20010;&#22522;&#26412;&#35201;&#27714;&#65306;&#20854;&#19968;&#26159;&#24076;&#26395;&#33021;&#38598;&#20013;&#31649;&#29702;&#65292;&#20854;&#20108;&#26159;&#24076;&#26395;&#33021;&#22312;&#37197;&#32622;&#21464;&#26356;&#21518;&#24555;&#36895;&#29983;&#25928;&#12290;&#25105;&#20204;&#24050;&#32463;&#30693;&#36947;&#20102; Spring Cloud Config &#26159;&#22914;&#20309;&#38598;&#20013;&#31649;&#29702;&#37197;&#32622;&#24182;&#35753;&#23458;&#25143;&#31471;&#25353;&#38656;&#33719;&#21462;&#37197;&#32622;&#30340;&#65292;&#37027;&#21448;&#35813;&#22914;&#20309;&#23454;&#29616;&#31532;&#20108;&#28857;&#21602;&#65311;Spring Cloud Context &#20026;&#25105;&#20204;&#25552;&#20379;&#20102;&#19968;&#20010; <code>@RefreshScope</code> &#27880;&#35299;&#65292;&#28155;&#21152;&#20102;&#35813;&#27880;&#35299;&#30340; Bean &#20250;&#34987;&#25918;&#21040;&#21517;&#20026; <code>refresh</code> &#30340;&#20316;&#29992;&#22495;&#37324;&#65288;&#23545;&#24212; <code>RefreshScope</code> &#31867;&#65289;&#65292;&#20854;&#20013;&#30340; Bean &#33021;&#22312;&#36816;&#34892;&#26102;&#34987;&#21047;&#26032;&#65292;&#20381;&#36182;&#23427;&#20204;&#30340;&#32452;&#20214;&#22312;&#19979;&#27425;&#35843;&#29992;&#20854;&#20013;&#30340;&#26041;&#27861;&#21069;&#20250;&#25343;&#21040;&#26032;&#30340;&#23454;&#20363;&#12290;</p>
<p>&#20026;&#20102;&#35302;&#21457;&#24102; <code>@RefreshScope</code> &#27880;&#35299;&#30340; Bean &#30340;&#21047;&#26032;&#65292;Spring Cloud Context &#36824;&#25552;&#20379;&#20102;&#19968;&#20010; Actuator &#31471;&#28857;&#8212;&#8212;<code>RefreshEndpoint</code>&#12290;&#22914;&#26524;&#27809;&#26377;&#35843;&#25972;&#36807; Actuator &#30340; URL&#65292;&#21487;&#20197;&#36890;&#36807; <code>/actuator/refresh</code> &#26469;&#35302;&#21457; <code>ContextRefresher</code> &#21047;&#26032;&#36825;&#20123; Bean&#12290;&#35753;&#25105;&#20204;&#36890;&#36807;&#19968;&#20010;&#20363;&#23376;&#26469;&#30475;&#30475;&#22914;&#20309;&#23454;&#29616;&#37197;&#32622;&#24555;&#36895;&#29983;&#25928;&#12290;</p>
<blockquote>
<p><strong>&#38656;&#27714;&#25551;&#36848;</strong>&#12288;&#29616;&#22312;&#27969;&#34892;&#19968;&#21477;&#35805;&#8212;&#8220;&#35753;&#21548;&#24471;&#21040;&#28846;&#22768;&#30340;&#20154;&#26469;&#20915;&#31574;&#8221;&#12290;&#22914;&#26524;&#38376;&#24215;&#30340;&#24215;&#38271;&#21457;&#29616;&#21516;&#19968;&#26465;&#34903;&#19978;&#21448;&#26032;&#24320;&#20102;&#23478;&#22902;&#33590;&#24215;&#65292;&#21487;&#20197;&#20020;&#26102;&#20915;&#23450;&#35843;&#25972;&#33829;&#19994;&#26102;&#38388;&#21644;&#25240;&#25187;&#21147;&#24230;&#65292;&#32780;&#19988;&#26377;&#26435;&#35201;&#27714;&#21363;&#21051;&#29983;&#25928;&#12290;</p>
</blockquote>
<p>&#22312;&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#30340;&#20363;&#23376;&#20013;&#65292;&#36825;&#20010;&#38656;&#27714;&#21487;&#20197;&#32763;&#35793;&#20026;&#8220;&#33021;&#22815;&#25353;&#38656;&#35843;&#25972; <code>binarytea.open-hours</code> &#21644; <code>binarytea.discount</code> &#30340;&#20540;&#65292;&#24182;&#19988;&#24555;&#36895;&#29983;&#25928;&#8221;&#12290;&#22312; 14.1.2 &#33410;&#37324;&#65292;&#36825;&#20004;&#20010;&#21442;&#25968;&#37117;&#24050;&#32463;&#34987;&#25105;&#20204;&#25918;&#21040; Spring Cloud Config Server &#23545;&#24212;&#30340;&#20179;&#24211;&#37324;&#20102;&#65292;&#29616;&#22312;&#35201;&#20570;&#30340;&#23601;&#26159;&#35843;&#25972; BinaryTea &#30340;&#20195;&#30721;&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">7</span></p>
<p>&#39318;&#20808;&#65292;&#22312; <code>binarytea.*</code> &#37197;&#32622;&#23545;&#24212;&#30340; <code>BinaryTeaProperties</code> &#37324;&#22686;&#21152;&#25240;&#25187;&#30340;&#23646;&#24615;&#65292;&#21516;&#26102;&#20026;&#23427;&#21152;&#19978; <code>@RefreshScope</code> &#27880;&#35299;&#20197;&#20415;&#21518;&#32493;&#21487;&#20197;&#21047;&#26032;&#37197;&#32622;&#65292;&#20855;&#20307;&#22914;&#20195;&#30721;&#31034;&#20363; 14-6 &#25152;&#31034;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-6</strong>&#12288;&#22686;&#21152;&#20102;&#27880;&#35299;&#21644;&#23646;&#24615;&#30340; <code>BinaryTeaProperties</code> &#20195;&#30721;&#29255;&#27573;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@ConfigurationProperties("binarytea")
@RefreshScope
public class BinaryTeaProperties {
    private boolean ready;
    private String openHours;
    private int discount = 100;
    // &#30465;&#30053;&#20854;&#20182;&#20195;&#30721;
}</code></pre>
<p>&#25509;&#19979;&#26469;&#65292;&#38656;&#35201;&#35843;&#25972;&#19982;&#25240;&#25187;&#30456;&#20851;&#30340;&#20195;&#30721;&#36923;&#36753;&#12290;&#26412;&#26469;&#25240;&#25187;&#37117;&#26159;&#36890;&#36807; <code>HTTP</code> &#35831;&#27714;&#25552;&#20132;&#19978;&#26469;&#30340;&#65292;&#29616;&#22312;&#25105;&#20204;&#35201;&#22686;&#21152;&#19968;&#20010;&#36923;&#36753;&#65306;&#22914;&#26524;&#35831;&#27714;&#20013;&#32473;&#20986;&#30340;&#25240;&#25187;&#26159; 100&#65288;&#20063;&#23601;&#26159;&#19981;&#25171;&#25240;&#65289;&#65292;&#32780;&#25105;&#20204;&#22312;&#21518;&#21488;&#37197;&#32622;&#20102;&#19968;&#20010;&#25240;&#25187;&#65292;&#37027;&#23601;&#35201;&#20197;&#21518;&#21488;&#37197;&#32622;&#30340;&#25240;&#25187;&#20026;&#20934;&#65307;&#22914;&#26524;&#21069;&#21488;&#20256;&#20837;&#20102;&#20855;&#20307;&#30340;&#25240;&#25187;&#65292;&#21017;&#20197;&#20256;&#20837;&#30340;&#20026;&#20934;&#12290;&#36825;&#27573;&#36923;&#36753;&#21487;&#20197;&#25918;&#22312; <code>OrderService.createOrder()</code> &#37324;&#65292;&#20855;&#20307;&#22914;&#20195;&#30721;&#31034;&#20363; 14-7 &#25152;&#31034;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-7</strong>&#12288;&#22686;&#21152;&#20102;&#25240;&#25187;&#36923;&#36753;&#30340; <code>OrderService</code></p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Service
@Transactional
public class OrderService {
    @Autowired
    private OrderRepository orderRepository;
    @Autowired
    private BinaryTeaProperties binaryTeaProperties;

    @RolesAllowed({ "MANAGER", "TEA_MAKER" })
    public Order createOrder(List&lt;MenuItem&gt; itemList, int discount) {
        int newDiscount = discount == 100 ? binaryTeaProperties.getDiscount() : discount;
        Money total = itemList.stream().map(i -&gt; i.getPrice())
            .collect(Collectors.collectingAndThen(Collectors.toList(),
                l -&gt; Money.total(l)));
        Money pay = total.multipliedBy(newDiscount / 100d, RoundingMode.HALF_DOWN);

        Amount amount = Amount.builder()
                                .discount(newDiscount)
                                .totalAmount(total)
                                .payAmount(pay)
                                .build();
        Order order = Order.builder()
                             .amount(amount)
                             .status(OrderStatus.ORDERED)
                             .items(itemList)
                             .build();
        return orderRepository.save(order);
    }
    // &#30465;&#30053;&#20854;&#20182;&#20195;&#30721;
}</code></pre>
<p>&#26368;&#21518;&#65292;&#20026;&#20102;&#35753;&#37197;&#32622;&#30340;&#21464;&#26356;&#33021;&#24555;&#36895;&#29983;&#25928;&#65292;&#25105;&#20204;&#25171;&#31639;&#36890;&#36807; <code>/actuator/refresh</code> &#26469;&#25163;&#21160;&#35302;&#21457;&#21047;&#26032;&#65292;&#20026;&#27492;&#65292;&#36824;&#38656;&#35201;&#23558;&#23427;&#26292;&#38706;&#22312; Web &#31471;&#28857;&#37324;&#65292;&#25152;&#20197;&#35201;&#20687;&#20195;&#30721;&#31034;&#20363; 14-8 &#37027;&#26679;&#65292;&#35843;&#25972; <code>application.properties</code> &#37324;&#30340;&#31471;&#28857;&#37197;&#32622;&#65292;&#22686;&#21152; <code>refresh</code>&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-8</strong>&#12288;&#35843;&#25972;&#21518;&#30340;&#31471;&#28857;&#37197;&#32622;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>management.endpoints.web.exposure.include=health,info,shop,metrics,refresh</code></pre>
<p>&#22312;&#36816;&#34892;&#31243;&#24207;&#21518;&#65292;&#19968;&#24320;&#22987;&#25105;&#20204;&#21462;&#21040;&#30340;&#25240;&#25187;&#26159; 100&#65292;&#28982;&#21518;&#35843;&#25972;&#19968;&#19979; <code>binarytea.properties</code> &#20013;&#30340; <code>binarytea.discount</code> &#37197;&#32622;&#65292;&#20687;&#19979;&#38754;&#36825;&#26679;&#29992; curl &#21629;&#20196;&#24378;&#21046;&#21047;&#26032;&#19968;&#19979;&#65292;&#31243;&#24207;&#37324;&#30340;&#25240;&#25187;&#23601;&#25913;&#21464;&#20102;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&#9656; curl -X POST http://localhost:8080/actuator/refresh</code></pre>
<p>&#20687; Spring Cloud Config Client &#36825;&#31181;&#20027;&#21160;&#21435;&#21152;&#36733;&#37197;&#32622;&#30340;&#23458;&#25143;&#31471;&#65292;&#24819;&#35201;&#24863;&#30693;&#37197;&#32622;&#26159;&#21542;&#21457;&#29983;&#20102;&#21464;&#21270;&#21482;&#33021;&#19981;&#26029;&#23581;&#35797;&#21152;&#36733;&#36828;&#31471;&#30340;&#37197;&#32622;&#65292;&#36825;&#31181;&#26041;&#24335;&#27604;&#36739;&#20302;&#25928;&#12290;&#22909;&#22312; Spring Cloud Config Server &#22312;&#36825;&#26041;&#38754;&#20063;&#20570;&#20102;&#19968;&#20123;&#24037;&#20316;&#65292;&#23545;&#20110;&#37027;&#20123;&#25903;&#25345; WebHook &#21457;&#36865;&#21464;&#26356;&#36890;&#30693;&#30340;&#20179;&#24211;&#65292;&#23427;&#21487;&#20197;&#21521;&#23458;&#25143;&#31471;&#25512;&#36865;&#36890;&#30693;&#65292;&#36825;&#37324;&#38656;&#35201;&#29992;&#21040; Spring Cloud Bus&#12290;&#31245;&#21518;&#22312;&#20171;&#32461;&#20854;&#20182;&#37197;&#32622;&#20013;&#24515;&#26102;&#65292;&#25105;&#20204;&#20250;&#30475;&#21040;&#65292;&#30001;&#20110;&#37027;&#20123;&#35774;&#26045;&#26412;&#36523;&#23601;&#26377;&#30417;&#21548;&#21644;&#36890;&#30693;&#30340;&#21151;&#33021;&#65292;&#36825;&#20010;&#21151;&#33021;&#20250;&#26356;&#23481;&#26131;&#23454;&#29616;&#12290;</p>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">7</span>&#36825;&#20010;&#20363;&#23376;&#22312; ch14/binarytea-refresh &#39033;&#30446;&#20013;&#12290;&#36825;&#20010;&#39033;&#30446;&#27809;&#26377;&#36890;&#36807;&#26381;&#21153;&#27880;&#20876;&#20013;&#24515;&#26469;&#26597;&#25214; Spring Cloud Config Server&#65292;&#32780;&#26159;&#20351;&#29992;&#20102;&#30452;&#36830;&#26041;&#24335;&#65292;&#22240;&#20026;&#22312; Spring Cloud 2020.0.2 &#20013; Spring Cloud Config Client &#30340;&#20381;&#36182;&#19982;&#22522;&#20110; Zookeeper &#25110; Consul &#30340;&#26381;&#21153;&#21457;&#29616;&#20381;&#36182;&#24182;&#23384;&#26102;&#65292;&#21047;&#26032;&#19978;&#19979;&#25991;&#20250;&#25243;&#20986;&#24322;&#24120;&#65292;&#25552;&#31034; <code>Binder has not been registered</code>&#12290;&#26681;&#25454; GitHub &#30340;&#35760;&#24405;&#65292;&#36825;&#20010;&#32570;&#38519;&#22312; Spring Cloud 2020.0.4 &#29256;&#26412;&#20013;&#20250;&#24471;&#21040;&#20462;&#22797;&#12290;&#36825;&#37324;&#20026;&#20102;&#28436;&#31034; 2020.0.4 &#20043;&#21069;&#30340;&#24773;&#20917;&#65292;&#20351;&#29992;&#20102;&#30452;&#36830;&#26041;&#24335;&#12290;</p><h3 id="nav_point_224">14.2.2&#12288;&#22522;&#20110; Zookeeper &#30340;&#37197;&#32622;&#20013;&#24515;</h3><p>&#26412;&#31456;&#21069;&#38754;&#30340;&#37096;&#20998;&#19968;&#30452;&#22312;&#20171;&#32461;&#20351;&#29992; Spring Cloud Config Server &#26469;&#23454;&#29616;&#26381;&#21153;&#37197;&#32622;&#30340;&#31649;&#29702;&#65292;&#20854;&#23454;&#38500;&#20102;&#23427;&#65292;Spring Cloud Config &#36824;&#25903;&#25345;&#22909;&#20960;&#31181;&#37197;&#32622;&#20013;&#24515;&#65292;&#20363;&#22914;&#25105;&#20204;&#20043;&#21069;&#29992;&#20316;&#26381;&#21153;&#27880;&#20876;&#20013;&#24515;&#30340; Apache Zookeeper&#12290;&#22312; Zookeeper &#23448;&#32593;&#30340;&#20171;&#32461;&#20013;&#65292;&#31532;&#19968;&#26465;&#23601;&#35828;&#23427;&#26159;&#19968;&#27454;&#29992;&#20110;&#32500;&#25252;&#37197;&#32622;&#20449;&#24687;&#30340;&#38598;&#20013;&#21270;&#26381;&#21153; <span class="&#27880;&#37322;&#32534;&#21495;">8</span>&#65292;&#25152;&#20197;&#25343;&#23427;&#26469;&#20570;&#37197;&#32622;&#20013;&#24515;&#24212;&#35813;&#27809;&#26377;&#22826;&#22823;&#38382;&#39064;&#12290;&#25105;&#20204;&#35201;&#20570;&#30340;&#20165;&#20165;&#26159;&#23558;&#20043;&#21069;&#23384;&#25918;&#22312; Git &#20179;&#24211;&#37324;&#30340;&#37197;&#32622;&#25353;&#29031;&#19968;&#23450;&#30340;&#32467;&#26500;&#20445;&#23384;&#21040; Zookeeper &#20013;&#65292;&#35753;&#24212;&#29992;&#31243;&#24207;&#30452;&#25509;&#36830;&#19978; Zookeeper &#33719;&#21462;&#37197;&#32622;&#21363;&#21487;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">8</span>&#21407;&#25991;&#26159;&#8220;ZooKeeper is a centralized service for maintaining configuration information...&#8221;&#12290;</p><ol>
<li><p><strong>&#23458;&#25143;&#31471;&#21551;&#29992; Zookeeper &#37197;&#32622;&#25903;&#25345;</strong></p>
<p>&#22312;&#24212;&#29992;&#30340; pom.xml &#20013;&#65292;&#22686;&#21152; <code>spring-cloud-starter-zookeeper-config</code> &#20381;&#36182;&#65292;&#20854;&#20013;&#20250;&#20256;&#36882;&#20381;&#36182; Apache Curator &#21644; Apache Zookeeper &#30340;&#24211;&#65292;&#22914;&#26524;&#36825;&#20123;&#24211;&#19982;&#27491;&#22312;&#20351;&#29992;&#30340; Zookeeper &#26377;&#29256;&#26412;&#19981;&#20860;&#23481;&#30340;&#24773;&#20917;&#65292;&#21487;&#20197;&#25163;&#21160;&#25490;&#38500; <code>org.apache.zookeeper:zookeeper</code>&#65292;&#20877;&#24341;&#20837;&#23545;&#24212;&#30340;&#29256;&#26412;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-zookeeper-config&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>&#38543;&#21518;&#65292;&#22312; <code>application.properties</code> &#20013;&#37197;&#32622;&#19982;&#20043;&#21069;&#31867;&#20284;&#30340; <code>spring.config.import</code>&#65292;&#21482;&#19981;&#36807;&#36825;&#27425;&#25105;&#20204;&#35201;&#29992; <code>zookeeper:</code>&#65292;&#32780;&#19981;&#26159; <code>configserver:</code>&#12290;&#26684;&#24335;&#22823;&#27010;&#26159;&#19979;&#38754;&#36825;&#26679;&#30340;&#65292;<code>optional:</code> &#34920;&#31034;&#26159;&#21542;&#26159;&#21487;&#36873;&#37197;&#32622;&#65292;&#23548;&#20837;&#19981;&#25104;&#21151;&#21487;&#20197;&#36339;&#36807;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.config.import=[optional:]zookeeper:[Zookeeper&#36830;&#25509;&#20018;]</code></pre>
<p>&#22914;&#26524;&#21516;&#26102;&#36824;&#29992; Zookeeper &#26469;&#20570;&#26381;&#21153;&#27880;&#20876;&#20013;&#24515;&#65292;&#20004;&#20010; Zookeeper &#27491;&#22909;&#21448;&#26159;&#20844;&#29992;&#30340;&#65292;&#25105;&#20204;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992; <code>spring.cloud.zookeeper.connect-string</code> &#26469;&#37197;&#32622;&#36830;&#25509;&#20018;&#65307;&#22914;&#26524;&#26159;&#19981;&#21516;&#30340;&#65292;&#37027;&#29992;&#20316;&#37197;&#32622;&#20013;&#24515;&#30340; Zookeeper &#36830;&#25509;&#20018;&#21487;&#20197;&#30452;&#25509;&#20889;&#22312; <code>spring.config.import</code> &#37324;&#12290;&#25105;&#20204;&#30340; BinaryTea &#39033;&#30446;&#30340;&#37197;&#32622;&#25991;&#20214;&#21487;&#20197;&#20687;&#20195;&#30721;&#31034;&#20363; 14-9<span class="&#27880;&#37322;&#32534;&#21495;">9</span> &#37027;&#26679;&#31245;&#20316;&#35843;&#25972;&#65292;&#20174; Zookeeper &#20013;&#33719;&#21462;&#37197;&#32622;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-9</strong>&#12288;&#20174; <code>localhost:2181</code> &#23548;&#20837;&#37197;&#32622;&#30340; <code>application.properties</code> &#25991;&#20214;&#29255;&#27573;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.application.name=binarytea

spring.config.import=zookeeper:
spring.cloud.zookeeper.connect-string=localhost:2181
# &#30465;&#30053;&#20854;&#20182;&#37197;&#32622;</code></pre>
<p>&#22914;&#26524;&#24076;&#26395;&#20351;&#29992; Bootstrap &#26041;&#24335;&#65292;&#21644; 14.1.3 &#37324;&#20171;&#32461;&#30340;&#19968;&#26679;&#65292;&#36873;&#29992;&#19977;&#31181;&#21551;&#29992; Bootstrap &#26041;&#24335;&#20013;&#30340;&#19968;&#31181;&#65292;&#38543;&#21518;&#23558; <code>spring.cloud.zookeeper.config.*</code> &#30456;&#20851;&#30340;&#37197;&#32622;&#25918;&#21040; <code>bootstrap.properties</code> &#25991;&#20214;&#37324;&#23601;&#34892;&#20102;&#12290;&#34920; 14-5 &#20013;&#32599;&#21015;&#20102;&#19968;&#20123;&#24120;&#29992;&#30340; Spring Cloud Zookeeper Config &#37197;&#32622;&#39033;&#12290;</p>
<p><strong>&#34920; 14-5&#12288;Spring Cloud Zookeeper Config &#30340;&#24120;&#29992;&#37197;&#32622;&#39033;</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>&#37197;&#32622;&#39033;</th><th>&#40664;&#35748;&#20540;</th><th>&#35828;&#26126;</th></tr><tr><td><code>spring.cloud.zookeeper.config.enabled</code></td><td><code>true</code></td><td>&#26159;&#21542;&#24320;&#21551; Zookeeper &#37197;&#32622;&#25903;&#25345;</td></tr><tr><td><code>spring.cloud.zookeeper.config.root</code></td><td><code>config</code></td><td>Zookeeper &#20013;&#20445;&#23384;&#37197;&#32622;&#30340;&#26681;&#36335;&#24452;</td></tr><tr><td><code>spring.cloud.zookeeper.config.default-context</code></td><td><code>application</code></td><td>&#40664;&#35748;&#37197;&#32622;&#30340;&#24212;&#29992;&#21517;</td></tr><tr><td><code>spring.cloud.zookeeper.config.profile-separator</code></td><td><code>,</code></td><td>Profile &#20998;&#38548;&#31526;</td></tr><tr><td><code>spring.cloud.zookeeper.config.fail-fast</code></td><td><code>true</code></td><td>&#26080;&#27861;&#21152;&#36733;&#26102;&#26159;&#21542;&#24555;&#36895;&#22833;&#36133;</td></tr></table>
<p>&#35831;&#27880;&#24847;&#65292;&#27492;&#26102;&#20808;&#19981;&#35201;&#21551;&#21160;&#39033;&#30446;&#65292;&#22240;&#20026;&#25105;&#20204;&#36824;&#27809;&#26377;&#22312; Zookeeper &#37324;&#25918;&#37197;&#32622;&#39033;&#65292;&#20063;&#27809;&#26377;&#22312; <code>spring.config.import</code> &#37324;&#21152; <code>optional:</code> &#21069;&#32512;&#65292;<code>application.properties</code> &#37324;&#20063;&#27809;&#26377;&#20043;&#21069; Git &#20179;&#24211;&#37324;&#30340;&#37197;&#32622;&#65292;&#24635;&#20043;&#23601;&#26159;&#20250;&#21551;&#21160;&#22833;&#36133;&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#37197;&#32622;&#20449;&#24687;&#22312; Zookeeper &#20013;&#30340;&#23384;&#20648;&#32467;&#26500;</strong></p>
<p>&#22312; Zookeeper &#20013;&#65292;&#25105;&#20204;&#30340;&#37197;&#32622;&#26159;&#25353; <code>/config/</code> &#24212;&#29992;&#21517; <code>[,Profile]/key=value</code> &#30340;&#32467;&#26500;&#26469;&#20445;&#23384;&#30340;&#65292;&#20854;&#20013;&#30340; Profile &#37096;&#20998;&#23646;&#20110;&#21487;&#36873;&#39033;&#65292;&#30475;&#36807;&#34920; 14-5 &#20043;&#21518;&#65292;&#30456;&#20449;&#22823;&#23478;&#24212;&#35813;&#33021;&#30475;&#20986;&#20123;&#31471;&#20522;&#65306;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>config</code> &#26159; <code>spring.cloud.zookeeper.config.root</code> &#30340;&#20540;&#65292;&#25152;&#20197;&#24819;&#25913;&#25104; <code>/configuration/ &#24212;&#29992;&#21517; , Profile/</code> &#20063;&#26159;&#21487;&#20197;&#30340;&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#24212;&#29992;&#21517;&#21644; Profile &#20043;&#38388;&#29992; <code>,</code> &#38548;&#24320;&#65292;&#21487;&#20197;&#29992; <code>spring.cloud.zookeeper.config.profile-separator</code> &#26469;&#20462;&#25913;&#20998;&#38548;&#31526;&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>spring.cloud.zookeeper.config.default-context</code> &#40664;&#35748;&#26159; <code>application</code>&#65292;&#25152;&#20197;&#40664;&#35748;&#37197;&#32622;&#21487;&#20197;&#25918;&#22312; <code>/config/application/</code> &#19979;&#12290;</li>
</ul>
<p>&#25105;&#20204;&#21487;&#20197;&#29992; Zookeeper &#37324;&#33258;&#24102;&#30340; zkCli.sh &#23458;&#25143;&#31471;&#36830;&#19978; Zookeeper<span class="&#27880;&#37322;&#32534;&#21495;">10</span>&#65292;&#36890;&#36807;&#21629;&#20196;&#26041;&#24335;&#20570;&#20123;&#37197;&#32622;&#30340;&#23548;&#20837;&#65292;&#20363;&#22914;&#19979;&#38754;&#36825;&#20123;&#21629;&#20196;&#12290;&#19981;&#20687;&#20043;&#21069;&#29992;&#30340; Spring Cloud Config Server&#65292;&#26242;&#26102;&#25105;&#20204;&#36824;<strong>&#19981;&#33021;</strong>&#22312; Zookeeper &#19978;&#23454;&#29616;&#25935;&#24863;&#37197;&#32622;&#20449;&#24687;&#30340;&#8220;&#33258;&#21160;&#8221;&#21152;&#35299;&#23494;&#65292;&#25152;&#20197;&#21482;&#33021;&#20197;<strong>&#26126;&#25991;</strong>&#23384;&#20648;&#65307;&#22914;&#26524;&#30830;&#23454;&#26377;&#38656;&#35201;&#65292;&#35831;&#22312;&#23458;&#25143;&#31471;&#33258;&#34892;&#23454;&#29616;&#23494;&#25991;&#37197;&#32622;&#39033;&#30340;&#35299;&#23494;&#24037;&#20316;&#21543;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>create /config/binarytea
create /config/binarytea/binarytea.ready true
create /config/binarytea/binarytea.open-hours 9:00-21:00
create /config/binarytea/binarytea.discount 60
create /config/binarytea/spring.security.user.name binarytea
create /config/binarytea/spring.security.user.password showmethemoney
create /config/binarytea/jwt.secret gR6cytlUlgMfVh08nLFZf8hMk4mdJDX5rWBVlsCbKvRlWcLwNRU6+rIPcLx21x191kJg
P8udtoZuHt5yUDWtgg==</code></pre>
<p>&#22914;&#26524;&#23545; Zookeeper &#20013;&#30340;&#26576;&#20010;&#37197;&#32622;&#20540;&#20570;&#20102;&#21464;&#26356;&#65292;&#19981;&#29992;&#20877;&#21435;&#35843;&#29992; <code>/actuator/refresh</code> &#20063;&#33021;&#29983;&#25928;&#65292;&#22240;&#20026;&#25105;&#20204;&#30340;&#31243;&#24207;&#20250;&#30417;&#21548;&#23545;&#24212;&#37197;&#32622;&#30340; Zookeeper &#33410;&#28857;&#65292;&#25152;&#20197;&#24212;&#29992;&#31243;&#24207;&#33021;&#25910;&#21040; Zookeeper &#30340;&#21464;&#26356;&#25512;&#36865;&#65292;&#20855;&#20307;&#30340;&#20195;&#30721;&#22312; Spring Cloud Zookeeper Config &#30340; <code>ConfigWatcher</code> &#31867;&#20013;&#12290;&#29616;&#22312;&#21487;&#20197;&#21551;&#21160;&#21069;&#38754;&#20462;&#25913;&#36807;&#30340; BinaryTea &#31243;&#24207;&#20102;&#65292;&#30475;&#30475;&#23427;&#26159;&#21542;&#22914;&#39044;&#26399;&#30340;&#37027;&#26679;&#33719;&#21462;&#21040;&#37197;&#32622;&#65292;&#24182;&#19988;&#27491;&#24120;&#36816;&#34892;&#20102;&#21602;&#65311;</p>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">9</span>&#36825;&#20010;&#20363;&#23376;&#22312; ch14/binarytea-zookeeper &#39033;&#30446;&#20013;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">10</span>&#22914;&#26524;&#26377;&#20854;&#20182;&#20351;&#29992;&#39034;&#25163;&#30340;&#23458;&#25143;&#31471;&#20063;&#26159;&#21487;&#20197;&#30340;&#65292;&#20363;&#22914; zkui&#12290;</p><h3 id="nav_point_225">14.2.3&#12288;&#22522;&#20110; Consul &#30340;&#37197;&#32622;&#20013;&#24515;</h3><p>&#30475;&#36807;&#20102;&#22522;&#20110; Zookeeper &#30340;&#29992;&#27861;&#65292;&#25105;&#20204;&#20877;&#26469;&#30475;&#30475;&#24590;&#20040;&#29992; Consul &#26469;&#20805;&#24403;&#37197;&#32622;&#20013;&#24515;&#65292;&#35201;&#30693;&#36947; Consul &#20063;&#26159;&#21487;&#20197;&#25552;&#20379; KV &#23384;&#20648;&#26381;&#21153;&#30340;&#12290;&#22312; Spring Cloud Config &#30340;&#32479;&#19968;&#25277;&#35937;&#19979;&#65292;&#24212;&#29992;&#37324;&#20351;&#29992; Consul &#21644; Zookeeper &#20174;&#20195;&#30721;&#23618;&#38754;&#26469;&#30475;&#20960;&#20046;&#27809;&#26377;&#21306;&#21035;&#65292;&#20462;&#25913;&#19979;&#20381;&#36182;&#21644;&#37197;&#32622;&#21363;&#21487;&#12290;</p><ol>
<li><p><strong>&#23458;&#25143;&#31471;&#21551;&#29992; Consul &#37197;&#32622;&#25903;&#25345;</strong></p>
<p>&#19982;&#20043;&#21069;&#19968;&#26679;&#65292;&#20808;&#22312; pom.xml &#20013;&#24341;&#20837; Consul &#37197;&#32622;&#30456;&#20851;&#30340; <code>spring-cloud-starter-consul-config</code> &#20381;&#36182;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-consul-config&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>&#38543;&#21518;&#65292;&#22312; <code>application.properties</code> &#20013;&#37197;&#32622; Consul &#30456;&#20851;&#20449;&#24687;&#65292;&#20197;&#21450; <code>spring.config.import</code>&#65292;&#36825;&#27425;&#30340;&#26684;&#24335;&#26159;&#19979;&#38754;&#36825;&#26679;&#30340;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.config.import=[optional:]consul:[Consul Agent&#22320;&#22336;]</code></pre>
<p>&#22914;&#26524;&#35201;&#29992; Bootstrap &#30340;&#26041;&#24335;&#65292;&#20808;&#29992; 14.1.3 &#37324;&#20171;&#32461;&#30340;&#26041;&#27861;&#21551;&#29992;&#30456;&#20851;&#30340;&#25903;&#25345;&#65292;&#38543;&#21518;&#20687;&#20195;&#30721;&#31034;&#20363; 14-10 &#36825;&#26679;&#37197;&#32622; <code>bootstrap.properties</code>&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">11</span></p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-10</strong>&#12288;&#22686;&#21152;&#20102; Consul &#30456;&#20851;&#37197;&#32622;&#30340; <code>bootstrap.properties</code></p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.application.name=binarytea

spring.cloud.consul.host=localhost
spring.cloud.consul.port=8500
spring.cloud.consul.config.enabled=true</code></pre>
<p>&#20854;&#23454;&#19978;&#38754; 3 &#20010; Consul &#30456;&#20851;&#30340;&#37197;&#32622;&#39033;&#37117;&#26159;&#40664;&#35748;&#20540;&#65292;&#36825;&#37324;&#21482;&#26159;&#20026;&#20102;&#20570;&#28436;&#31034;&#25165;&#20889;&#30340;&#65292;&#34920; 14-6 &#21015;&#20030;&#20102;&#24120;&#29992;&#30340; Consul &#26381;&#21153;&#37197;&#32622;&#26377;&#20851;&#30340;&#37197;&#32622;&#39033;&#12290;</p>
<p><strong>&#34920; 14-6&#12288;Spring Cloud Consul Config &#30456;&#20851;&#37197;&#32622;&#39033;</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>&#37197;&#32622;&#39033;</th><th>&#40664;&#35748;&#20540;</th><th>&#35828;&#26126;</th></tr><tr><td><code>spring.cloud.consul.config.enabled</code></td><td><code>true</code></td><td>&#26159;&#21542;&#24320;&#21551; Consul &#37197;&#32622;&#25903;&#25345;</td></tr><tr><td><code>spring.cloud.consul.config.name</code></td><td><code>${spring.application.name}</code></td><td>Consul &#20013;&#23384;&#20648;&#37197;&#32622;&#30340;&#23545;&#24212;&#21517;&#31216;</td></tr><tr><td><code>spring.cloud.consul.config.prefixes</code></td><td><code>config</code></td><td>Consul &#20013;&#37197;&#32622;&#30340;&#21069;&#32512;&#65292;&#21487;&#20197;&#37197;&#32622;&#19968;&#20010;&#21015;&#34920;</td></tr><tr><td><code>spring.cloud.consul.config.format</code></td><td><code>KEY_VALUE</code></td><td>Consul &#20013;&#37197;&#32622;&#30340;&#23384;&#20648;&#26684;&#24335;&#65292;&#19979;&#25991;&#20250;&#23545;&#20854;&#20013;&#30340;&#38598;&#20013;&#26684;&#24335;&#20570;&#35814;&#32454;&#35828;&#26126;</td></tr><tr><td><code>spring.cloud.consul.config.data-key</code></td><td><code>data</code></td><td>&#22312;&#20351;&#29992; YAML &#21644; PROPERTIES &#26684;&#24335;&#26102;&#65292;&#22312; Consul &#20013;&#20445;&#23384;&#25968;&#25454;&#30340;&#38190;&#21517;</td></tr><tr><td><code>spring.cloud.consul.config.default-context</code></td><td><code>application</code></td><td>&#40664;&#35748;&#37197;&#32622;&#20351;&#29992;&#30340;&#24212;&#29992;&#21517;</td></tr><tr><td><code>spring.cloud.consul.config.profile-separator</code></td><td><code>,</code></td><td>Profile &#20998;&#38548;&#31526;</td></tr><tr><td><code>spring.cloud.consul.config.fail-fast</code></td><td><code>true</code></td><td>&#26080;&#27861;&#21152;&#36733;&#26102;&#26159;&#21542;&#24555;&#36895;&#22833;&#36133;</td></tr><tr><td><code>spring.cloud.consul.config.watch.enabled</code></td><td><code>true</code></td><td>&#26159;&#21542;&#24320;&#21551;&#21464;&#26356;&#30417;&#27979;</td></tr><tr><td><code>spring.cloud.consul.config.watch.delay</code></td><td><code>1000</code></td><td>&#20004;&#27425;&#30417;&#27979;&#20043;&#38388;&#30340;&#38388;&#38548;&#26102;&#38388;&#65292;&#21333;&#20301;&#20026;&#27627;&#31186;</td></tr><tr><td><code>spring.cloud.consul.config.watch.wait-time</code></td><td><code>55</code></td><td>&#23545; Consul &#21457;&#36215;&#38459;&#22622;&#26597;&#35810;&#30340;&#31561;&#24453;&#26102;&#38388;&#65292;&#26377;&#20123;&#26597;&#35810;&#25903;&#25345;&#38271;&#36830;&#25509;&#31561;&#24453;&#65292;&#36825;&#20010;&#26102;&#38388;&#35201;&#23567;&#20110;&#35831;&#27714;&#36229;&#26102;&#26102;&#38388;&#65292;&#21333;&#20301;&#20026;&#31186;</td></tr></table>
<p>&#160;</p>
</li>
<li><p><strong>&#37197;&#32622;&#20449;&#24687;&#22312; Consul &#20013;&#30340;&#23384;&#20648;&#32467;&#26500;</strong></p>
<p>&#19982; Zookeeper &#30456;&#20284;&#65292;Consul &#22312;&#20445;&#23384;&#37197;&#32622;&#39033;&#26102;&#37319;&#29992;&#31867;&#20284;&#30340;&#30446;&#24405;&#32467;&#26500;&#65292;&#24418;&#22914; <code>config/&lt; &#24212;&#29992;&#21517; &gt;[,Profile]/</code>&#12290;&#40664;&#35748;&#37197;&#32622;&#39033;&#37117;&#25918;&#22312; <code>application</code> &#24212;&#29992;&#19979;&#65292;&#31867;&#20284;&#21069;&#32512;&#12289;&#40664;&#35748;&#24212;&#29992;&#12289;Profile &#20998;&#38548;&#31526;&#36825;&#20123;&#20869;&#23481;&#37117;&#21487;&#20197;&#29992;&#34920; 14-6 &#20013;&#30340;&#37197;&#32622;&#39033;&#26469;&#35843;&#25972;&#12290;&#22312; Consul &#20013;&#20445;&#23384;&#37197;&#32622;&#26102;&#26377;&#20197;&#19979; 4 &#31181;&#26684;&#24335;&#21487;&#20379;&#36873;&#25321;&#65292;&#23427;&#20204;&#34987;&#23450;&#20041;&#22312; <code>ConsulConfigProperties.Format</code> &#26522;&#20030;&#20013;&#65292;&#21487;&#20197;&#36890;&#36807; <code>spring.cloud.consul.config.format</code> &#37197;&#32622;&#39033;&#36827;&#34892;&#35843;&#25972;&#12290;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>KEY_VALUE</code>&#65292;&#38190;&#20540;&#23545;&#26684;&#24335;&#65292;&#20197; <code>/config/binarytea/foo/bar/baz</code> &#30340;&#24418;&#24335;&#26469;&#34920;&#31034; <code>binarytea</code> &#24212;&#29992;&#19979;&#30340; <code>foo.bar.baz</code> &#37197;&#32622;&#39033;&#65292;&#20854;&#20013;&#30340;&#20540;&#23601;&#26159;&#37197;&#32622;&#20540;&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>PROPERTIES</code>&#65292;Properties &#26684;&#24335;&#65292;<code>binarytea</code> &#24212;&#29992;&#30340;&#37197;&#32622;&#20250;&#38598;&#20013;&#23384;&#25918;&#22312; <code>/config/binarytea/data</code> &#20013;&#65292;&#20854;&#20013;&#30340; <code>data</code> &#21487;&#20197;&#29992; <code>spring.cloud.consul.config.data-key</code> &#26469;&#20462;&#25913;&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>YAML</code>&#65292;YAML &#26684;&#24335;&#65292;&#23384;&#25918;&#30340;&#20301;&#32622;&#19982; <code>PROPERTIES</code> &#30456;&#21516;&#65292;&#21482;&#26159;&#20869;&#23481;&#26684;&#24335;&#19981;&#21516;&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>FILES</code>&#65292;&#25991;&#20214;&#26684;&#24335;&#65292;&#22312;&#29992; git2consul &#36825;&#31867;&#25226; Git &#25991;&#20214;&#36733;&#20837; Consul &#30340;&#24037;&#20855;&#26102;&#20351;&#29992;&#12290;</li>
</ul>
<p>&#25105;&#20204;&#20808;&#26469;&#28436;&#31034;&#19968;&#19979;&#22914;&#20309;&#29992; <code>KEY_VALUE</code> &#26684;&#24335;&#23384;&#20648;&#37197;&#32622;&#12290;&#22312; Consul Web &#30028;&#38754;&#30340; Key/Value &#20013;&#65292;&#25353;&#34920; 14-7 &#26469;&#21019;&#24314;&#23545;&#24212;&#30340;&#38190;&#24182;&#22635;&#20540;&#12290;&#30001;&#20110; <code>spring.cloud.consul.config.format</code> &#30340;&#40664;&#35748;&#20540;&#23601;&#26159; <code>KEY_VALUE</code>&#65292;&#25152;&#20197;&#21487;&#20197;&#30452;&#25509;&#20381;&#36182;&#40664;&#35748;&#20540;&#25110;&#32773;&#26126;&#30830;&#20889;&#20986;&#26684;&#24335;&#12290;&#36816;&#34892;&#31243;&#24207;&#26597;&#30475;&#26159;&#21542;&#33021;&#27491;&#24120;&#33719;&#21462;&#21040;&#37197;&#32622;&#20540;&#12290;</p>
<p><strong>&#34920; 14-7&#12288;&#29992;&#20110;&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#30340;&#38190;&#20540;&#31867;&#22411;&#30340; Consul &#37197;&#32622;&#39033;</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>&#38190;</th><th>&#23545;&#24212;&#37197;&#32622;</th><th>&#20540;</th></tr><tr><td><code>config/binarytea/binarytea/ready</code></td><td><code>binarytea.ready</code></td><td><code>true</code></td></tr><tr><td><code>config/binarytea/binarytea/open-hours</code></td><td><code>binarytea.open-hours</code></td><td><code>9:00-21:00</code></td></tr><tr><td><code>config/binarytea/binarytea/discount</code></td><td><code>binarytea.discount</code></td><td><code>60</code></td></tr><tr><td><code>config/binarytea/spring/security/user/name</code></td><td><code>spring.security.user.name</code></td><td><code>binarytea</code></td></tr><tr><td><code>config/binarytea/spring/security/user/password</code></td><td><code>spring.security.user.password</code></td><td><code>showmethemoney</code></td></tr><tr><td><code>config/binarytea/jwt/secret</code></td><td><code>jwt.secret</code></td><td>&#19982;&#21069;&#25991; <code>jwt.secret</code> &#30456;&#21516;</td></tr></table>
<p>&#38543;&#21518;&#20877;&#26469;&#30475;&#30475;&#20351;&#29992; <code>YAML</code> &#26684;&#24335;&#21448;&#35813;&#24590;&#20040;&#23384;&#20648;&#65311;&#21516;&#26679;&#26159;&#22312; Key/Value &#30028;&#38754;&#20013;&#65292;&#25105;&#20204;&#30452;&#25509;&#21019;&#24314;&#19968;&#20010; <code>config/binarytea/data</code> &#38190;&#65292;&#20540;&#30340;&#20869;&#23481;&#22914;&#20195;&#30721;&#31034;&#20363; 14-11 &#25152;&#31034;&#65288;&#27880;&#24847;&#32553;&#36827;&#24517;&#39035;&#29992;&#31354;&#26684;&#65292;&#19981;&#33021;&#29992; Tab&#65289;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-11</strong>&#12288;<code>config/binarytea/data</code> &#33410;&#28857;&#20013;&#20889;&#20837;&#30340; YAML &#37197;&#32622;&#20449;&#24687;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>binarytea:
    ready: true
    open-hours: 9:00-21:00
    discount: 60
spring:
    security:
        user:
            name: binarytea
            password: showmethemoney
jwt:
    secret: gR6cytlUlgMfVh08nLFZf8hMk4mdJDX5rWBVlsCbKvRlWcLwNRU6+rIPcLx21x191kJgP8udtoZuHt5yUDWtgg==</code></pre>
<p>&#36825;&#26102;&#38656;&#35201;&#23558; <code>spring.cloud.consul.config.format</code> &#30340;&#20540;&#25913;&#20026; <code>YAML</code>&#65292;&#38543;&#21518;&#37325;&#26032;&#21551;&#21160;&#31243;&#24207;&#35266;&#23519;&#36816;&#34892;&#25928;&#26524;&#12290;&#21516;&#26679;&#22320;&#65292;Consul &#19978;&#37197;&#32622;&#20869;&#23481;&#30340;&#21464;&#26356;&#20063;&#33021;&#22312;&#24212;&#29992;&#31471;&#33258;&#21160;&#21047;&#26032;&#12290;</p>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">11</span>&#36825;&#20010;&#20363;&#23376;&#22312; ch14/binarytea-consul &#39033;&#30446;&#20013;&#12290;</p><h3 id="nav_point_226">14.2.4&#12288;&#22522;&#20110; Alibaba Nacos &#30340;&#37197;&#32622;&#20013;&#24515;</h3><p>Spring Cloud &#23545;&#38463;&#37324;&#24052;&#24052;&#32452;&#20214;&#30340;&#25903;&#25345;&#22522;&#26412;&#37117;&#26159;&#30001;&#38463;&#37324;&#30340;&#24320;&#21457;&#32773;&#32500;&#25252;&#30340;&#65292;&#25152;&#20197; Spring Cloud Alibaba Nacos Config &#20250;&#21644;&#21069;&#38754;&#35848;&#21040;&#30340; Zookeeper &#19982; Consul &#31245;&#26377;&#19981;&#21516;&#12290;</p><ol>
<li><p><strong>&#23458;&#25143;&#31471;&#21551;&#29992; Nacos &#37197;&#32622;&#25903;&#25345;</strong></p>
<p>&#31532;&#19968;&#27493;&#30340;&#25805;&#20316;&#65292;&#22823;&#23478;&#22823;&#21516;&#23567;&#24322;&#65292;&#37117;&#26159;&#22312; pom.xml &#20013;&#24341;&#20837;&#20381;&#36182;&#65292;&#21482;&#19981;&#36807;&#36825;&#27425;&#38656;&#35201;&#22312; <code>&lt;dependencyManagement /&gt;</code> &#37324;&#22810;&#23548;&#20837;&#19968;&#20010; pom&#12290;&#22823;&#27010;&#20250;&#26159;&#19979;&#38754;&#36825;&#26679;&#30340;&#65292;&#20854;&#20013; <code>spring-cloud-dependencies</code> &#26159;&#20043;&#21069;&#19968;&#30452;&#22312;&#29992;&#30340;&#65292;&#32780; <code>spring-cloud-alibaba-dependencies</code> &#21017;&#19987;&#38376;&#29992;&#26469;&#31649;&#29702; Spring Cloud Alibaba &#30340;&#20381;&#36182;&#65292;&#20004;&#32773;&#20316;&#29992;&#19981;&#21516;&#12290;&#20043;&#21069;&#22312;&#20171;&#32461;&#22522;&#20110; Nacos &#30340;&#26381;&#21153;&#27880;&#20876;&#19982;&#21457;&#29616;&#26426;&#21046;&#26102;&#20171;&#32461;&#36807;&#20102;&#65292;&#36825;&#37324;&#20877;&#27425;&#24378;&#35843;&#19968;&#19979;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
            &lt;version&gt;${spring-cloud.version}&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;
            &lt;version&gt;${spring-cloud-alibaba.version}&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
        &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!-- &#30465;&#30053;&#20854;&#20182;&#20381;&#36182; --&gt;
&lt;/dependencies&gt;</code></pre>
<p><code>spring-cloud-starter-alibaba-nacos-config</code> &#26159;&#19987;&#38376;&#29992;&#26469;&#25903;&#25345; Nacos &#26381;&#21153;&#37197;&#32622;&#30340;&#20381;&#36182;&#65292;&#20063;&#26159;&#36825;&#37096;&#20998;&#30340;&#37325;&#28857;&#65292;&#30001;&#20110; 2.2.1.RELEASE &#29256;&#26412;&#30340; Spring Cloud Alibaba &#26242;&#26102;&#36824;&#19981;&#25903;&#25345; <code>spring.config.import</code> &#26041;&#24335;&#65292;&#25152;&#20197;&#21482;&#33021;&#20351;&#29992;&#20256;&#32479;&#30340; Bootstrap &#26041;&#24335;&#65292;&#22240;&#27492;&#21487;&#20197;&#32771;&#34385;&#20687;&#19978;&#38754;&#37027;&#26679;&#22810;&#21152;&#19968;&#20010; <code>spring-cloud-starter-bootstrap</code>&#12290;&#22914;&#26524;&#26159; 2021.0.1.0 &#29256;&#26412;&#65292;&#21017;&#24050;&#32463;&#25903;&#25345; <code>spring.config.import</code> &#26041;&#24335;&#20102;&#65292;&#21487;&#20197;&#26681;&#25454;&#23454;&#38469;&#20351;&#29992;&#30340;&#29256;&#26412;&#26469;&#36873;&#25321;&#37197;&#32622;&#23548;&#20837;&#30340;&#26041;&#24335;&#12290;</p>
<p>&#25509;&#19979;&#26469;&#23601;&#26159;&#37197;&#32622; <code>bootstrap.properties</code>&#65292;&#20854;&#20013;&#38656;&#35201;&#37197;&#32622; Nacos &#26381;&#21153;&#22120;&#30340;&#22320;&#22336;&#65292;&#36824;&#26377;&#19968;&#20123; Nacos Config &#30456;&#20851;&#30340;&#37197;&#32622;&#65292;&#24403;&#28982;&#65292;&#29992;&#40664;&#35748;&#20540;&#36890;&#24120;&#20063;&#34892;&#65292;&#23601;&#20687;&#20195;&#30721;&#31034;&#20363; 14-12<span class="&#27880;&#37322;&#32534;&#21495;">12</span> &#37027;&#26679;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 14-12</strong>&#12288;&#24320;&#21551;&#20102; Nacos Config &#30340; <code>bootstrap.properties</code></p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>spring.application.name=binarytea

spring.cloud.nacos.config.server-addr=http://localhost:8848
spring.cloud.nacos.config.enabled=true
spring.cloud.nacos.config.file-extension=yaml</code></pre>
<p>Spring Cloud Alibaba Nacos Config &#20063;&#26377;&#24456;&#22810;&#21487;&#20197;&#35774;&#32622;&#30340;&#21442;&#25968;&#65292;&#34920; 14-8 &#23601;&#32599;&#21015;&#20102;&#19968;&#20123;&#21487;&#33021;&#29992;&#21040;&#30340;&#37197;&#32622;&#39033;&#12290;</p>
<p><strong>&#34920; 14-8&#12288;Spring Cloud Alibaba Nacos Config &#30340;&#24120;&#29992;&#37197;&#32622;&#39033;</strong></p>
<table border="1" class="table table-bordered table-striped table-condensed" width="90%"><tr><th>&#37197;&#32622;&#39033;</th><th>&#40664;&#35748;&#20540;</th><th>&#35828;&#26126;</th></tr><tr><td><code>spring.cloud.nacos.config.enabled</code></td><td><code>true</code></td><td>&#26159;&#21542;&#24320;&#21551; Nacos &#37197;&#32622;</td></tr><tr><td><code>spring.cloud.nacos.config.server-addr</code></td><td><code>localhost:8848</code></td><td>&#25552;&#20379;&#37197;&#32622;&#26381;&#21153;&#30340; Nacos &#22320;&#22336;</td></tr><tr><td><code>spring.cloud.nacos.config.prefix</code></td><td></td><td>&#29992;&#26469;&#37197;&#32622; <code>dataId</code> &#21069;&#32512;&#65292;&#20808;&#21462; <code>prefix</code>&#65292;&#20877;&#21462; <code>name</code>&#65292;&#27809;&#26377;&#20877;&#29992; <code>${spring.application.name}</code><sup><b>13</b></sup></td></tr><tr><td><code>spring.cloud.nacos.config.name</code></td><td></td><td>&#21516;&#19978;</td></tr><tr><td><code>spring.cloud.nacos.config.group</code></td><td><code>DEFAULT_GROUP</code></td><td>&#37197;&#32622;&#25152;&#29992;&#30340;&#32452;</td></tr><tr><td><code>spring.cloud.nacos.config.cluster-name</code></td><td></td><td>&#38598;&#32676;&#21517;</td></tr><tr><td><code>spring.cloud.nacos.config.namespace</code></td><td></td><td>Nacos &#20013;&#37197;&#32622;&#30340;&#21517;&#23383;&#31354;&#38388;&#65292;&#40664;&#35748;&#26377;&#20010; <code>Public</code> &#21517;&#23383;&#31354;&#38388;</td></tr><tr><td><code>spring.cloud.nacos.config.timeout</code></td><td><code>3000</code></td><td>&#36830;&#25509; Nacos &#30340;&#36229;&#26102;&#26102;&#38388;&#65292;&#21333;&#20301;&#20026;&#31186;</td></tr><tr><td><code>spring.cloud.nacos.config.file-extension</code></td><td><code>properties</code></td><td>&#37197;&#32622;&#20869;&#23481;&#30340;&#21518;&#32512;&#65292;&#20250;&#21644; <code>dataId</code> &#30340;&#21069;&#32512;&#21512;&#24182;&#65292;&#25903;&#25345; <code>properties</code> &#21644; <code>yaml</code></td></tr><tr><td><code>spring.cloud.nacos.config.shared-configs</code></td><td></td><td>&#20849;&#20139;&#37197;&#32622;&#65292;&#26159;&#20010; <code>Config</code> &#31867;&#22411;&#30340;&#21015;&#34920;&#65292;&#38656;&#35201;&#20855;&#20307;&#35774;&#32622;&#37324;&#38754;&#30340;&#20540;</td></tr><tr><td><code>spring.cloud.nacos.config.extension-configs</code></td><td></td><td>&#25193;&#23637;&#37197;&#32622;&#65292;&#26159;&#20010; <code>Config</code> &#31867;&#22411;&#30340;&#21015;&#34920;&#65292;&#38656;&#35201;&#20855;&#20307;&#35774;&#32622;&#37324;&#38754;&#30340;&#20540;</td></tr><tr><td><code>spring.cloud.nacos.config.refresh.enabled</code></td><td><code>true</code></td><td>&#26159;&#21542;&#24320;&#21551;&#37197;&#32622;&#21047;&#26032;</td></tr><tr><td><code>spring.cloud.nacos.config.accessKey</code></td><td></td><td>&#38463;&#37324;&#20113;&#36134;&#21495;&#30340; Access Key&#65292;&#20351;&#29992;&#38463;&#37324;&#20113;&#26102;&#37197;&#32622;</td></tr><tr><td><code>spring.cloud.nacos.config.secretKey</code></td><td></td><td>&#38463;&#37324;&#20113;&#36134;&#21495;&#30340; Secret Key&#65292;&#20351;&#29992;&#38463;&#37324;&#20113;&#26102;&#37197;&#32622;</td></tr></table>
<blockquote>
<p><sup><b>13</b></sup>&#20855;&#20307;&#21487;&#20197;&#21442;&#32771; <code>NacosPropertySourceLocator</code> &#31867;&#12290;</p>
</blockquote>
<p>&#160;</p>
</li>
<li><p><strong>&#37197;&#32622;&#20449;&#24687;&#22312; Nacos &#20013;&#30340;&#23384;&#20648;&#32467;&#26500;</strong></p>
<p>&#22312; Nacos &#20013;&#20445;&#23384;&#37197;&#32622;&#26102;&#65292;&#20063;&#26377;&#19968;&#20123;&#19982; Zookeeper &#21644; Consul &#19981;&#21516;&#30340;&#35268;&#21017;&#65292;&#20363;&#22914;&#37197;&#32622;&#30340;&#21152;&#36733;&#39034;&#24207;&#23601;&#26159;&#19979;&#38754;&#36825;&#26679;&#30340;&#65292;&#21518;&#38754;&#21152;&#36733;&#30340;&#37197;&#32622;&#20248;&#20808;&#32423;&#39640;&#20110;&#21069;&#38754;&#30340;&#12290;</p>
<p>(1) &#20174; <code>spring.cloud.nacos.config.shared-configs</code> &#37197;&#32622;&#30340; <code>Config</code> &#20013;&#21152;&#36733;&#37197;&#32622;&#12290;</p>
<p>(2) &#20174; <code>spring.cloud.nacos.config.extension-configs</code> &#37197;&#32622;&#30340; <code>Config</code> &#20013;&#21152;&#36733;&#37197;&#32622;&#12290;</p>
<p>(3) &#20174;&#24212;&#29992;&#33258;&#24049;&#30340; <code>dataId</code> &#20013;&#21152;&#36733;&#37197;&#32622;&#65292;&#40664;&#35748;&#32452;&#21512;&#35268;&#21017;&#20026; <code>${spring.application.name}[-Profile].</code> &#21518;&#32512;&#12290;</p>
<p>&#20173;&#28982;&#20197; BinaryTea &#39033;&#30446;&#20026;&#20363;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312; Nacos &#25511;&#21046;&#21488;&#20013;&#21019;&#24314;&#19968;&#20010; <code>binarytea</code> &#33410;&#28857;&#65292;&#20855;&#20307;&#22914;&#22270; 14-2 &#25152;&#31034;&#65292;&#20854;&#20013;&#22635;&#20837;&#30340; YAML &#37197;&#32622;&#21644;&#20195;&#30721;&#31034;&#20363; 14-11 &#26159;&#19968;&#26679;&#30340;&#12290;&#26681;&#25454;&#20195;&#30721;&#31034;&#20363; 14-12 &#30340;&#37197;&#32622;&#65292;&#25105;&#20204;&#30340;&#31243;&#24207;&#26368;&#32456;&#20250;&#22312; <code>DEFAULT_GROUP</code> &#20013;&#25214;&#21040; <code>binarytea.yaml</code>&#65292;&#20174;&#36825;&#20010;&#25991;&#20214;&#20013;&#21152;&#36733;&#37197;&#32622;&#12290;&#22312;&#24320;&#21551;&#20102;&#37197;&#32622;&#21047;&#26032;&#21151;&#33021;&#21518;&#65292;Nacos &#19978;&#30340;&#37197;&#32622;&#21464;&#26356;&#20063;&#33021;&#33258;&#21160;&#29983;&#25928;&#12290;</p>
<p class="p-img"><img alt="{%}" src="file:///[PrimaryStorage]local_pic/XueTouSpring_CongRuMenDaoXiangMuShiZhan/image00796.jpeg"/></p>
<p class="p-img-title"><strong>&#22270; 14-2&#12288;Nacos &#37324;&#30340;&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#37197;&#32622;</strong></p>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">12</span>&#36825;&#20010;&#20363;&#23376;&#22312; ch14/binarytea-nacos &#39033;&#30446;&#20013;&#12290;</p><h2 id="nav_point_227">14.3&#12288;&#23567;&#32467;</h2><p>&#26412;&#31456;&#25105;&#20204;&#20102;&#35299;&#20102;&#22312;&#24494;&#26381;&#21153;&#31995;&#32479;&#20013;&#22914;&#20309;&#31649;&#29702;&#26381;&#21153;&#30340;&#37197;&#32622;&#12290;&#20986;&#20110;&#21508;&#26041;&#38754;&#32771;&#34385;&#65292;&#22797;&#26434;&#30340;&#24494;&#26381;&#21153;&#31995;&#32479;&#38656;&#35201;&#33021;&#22815;&#26041;&#20415;&#22320;&#31649;&#29702;&#21508;&#31181;&#37197;&#32622;&#65292;&#36824;&#35201;&#35753;&#37197;&#32622;&#30340;&#21464;&#26356;&#21450;&#26102;&#29983;&#25928;&#12290;Spring Cloud Config &#23601;&#26159;&#19987;&#38376;&#29992;&#26469;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#30340;&#65292;&#25105;&#20204;&#22823;&#33268;&#20171;&#32461;&#20102;&#23427;&#30340;&#23454;&#29616;&#26426;&#21046;&#12290;&#22312;&#23454;&#36341;&#20013;&#65292;&#26080;&#35770;&#26159; Spring Cloud Config Server&#12289;Zookeeper&#12289;Consul&#65292;&#36824;&#26159; Nacos&#65292;&#25233;&#25110;&#26159;&#26412;&#20070;&#20013;&#26410;&#23637;&#24320;&#20171;&#32461;&#30340; Apollo&#65292;&#37117;&#26159;&#19981;&#38169;&#30340;&#36873;&#25321;&#12290;</p><p>&#19979;&#19968;&#31456;&#65292;&#25105;&#20204;&#20250;&#20999;&#25442;&#21040;&#19982;&#39640;&#21487;&#29992;&#21644;&#31283;&#23450;&#24615;&#30456;&#20851;&#30340;&#35805;&#39064;&#19978;&#12290;&#23545;&#20110;&#30001;&#22823;&#37327;&#24494;&#26381;&#21153;&#26500;&#25104;&#30340;&#19994;&#21153;&#65292;&#22914;&#26524;&#24403;&#20013;&#26576;&#20123;&#33410;&#28857;&#20986;&#20102;&#38382;&#39064;&#35813;&#24590;&#20040;&#21150;&#65292;&#27969;&#37327;&#22826;&#22823;&#20102;&#35813;&#24590;&#20040;&#21150;&#65292;&#21448;&#22914;&#20309;&#35753;&#31995;&#32479;&#33258;&#21160;&#24212;&#23545;&#36825;&#31867;&#24773;&#20917;&#21602;&#65311;</p><blockquote>
<p style="text-align: center"><strong>&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#39033;&#30446;&#24320;&#21457;&#23567;&#32467;</strong></p>
<p>&#21040;&#30446;&#21069;&#20026;&#27490;&#65292;&#25105;&#20204;&#30340;&#37325;&#28857;&#36824;&#26159;&#22312;&#20108;&#36827;&#21046;&#22902;&#33590;&#24215;&#28857;&#21333;&#31995;&#32479;&#30340;&#24314;&#35774;&#19978;&#12290;&#21333;&#23454;&#20363;&#26080;&#27861;&#28385;&#36275;&#19994;&#21153;&#37327;&#26102;&#65292;&#21487;&#20197;&#25193;&#23637;&#20026;&#38598;&#32676;&#65292;&#21464;&#25104;&#38598;&#32676;&#21518;&#21448;&#38656;&#35201;&#36127;&#36733;&#22343;&#34913;&#12290;Spring Cloud &#30340;&#26381;&#21153;&#27880;&#20876;&#19982;&#21457;&#29616;&#26426;&#21046;&#21487;&#20197;&#24456;&#22909;&#22320;&#35299;&#20915;&#38598;&#32676;&#23454;&#20363;&#31649;&#29702;&#30340;&#38382;&#39064;&#65292;&#23458;&#25143;&#31471;&#31995;&#32479;&#21487;&#20197;&#24456;&#26041;&#20415;&#22320;&#25214;&#21040;&#19979;&#21333;&#26381;&#21153;&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">14</span></p>
<p>&#31995;&#32479;&#21464;&#22797;&#26434;&#20102;&#20043;&#21518;&#65292;&#21508;&#31181;&#37197;&#32622;&#30340;&#31649;&#29702;&#20063;&#35201;&#36319;&#19978;&#65292;&#20687;&#25913;&#20010;&#33829;&#19994;&#26102;&#38388;&#12289;&#35746;&#21333;&#25240;&#25187;&#65292;&#36825;&#20123;&#21160;&#20316;&#37117;&#35201;&#39640;&#25928;&#24555;&#25463;&#12290;&#29992;&#37197;&#32622;&#25991;&#20214;&#33021;&#35299;&#20915;&#19968;&#37096;&#20998;&#38382;&#39064;&#65292;&#27605;&#31455;&#27604;&#20160;&#20040;&#37117;&#20889;&#27515;&#22312;&#20195;&#30721;&#37324;&#24378;&#65292;&#20294;&#36824;&#36828;&#36828;&#19981;&#22815;&#12290;&#36825;&#26102;&#24341;&#20837; Spring Cloud Config&#65292;&#26082;&#33021;&#20445;&#30041;&#37197;&#32622;&#25991;&#20214;&#30340;&#20307;&#39564;&#65292;&#21448;&#33021;&#23454;&#29616;&#22823;&#35268;&#27169;&#31995;&#32479;&#37197;&#32622;&#38598;&#20013;&#21270;&#31649;&#29702;&#65292;&#36824;&#8220;&#39034;&#24102;&#8221;&#23454;&#29616;&#20102;&#37197;&#32622;&#21464;&#26356;&#24555;&#36895;&#29983;&#25928;&#12290;</p>
<p>&#26080;&#35770;&#26159;&#26381;&#21153;&#30340;&#27880;&#20876;&#19982;&#21457;&#29616;&#65292;&#36824;&#26159;&#26381;&#21153;&#30340;&#37197;&#32622;&#31649;&#29702;&#65292;&#25105;&#20204;&#37117;&#27809;&#26377;&#34987;&#32465;&#27515;&#22312;&#29305;&#23450;&#30340;&#22522;&#30784;&#35774;&#26045;&#19978;&#8212;Zookeeper&#12289;Consul &#21644; Nacos &#37117;&#22312;&#25105;&#20204;&#30340;&#20505;&#36873;&#21015;&#34920;&#37324;&#65292;&#21487;&#20197;&#26681;&#25454;&#24773;&#20917;&#36873;&#25321;&#12290;</p>
</blockquote><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">14</span>&#22914;&#26524;&#30495;&#30340;&#21464;&#25104;&#20102;&#19968;&#20010;&#38598;&#32676;&#65292;&#35760;&#24471;&#19981;&#35201;&#20877;&#29992;&#20869;&#23384;&#25968;&#25454;&#24211; H2 &#20102;&#65292;Session &#31649;&#29702;&#26426;&#21046;&#20063;&#38656;&#35201;&#25442;&#25481;&#12290;</p><br style="page-break-after:always"/><div style="page-break-after:always"></div>
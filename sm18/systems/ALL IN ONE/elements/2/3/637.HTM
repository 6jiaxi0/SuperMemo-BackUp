<h1 id="nav_point_43">&#31532; 3 &#31456;&#12288;Spring Framework &#20013;&#30340; AOP</h1><blockquote>
<p><strong>&#26412;&#31456;&#20869;&#23481;</strong></p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">AOP &#30340;&#27010;&#24565;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">Spring AOP &#30340;&#23454;&#29616;&#21407;&#29702;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#22522;&#20110;&#27880;&#35299;&#30340; AOP &#37197;&#32622;&#26041;&#24335;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#22522;&#20110; XML Schema &#30340; AOP &#37197;&#32622;&#26041;&#24335;</li>
</ul>
</blockquote><p>&#35762;&#23436;&#20102; IoC&#65292;&#25105;&#20204;&#20877;&#26469;&#32842;&#32842; Spring Framework &#20013;&#30340;&#21478;&#19968;&#20010;&#37325;&#35201;&#20869;&#23481;&#8212;&#8212;&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;&#65292;&#21363; AOP&#12290;&#23427;&#26159;&#26694;&#26550;&#20013;&#20247;&#22810;&#21151;&#33021;&#30340;&#22522;&#30784;&#65292;&#20363;&#22914;&#22768;&#26126;&#24335;&#20107;&#21153;&#23601;&#26159;&#20381;&#38752; AOP &#26469;&#23454;&#29616;&#30340;&#12290;&#27492;&#22806;&#65292;Spring &#36824;&#20026;&#25105;&#20204;&#25552;&#20379;&#20102;&#31616;&#21333;&#30340;&#26041;&#24335;&#26469;&#20351;&#29992; AOP&#65292;&#36825;&#26377;&#21161;&#20110;&#31616;&#21270;&#19994;&#21153;&#20195;&#30721;&#20013;&#19968;&#20123;&#20849;&#24615;&#21151;&#33021;&#30340;&#24320;&#21457;&#12290;&#26412;&#31456;&#25105;&#20204;&#20250;&#19968;&#36215;&#21435;&#20102;&#35299; AOP &#30340;&#22522;&#26412;&#27010;&#24565;&#65292;&#20197;&#21450; AOP &#22312; Spring Framework &#20013;&#30340;&#23454;&#29616;&#65292;&#24182;&#23398;&#20064;&#22914;&#20309;&#36890;&#36807;&#20351;&#29992;&#27880;&#35299;&#21644; XML &#25991;&#20214;&#30340;&#26041;&#24335;&#26469;&#37197;&#32622; AOP &#30456;&#20851;&#30340;&#21151;&#33021;&#12290;</p><h2 id="nav_point_44">3.1&#12288;Spring &#20013;&#30340; AOP</h2><p>&#20026;&#20102;&#33021;&#26356;&#22909;&#22320;&#29702;&#35299; AOP&#65292;&#26412;&#33410;&#20250;&#20808;&#24102;&#22823;&#23478;&#20102;&#35299;&#19968;&#19979;&#20160;&#20040;&#26159; AOP&#65292;&#23427;&#33021;&#20570;&#20160;&#20040;&#65292;&#38543;&#21518;&#23637;&#24320;&#35299;&#37322;&#20854;&#20013;&#30340;&#19968;&#20123;&#26680;&#24515;&#27010;&#24565;&#65292;&#26368;&#21518;&#20877;&#21078;&#26512;&#19968;&#19979; Spring Framework &#20013; AOP &#30340;&#23454;&#29616;&#21407;&#29702;&#12290;</p><h3 id="nav_point_45">3.1.1&#12288;AOP &#30340;&#26680;&#24515;&#27010;&#24565;</h3><p>AOP &#26159; Aspect Oriented Programming&#65288;&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;&#65289;&#30340;&#39318;&#23383;&#27597;&#32553;&#20889;&#65292;&#26159;&#19968;&#31181;&#32534;&#31243;&#33539;&#24335;&#65292;&#23427;&#30340;&#30446;&#30340;&#26159;&#36890;&#36807;&#20998;&#31163;&#27178;&#20999;&#20851;&#27880;&#28857;&#65288;cross-cutting concerns&#65289;&#26469;&#25552;&#21319;&#20195;&#30721;&#30340;&#27169;&#22359;&#21270;&#31243;&#24230;&#12290;AOP &#30340;&#27010;&#24565;&#26368;&#26089;&#26159;&#30001; Xerox PARC<span class="&#27880;&#37322;&#32534;&#21495;">1</span> &#25552;&#20986;&#30340;&#65292;&#25105;&#31532;&#19968;&#27425;&#25509;&#35302;&#21040;&#36825;&#20010;&#27010;&#24565;&#21017;&#26159;&#22312; 2004 &#24180;&#24038;&#21491;&#65292;&#24403;&#26102;&#25105;&#36824;&#22312;&#19978;&#22823;&#23398;&#65292;&#24688;&#36898;&#23398;&#38498;&#30340;&#19968;&#20301;&#21338;&#22763;&#29983;&#23548;&#24072;&#26469;&#32473;&#26412;&#31185;&#29983;&#19978;&#35838;&#65292;&#35838;&#31243;&#20013;&#20182;&#21521;&#25105;&#20204;&#20171;&#32461;&#20102; AOP&#65292;&#37027;&#26102;&#20027;&#35201;&#30340; AOP &#26694;&#26550;&#36824;&#26159; AspectJ<span class="&#27880;&#37322;&#32534;&#21495;">2</span>&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">1</span>Xerox PARC&#65288;&#26045;&#20048;&#24085;&#32599;&#22885;&#22810;&#30740;&#31350;&#20013;&#24515;&#65289;&#26159;&#26045;&#20048;&#20844;&#21496;&#25104;&#31435;&#30340;&#26368;&#37325;&#35201;&#30340;&#30740;&#31350;&#26426;&#26500;&#12290;&#22312;&#20010;&#20154;&#30005;&#33041;&#23835;&#36215;&#30340;&#26102;&#20195;&#65292;Xerox PARC &#26159;&#24403;&#20043;&#26080;&#24871;&#30340;&#25216;&#26415;&#20808;&#38155;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">2</span>AspectJ &#26159; Eclipse &#22522;&#37329;&#20250;&#19979;&#30340;&#19968;&#20010;&#39033;&#30446;&#65292;&#26159;&#30693;&#21517;&#30340; AOP &#26694;&#26550;&#65292;&#35814;&#24773;&#21487;&#35265; Eclipse &#23448;&#32593;&#12290;</p><p>AOP &#20013;&#25552;&#21040;&#30340;<strong>&#20851;&#27880;&#28857;</strong>&#65292;&#20854;&#23454;&#23601;&#26159;&#19968;&#27573;<strong>&#29305;&#23450;&#30340;&#21151;&#33021;</strong>&#65292;&#26377;&#20123;&#20851;&#27880;&#28857;&#20986;&#29616;&#22312;&#22810;&#20010;&#27169;&#22359;&#20013;&#65292;&#23601;&#31216;&#20026;<strong>&#27178;&#20999;&#20851;&#27880;&#28857;</strong>&#12290;&#36825;&#20040;&#35828;&#21487;&#33021;&#26377;&#28857;&#25277;&#35937;&#65292;&#20030;&#20010;&#20363;&#23376;&#65292;&#19968;&#20010;&#21518;&#21488;&#23458;&#26381;&#31995;&#32479;&#30340;&#27599;&#20010;&#27169;&#22359;&#37117;&#38656;&#35201;&#35760;&#24405;&#23458;&#26381;&#30340;&#25805;&#20316;&#26085;&#24535;&#65292;&#36825;&#23601;&#26159;&#19968;&#20010;&#33021;&#20174;&#19994;&#21153;&#36923;&#36753;&#20013;&#20998;&#31163;&#20986;&#26469;&#30340;&#27178;&#20999;&#20851;&#27880;&#28857;&#65292;&#23436;&#20840;&#19981;&#29992;&#20132;&#32455;&#22312;&#27599;&#20010;&#27169;&#22359;&#30340;&#20195;&#30721;&#20013;&#65292;&#21487;&#20197;&#20316;&#20026;&#19968;&#20010;&#21333;&#29420;&#30340;&#27169;&#22359;&#23384;&#22312;&#12290;</p><p>&#25972;&#29702;&#19968;&#19979;&#65292;&#21487;&#20197;&#21457;&#29616; AOP &#35299;&#20915;&#20102;&#20004;&#20010;&#38382;&#39064;&#65306;&#31532;&#19968;&#26159;<strong>&#20195;&#30721;&#28151;&#20081;</strong>&#65292;&#26680;&#24515;&#30340;&#19994;&#21153;&#36923;&#36753;&#20195;&#30721;&#36824;&#24517;&#39035;&#20860;&#39038;&#20854;&#20182;&#21151;&#33021;&#65292;&#36825;&#23601;&#23548;&#33268;&#19981;&#21516;&#21151;&#33021;&#30340;&#20195;&#30721;&#20132;&#32455;&#22312;&#19968;&#36215;&#65292;&#21487;&#35835;&#24615;&#24456;&#24046;&#65307;&#31532;&#20108;&#26159;<strong>&#20195;&#30721;&#20998;&#25955;</strong>&#65292;&#21516;&#19968;&#20010;&#21151;&#33021;&#30340;&#20195;&#30721;&#20998;&#25955;&#22312;&#22810;&#20010;&#27169;&#22359;&#20013;&#65292;&#19981;&#26131;&#32500;&#25252;&#12290;&#22312;&#24341;&#20837; AOP &#20043;&#21518;&#65292;&#19968;&#20999;&#23601;&#21464;&#24471;&#19981;&#19968;&#26679;&#20102;&#12290;</p><p>&#34429;&#28982; AOP &#21516; OOP&#65288;Object-Oriented Programming&#65292;&#38754;&#21521;&#23545;&#35937;&#32534;&#31243;&#65289;&#19968;&#26679;&#65292;&#37117;&#26159;&#19968;&#31181;&#32534;&#31243;&#33539;&#24335;&#65292;&#20294;&#23427;&#24182;&#38750;&#31449;&#22312; OOP &#30340;&#23545;&#31435;&#38754;&#65292;&#32780;&#26159;&#23545; OOP &#30340;&#19968;&#20010;&#24456;&#22909;&#30340;&#34917;&#20805;&#12290;Spring Framework &#23601;&#26159;&#19968;&#20010;&#20363;&#23376;&#65292;&#23427;&#24456;&#22909;&#22320;&#23558;&#20004;&#32773;&#34701;&#21512;&#22312;&#20102;&#19968;&#36215;&#12290;</p><p>&#22312; AOP &#20013;&#26377;&#20960;&#20010;&#37325;&#35201;&#30340;&#27010;&#24565;&#65292;&#22312;&#24320;&#22987;&#23454;&#36341;&#21069;&#65292;&#25105;&#20204;&#20808;&#36890;&#36807;&#34920; 3-1 &#26469;&#20102;&#35299;&#19968;&#19979;&#36825;&#20123;&#27010;&#24565;&#12290;</p><p><strong>&#34920; 3-1&#12288;AOP &#20013;&#30340;&#20960;&#20010;&#37325;&#35201;&#27010;&#24565;</strong></p><table border="1" width="90%">
<thead>
<tr>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#27010;&#24565;</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#35828;&#26126;</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#20999;&#38754;&#65288;aspect&#65289;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#25353;&#20851;&#27880;&#28857;&#36827;&#34892;&#27169;&#22359;&#20998;&#35299;&#26102;&#65292;&#27178;&#20999;&#20851;&#27880;&#28857;&#23601;&#34920;&#31034;&#20026;&#19968;&#20010;&#20999;&#38754;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#36830;&#25509;&#28857;&#65288;join point&#65289;<span class="&#27880;&#37322;&#32534;&#21495;">3</span></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#31243;&#24207;&#25191;&#34892;&#30340;&#26576;&#19968;&#21051;&#65292;&#22312;&#36825;&#20010;&#28857;&#19978;&#21487;&#20197;&#28155;&#21152;&#39069;&#22806;&#30340;&#21160;&#20316;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#36890;&#30693;&#65288;advice&#65289;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#20999;&#38754;&#22312;&#29305;&#23450;&#36830;&#25509;&#28857;&#19978;&#25191;&#34892;&#30340;&#21160;&#20316;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#20999;&#20837;&#28857;&#65288;pointcut&#65289;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#20999;&#20837;&#28857;&#26159;&#29992;&#26469;&#25551;&#36848;&#36830;&#25509;&#28857;&#30340;&#65292;&#23427;&#20915;&#23450;&#20102;&#24403;&#21069;&#20195;&#30721;&#19982;&#36830;&#25509;&#28857;&#26159;&#21542;&#21305;&#37197;</p></td>
</tr>
</tbody>
</table><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">3</span>&#20851;&#20110;&#36830;&#25509;&#28857;&#27169;&#22411;&#65288;JPM&#65292;join point model&#65289;&#30340;&#26356;&#22810;&#20869;&#23481;&#65292;&#21487;&#20197;&#35775;&#38382; AOP &#30340; wiki &#39029;&#38754;&#12290;AspectJ &#30340;&#36830;&#25509;&#28857;&#27169;&#22411;&#19982;&#27492;&#36824;&#26377;&#25152;&#21306;&#21035;&#65292;&#20855;&#20307;&#21487;&#20197;&#26597;&#30475; AspectJ &#30340;&#25991;&#26723;&#12290;</p><p>&#20511;&#21161;&#34920; 3-1&#65292;&#25105;&#20204;&#21487;&#20197;&#23558;&#36825;&#20123;&#27010;&#24565;&#20018;&#32852;&#36215;&#26469;&#65306;&#36890;&#36807;&#20999;&#20837;&#28857;&#26469;&#21305;&#37197;&#31243;&#24207;&#20013;&#30340;&#29305;&#23450;&#36830;&#25509;&#28857;&#65292;&#22312;&#36825;&#20123;&#36830;&#25509;&#28857;&#19978;&#25191;&#34892;&#36890;&#30693;&#65292;&#36825;&#31181;&#36890;&#30693;&#21487;&#20197;&#26159;&#22312;&#36830;&#25509;&#28857;&#21069;&#21518;&#25191;&#34892;&#65292;&#20063;&#21487;&#20197;&#26159;&#23558;&#36830;&#25509;&#28857;&#21253;&#22260;&#36215;&#26469;&#12290;</p><h3 id="nav_point_46">3.1.2&#12288;Spring AOP &#30340;&#23454;&#29616;&#21407;&#29702;</h3><p>&#22312; Spring Framework &#20013;&#65292;&#34429;&#28982; Spring AOP &#30340;&#20351;&#29992;&#26041;&#24335;&#21457;&#29983;&#36807;&#24456;&#22823;&#30340;&#21464;&#21270;&#65292;&#20294;&#20854;&#32972;&#21518;&#30340;&#26680;&#24515;&#25216;&#26415;&#21364;&#20174;&#26410;&#25913;&#21464;&#65292;&#37027;&#23601;&#26159;<strong>&#21160;&#24577;&#20195;&#29702;&#25216;&#26415;</strong>&#12290;&#20195;&#29702;&#27169;&#24335;&#26159; GoF &#25552;&#20986;&#30340; 23 &#31181;&#32463;&#20856;&#35774;&#35745;&#27169;&#24335;&#20043;&#19968;&#65292;&#25105;&#20204;&#21487;&#20197;&#20026;&#26576;&#20010;&#23545;&#35937;&#25552;&#20379;&#19968;&#20010;&#20195;&#29702;&#65292;&#25511;&#21046;&#23545;&#35813;&#23545;&#35937;&#30340;&#35775;&#38382;&#65292;&#20195;&#29702;&#21487;&#20197;&#22312;&#20004;&#20010;&#26377;&#35843;&#29992;&#20851;&#31995;&#30340;&#23545;&#35937;&#20043;&#38388;&#36215;&#21040;&#20013;&#20171;&#30340;&#20316;&#29992;&#8212;&#8212;&#20195;&#29702;&#23553;&#35013;&#20102;&#30446;&#26631;&#23545;&#35937;&#65292;&#35843;&#29992;&#32773;&#35843;&#29992;&#20102;&#20195;&#29702;&#30340;&#26041;&#27861;&#65292;&#20195;&#29702;&#20877;&#21435;&#35843;&#29992;&#23454;&#38469;&#30340;&#30446;&#26631;&#23545;&#35937;&#65292;&#22914;&#22270; 3-1 &#25152;&#31034;&#12290;</p><p class="&#22270;"><img alt="{%}" src="file:///[PrimaryStorage]local_pic/XueTouSpring_CongRuMenDaoXiangMuShiZhan/image00758.jpeg"/></p><p class="p-img-title"><strong>&#22270; 3-1&#12288;&#20195;&#29702;&#27169;&#24335;&#31034;&#24847;&#22270;</strong></p><p><strong>&#21160;&#24577;&#20195;&#29702;</strong>&#23601;&#26159;&#22312;&#36816;&#34892;&#26102;&#21160;&#24577;&#22320;&#20026;&#23545;&#35937;&#21019;&#24314;&#20195;&#29702;&#30340;&#25216;&#26415;&#12290;&#22312; Spring &#20013;&#65292;&#30001; AOP &#26694;&#26550;&#21019;&#24314;&#12289;&#29992;&#26469;&#23454;&#29616;&#20999;&#38754;&#30340;&#23545;&#35937;&#34987;&#31216;&#20026; <strong>AOP &#20195;&#29702;</strong>&#65288;AOP Proxy&#65289;&#65292;&#19968;&#33324;&#37319;&#29992; JDK &#21160;&#24577;&#20195;&#29702;&#25110;&#32773;&#26159; CGLIB<span class="&#27880;&#37322;&#32534;&#21495;">4</span> &#20195;&#29702;&#65292;&#20004;&#32773;&#22312;&#20351;&#29992;&#26102;&#30340;&#21306;&#21035;&#20855;&#20307;&#22914;&#34920; 3-2 &#25152;&#31034;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">4</span>CGLIB&#65292;&#36825;&#26159;&#19968;&#20010;&#29983;&#25104;&#19982;&#36716;&#25442; Java &#23383;&#33410;&#30721;&#30340;&#39640;&#38454; API&#65292;&#24191;&#27867;&#24212;&#29992;&#20110;&#21508;&#31181;&#26694;&#26550;&#20013;&#12290;&#22312; Spring Framework &#20013;&#65292;&#20026;&#20102;&#36991;&#20813;&#31867;&#20914;&#31361;&#65292;Spring &#22242;&#38431;&#30452;&#25509;&#22312;&#32534;&#35793;&#26102;&#23558; CGLIB &#25171;&#21253;&#36827;&#20102;&#26694;&#26550;&#37324;&#65292;&#21516;&#26102;&#35843;&#25972;&#20102;&#21253;&#21517;&#12290;</p><p><strong>&#34920; 3-2&#12288;JDK &#21160;&#24577;&#20195;&#29702;&#19982; CGLIB &#20195;&#29702;&#30340;&#21306;&#21035;</strong></p><table border="1" width="90%">
<thead>
<tr>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#160;</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#24517;&#39035;&#35201;&#23454;&#29616;&#25509;&#21475;</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#25903;&#25345;&#25318;&#25130; <code>public</code> &#26041;&#27861;</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#25903;&#25345;&#25318;&#25130; <code>protected</code> &#26041;&#27861;</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#25318;&#25130;&#40664;&#35748;&#20316;&#29992;&#22495;&#26041;&#27861; <span class="&#27880;&#37322;&#32534;&#21495;">5</span></p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">JDK &#21160;&#24577;&#20195;&#29702;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#26159;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#26159;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#21542;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#21542;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">CGLIB &#20195;&#29702;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#21542;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#26159;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#26159;</p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#26159;</p></td>
</tr>
</tbody>
</table><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">5</span>&#22914;&#26524;&#19981;&#21152; <code>public</code>&#12289;<code>protected</code> &#25110; <code>private</code> &#20462;&#39280;&#31526;&#65292;&#22312; Java &#20013;&#21363;&#20026;&#40664;&#35748;&#20316;&#29992;&#22495;&#65292;&#22312;&#21516;&#19968;&#20010;&#21253;&#20869;&#21487;&#35265;&#12290;</p><p>&#34429;&#28982; CGLIB &#25903;&#25345;&#25318;&#25130;&#38750; <code>public</code> &#20316;&#29992;&#22495;&#30340;&#26041;&#27861;&#35843;&#29992;&#65292;&#20294;&#22312;&#19981;&#21516;&#23545;&#35937;&#20043;&#38388;&#20132;&#20114;&#26102;&#65292;&#24314;&#35758;&#36824;&#26159;&#20197; <code>public</code> &#26041;&#27861;&#35843;&#29992;&#20026;&#20027;&#12290;</p><p>Spring &#23481;&#22120;&#22312;&#20026; Bean &#27880;&#20837;&#20381;&#36182;&#26102;&#65292;&#20250;&#33258;&#21160;&#23558;&#34987;&#20381;&#36182; Bean &#30340; AOP &#20195;&#29702;&#27880;&#20837;&#36827;&#26469;&#65292;&#36825;&#23601;&#35753;&#25105;&#20204;&#24863;&#35273;&#26159;&#22312;&#20351;&#29992;&#21407;&#22987;&#30340; Bean&#65292;&#20854;&#23454;&#19981;&#28982;&#12290;</p><p>&#34987;&#20999;&#38754;&#25318;&#25130;&#30340;&#23545;&#35937;&#31216;&#20026;<strong>&#30446;&#26631;&#23545;&#35937;</strong>&#65288;target object&#65289;&#25110;<strong>&#36890;&#30693;&#23545;&#35937;</strong>&#65288;advised object&#65289;&#65292;&#22240;&#20026; Spring &#29992;&#20102;&#21160;&#24577;&#20195;&#29702;&#65292;&#25152;&#20197;&#30446;&#26631;&#23545;&#35937;&#23601;&#26159;&#35201;&#34987;&#20195;&#29702;&#30340;&#23545;&#35937;&#12290;</p><p>&#20197; JDK &#21160;&#24577;&#20195;&#29702;&#20026;&#20363;&#65292;&#20551;&#35774;&#25105;&#20204;&#24076;&#26395;&#22312;&#20195;&#30721;&#31034;&#20363; 3-1<span class="&#27880;&#37322;&#32534;&#21495;">6</span> &#30340;&#26041;&#27861;&#25191;&#34892;&#21069;&#21518;&#22686;&#21152;&#20004;&#21477;&#26085;&#24535;&#65292;&#21487;&#20197;&#37319;&#29992;&#19979;&#38754;&#36825;&#22871;&#20195;&#30721;&#65292;&#20808;&#23454;&#29616;&#35843;&#29992; <code>Hello</code> &#30340;&#20027;&#27969;&#31243;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">6</span>&#36825;&#20010;&#31034;&#20363;&#22312; ch3/helloworld-jdkproxy &#39033;&#30446;&#20013;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-1</strong>&#12288;&#35201;&#34987;&#21160;&#24577;&#20195;&#29702;&#30340; Hello &#25509;&#21475;&#21450;&#20854;&#23454;&#29616;&#29255;&#27573;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public interface Hello {
    void say();
}

public class SpringHello implements Hello {
    @Override
    public void say() {
        System.out.println("Hello Spring!");
    }
}</code></pre><p>&#38543;&#21518;&#65292;&#25105;&#20204;&#21487;&#20197;&#20687;&#20195;&#30721;&#31034;&#20363; 3-2 &#37027;&#26679;&#35774;&#35745;&#19968;&#20010; <code>InvocationHandler</code>&#65292;&#20110;&#26159;&#23545;&#20195;&#29702;&#23545;&#35937;&#30340;&#35843;&#29992;&#37117;&#20250;&#36716;&#20026;&#35843;&#29992; <code>invoke</code> &#26041;&#27861;&#65292;&#20256;&#20837;&#30340;&#21442;&#25968;&#20013;&#23601;&#21253;&#21547;&#20102;&#25152;&#35843;&#29992;&#30340;&#26041;&#27861;&#21644;&#23454;&#38469;&#30340;&#21442;&#25968;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-2</strong>&#12288;&#22312; <code>Hello.say()</code> &#21069;&#21518;&#25171;&#21360;&#26085;&#24535;&#30340; <code>InvocationHandler</code></p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public class LogHandler implements InvocationHandler {
    private Hello source;

    public LogHandler(Hello source) {
        this.source = source;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println("Ready to say something.");
        try {
            return method.invoke(source, args);
        } finally {
            System.out.println("Already say something.");
        }
    }
}</code></pre><p>&#26368;&#21518;&#65292;&#20877;&#36890;&#36807; <code>Proxy.newProxyInstance()</code> &#20026; <code>Hello</code> &#23454;&#29616;&#31867;&#30340; Bean &#23454;&#20363;&#21019;&#24314;&#20351;&#29992; <code>LogHandler</code> &#30340;&#20195;&#29702;&#65292;&#22914;&#20195;&#30721;&#31034;&#20363; 3-3 &#25152;&#31034;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-3</strong>&#12288;&#21019;&#24314; JDK &#21160;&#24577;&#20195;&#29702;&#24182;&#35843;&#29992;&#26041;&#27861;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public class Application {
    public static void main(String[] args) {
        Hello original = new SpringHello();
        Hello target = (Hello) Proxy.newProxyInstance(Hello.class.getClassLoader(),
            original.getClass().getInterfaces(), new LogHandler(original));
        target.say();
    }
}</code></pre><p>&#36825;&#27573;&#20195;&#30721;&#30340;&#36816;&#34892;&#25928;&#26524;&#22914;&#19979;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>Ready to say something.
Hello Spring!
Already say something.</code></pre><p>Spring AOP &#30340;&#23454;&#29616;&#26041;&#24335;&#19982;&#25105;&#20204;&#30340;&#20363;&#23376;&#22823;&#21516;&#23567;&#24322;&#65292;&#30456;&#20449;&#36890;&#36807;&#36825;&#20010;&#20363;&#23376;&#22823;&#23478;&#24050;&#32463;&#33021;&#22815;&#23545;&#20854;&#32972;&#21518;&#30340;&#23454;&#29616;&#21407;&#29702;&#20102;&#35299;&#19968;&#20108;&#20102;&#12290;&#24863;&#20852;&#36259;&#30340;&#26379;&#21451;&#21487;&#20197;&#38405;&#35835;&#19968;&#19979; <code>ProxyFactoryBean</code> &#30340;&#28304;&#30721;&#65292;&#33509;&#26159;&#37319;&#29992; JDK &#21160;&#24577;&#20195;&#29702;&#65292;<code>AopProxyFactory</code> &#20250;&#21019;&#24314; <code>JdkDynamicAopProxy</code>&#65307;&#33509;&#26159;&#37319;&#29992; CGLIB &#20195;&#29702;&#65292;&#21017;&#26159;&#21019;&#24314; <code>ObjenesisCglibAopProxy</code>&#65292;&#21069;&#32773;&#30340;&#36923;&#36753;&#23601;&#21644;&#25105;&#20204;&#30340;&#20363;&#23376;&#24046;&#19981;&#22810;&#12290;</p><blockquote>
<p><strong>&#33590;&#27463;&#26102;&#38388;&#65306;&#20351;&#29992;&#20195;&#29702;&#27169;&#24335;&#36807;&#31243;&#20013;&#30340;&#23567;&#22353;</strong></p>
<p>&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#35843;&#29992;&#30340;&#26159;&#20195;&#29702;&#23545;&#35937; <code>target</code> &#19978;&#30340;&#26041;&#27861;&#65292;&#24182;&#19981;&#30452;&#25509;&#25805;&#20316;&#21407;&#22987;&#23545;&#35937;&#12290;&#22312; Spring AOP &#20013;&#65292;&#20026;&#20102;&#33021;&#29992;&#21040;&#34987; AOP &#22686;&#24378;&#36807;&#30340;&#26041;&#27861;&#65292;&#25105;&#20204;&#24212;&#35813;&#22987;&#32456;&#19982;&#20195;&#29702;&#23545;&#35937;&#20132;&#20114;&#12290;&#22914;&#26524;&#23384;&#22312;&#19968;&#20010;&#31867;&#30340;&#20869;&#37096;&#26041;&#27861;&#35843;&#29992;&#65292;&#36825;&#20010;&#35843;&#29992;&#30340;&#23545;&#35937;&#19981;&#26159;&#20195;&#29702;&#65292;&#32780;&#26159;&#20854;&#26412;&#36523;&#65292;&#21017;&#26080;&#27861;&#20139;&#21463; AOP &#22686;&#24378;&#30340;&#25928;&#26524;&#12290;</p>
<p>&#27604;&#22914;&#65292;&#19979;&#38754;&#36825;&#20010;&#31867;&#20013;&#30340; <code>foo()</code> &#26041;&#27861;&#35843;&#29992;&#20102; <code>bar()</code>&#65292;&#21738;&#24597; Spring AOP &#23545; <code>bar()</code> &#20570;&#20102;&#25318;&#25130;&#65292;&#30001;&#20110;&#35843;&#29992;&#30340;&#19981;&#26159;&#20195;&#29702;&#23545;&#35937;&#65292;&#22240;&#32780;&#30475;&#19981;&#21040;&#20219;&#20309;&#25928;&#26524;&#65292;&#22823;&#23478;&#38656;&#35201;&#29305;&#21035;&#27880;&#24847;&#36825;&#31181;&#24773;&#20917;&#12290;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public class Hello {
    public void foo() {
        bar();
    }

    public void bar() {...}
}</code></pre>
</blockquote><h2 id="nav_point_47">3.2&#12288;&#22522;&#20110; <code>@AspectJ</code> &#30340;&#37197;&#32622;</h2><p>&#22238;&#24819;&#25105;&#31532;&#19968;&#27425;&#25509;&#35302; AOP &#26102;&#65292;AspectJ &#30340;&#20351;&#29992;&#20307;&#39564;&#24182;&#19981;&#29702;&#24819;&#12290;AspectJ &#19981;&#20165;&#38656;&#35201;&#32534;&#20889;&#21333;&#29420;&#30340; Aspect &#20195;&#30721;&#65292;&#36824;&#35201;&#36890;&#36807; <code>ajc</code> &#21629;&#20196;&#20570;&#32534;&#35793;&#12290;&#24403;&#28982;&#65292;&#23613;&#31649;&#29616;&#22312;&#30340; AspectJ &#20063;&#26377;&#20102;&#38271;&#36275;&#36827;&#27493;&#65292;&#20294; Spring AOP &#20013;&#25152;&#26377;&#30340;&#19996;&#35199;&#37117;&#26159; Java &#31867;&#65292;&#23545;&#24320;&#21457;&#32773;&#26469;&#35828;&#29992;&#36215;&#26469;&#26356;&#20026;&#32479;&#19968;&#65292;&#20307;&#39564;&#26356;&#22909;&#12290;Spring Framework &#21516;&#26102;&#25903;&#25345; <code>@AspectJ</code> &#27880;&#35299;&#21644; XML Schema &#20004;&#31181;&#26041;&#24335;&#26469;&#20351;&#29992; AOP&#65292;&#34429;&#28982;&#23448;&#26041;&#24182;&#27809;&#26377;&#26126;&#26174;&#30340;&#20559;&#22909;&#65292;&#20294;&#20010;&#20154;&#35748;&#20026;&#27880;&#35299;&#30340;&#26041;&#24335;&#26356;&#36148;&#36817; Java &#30340;&#39118;&#26684;&#65292;&#25152;&#20197;&#20808;&#26469;&#20171;&#32461;&#19968;&#19979;&#22522;&#20110;&#27880;&#35299;&#30340;&#26041;&#24335;&#12290;</p><p>&#39318;&#20808;&#65292;&#38656;&#35201;&#24341;&#20837; <code>org.springframework:spring-aspects</code> &#20381;&#36182;&#65292;&#20197;&#20415;&#20351;&#29992; AspectJ &#30456;&#20851;&#30340;&#27880;&#35299;&#21644;&#21151;&#33021;&#12290;&#35201;&#24320;&#21551; <code>@AspectJ</code> &#25903;&#25345;&#65292;&#21487;&#20197;&#22312; Java &#37197;&#32622;&#31867;&#19978;&#22686;&#21152; <code>@EnableAspectJAutoProxy</code> &#27880;&#35299;&#65292;&#27604;&#22914;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Configuration
@EnableAspectJAutoProxy
public class Config {...}</code></pre><p><code>@EnableAspectJAutoProxy</code> &#26377;&#20004;&#20010;&#23646;&#24615;&#65292;<code>proxyTargetClass</code> &#29992;&#20110;&#36873;&#25321;&#26159;&#21542;&#24320;&#21551;&#22522;&#20110;&#31867;&#30340;&#20195;&#29702;&#65288;&#26159;&#21542;&#20351;&#29992; CGLIB &#26469;&#20570;&#20195;&#29702;&#65289;&#65307;<code>exposeProxy</code> &#29992;&#20110;&#36873;&#25321;&#26159;&#21542;&#23558;&#20195;&#29702;&#23545;&#35937;&#26292;&#38706;&#21040; <code>AopContext</code> &#20013;&#65292;&#20004;&#32773;&#40664;&#35748;&#20540;&#37117;&#26159; <code>false</code>&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">7</span></p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">7</span>&#22312; Spring Boot &#20013;&#65292;&#20250;&#33258;&#21160;&#37197;&#32622;&#20351;&#29992;&#22522;&#20110;&#31867;&#30340;&#20195;&#29702;&#12290;</p><p>&#25105;&#20204;&#20063;&#21487;&#20197;&#36890;&#36807; XML Schema &#30340;&#26041;&#24335;&#26469;&#23454;&#29616;&#30456;&#21516;&#30340;&#25928;&#26524;&#65292;&#22914;&#20195;&#30721;&#31034;&#20363; 3-4 &#25152;&#31034;&#65292;&#27880;&#24847;&#35201;&#27491;&#30830;&#22320;&#24341;&#20837; <code>aop</code> &#21629;&#21517;&#31354;&#38388;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-4</strong>&#12288;&#36890;&#36807; <code>&lt;aop:aspectj-autoproxy/&gt;</code> &#24320;&#21551; <code>@AspectJ</code> &#25903;&#25345;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd"&gt;

    &lt;aop:aspectj-autoproxy/&gt;

&lt;/beans&gt;</code></pre><p>&#25509;&#19979;&#26469;&#65292;&#22312;&#23436;&#25104;&#37197;&#32622;&#21518;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#20351;&#29992; <code>@Aspect</code> &#27880;&#35299;&#26469;&#22768;&#26126;&#20999;&#38754;&#20102;&#65292;&#23558;&#36825;&#20010;&#27880;&#35299;&#21152;&#21040;&#31867;&#19978;&#21363;&#21487;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Aspect
public class MyAspect {...}</code></pre><blockquote>
<p><strong>&#27880;&#24847;</strong>&#12288;&#26377;&#20004;&#28857;&#20869;&#23481;&#38656;&#35201;&#37325;&#28857;&#35828;&#26126;&#12290;</p>
<p>(1) &#28155;&#21152; <code>@Aspect</code> &#27880;&#35299;&#21482;&#26159;&#21578;&#35785; Spring&#8220;&#36825;&#20010;&#31867;&#26159;&#20999;&#38754;&#8221;&#65292;&#20294;&#24182;&#27809;&#26377;&#25226;&#23427;&#22768;&#26126;&#20026; Bean&#65292;&#22240;&#27492;&#38656;&#35201;&#25105;&#20204;&#25163;&#21160;&#36827;&#34892;&#37197;&#32622;&#65292;&#20363;&#22914;&#28155;&#21152; <code>@Component</code> &#27880;&#35299;&#65292;&#25110;&#32773;&#22312; Java &#37197;&#32622;&#31867;&#20013;&#36827;&#34892;&#22768;&#26126;&#12290;</p>
<p>(2) Spring Framework &#20250;&#23545;&#24102;&#26377; <code>@Aspect</code> &#27880;&#35299;&#30340;&#31867;&#20570;&#29305;&#27530;&#23545;&#24453;&#65292;&#22240;&#20026;&#20854;&#26412;&#36523;&#23601;&#26159;&#19968;&#20010;&#20999;&#38754;&#65292;&#25152;&#20197;&#19981;&#20250;&#34987;&#21035;&#30340;&#20999;&#38754;&#33258;&#21160;&#25318;&#25130;&#12290;</p>
</blockquote><p>&#22312;&#22768;&#26126;&#20102;&#20999;&#38754;&#21518;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#37197;&#32622;&#20855;&#20307;&#30340;&#20999;&#20837;&#28857;&#21644;&#36890;&#30693;&#20102;&#65292;&#26412;&#31456;&#30340;&#21518;&#38754;&#20250;&#23545;&#36825;&#20123;&#20570;&#20855;&#20307;&#30340;&#23637;&#24320;&#12290;</p><h3 id="nav_point_48">3.2.1&#12288;&#22768;&#26126;&#20999;&#20837;&#28857;</h3><p>&#27880;&#35299;&#26041;&#24335;&#30340;&#20999;&#20837;&#28857;&#22768;&#26126;&#30001;&#20004;&#37096;&#20998;&#32452;&#25104;&#8212;&#8212;<strong>&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;</strong>&#21644;<strong>&#20999;&#20837;&#28857;&#26041;&#27861;&#31614;&#21517;</strong>&#12290;&#21069;&#32773;&#29992;&#26469;&#25551;&#36848;&#35201;&#21305;&#37197;&#30340;&#36830;&#25509;&#28857;&#65292;&#21518;&#32773;&#21487;&#20197;&#29992;&#26469;&#24341;&#29992;&#20999;&#20837;&#28857;&#65292;&#26041;&#20415;&#20999;&#20837;&#28857;&#30340;&#22797;&#29992;&#65292;&#20855;&#20307;&#22914;&#20195;&#30721;&#31034;&#20363; 3-5 &#25152;&#31034;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-5</strong>&#12288;&#19968;&#20123;&#31616;&#21333;&#30340;&#20999;&#20837;&#28857;&#22768;&#26126;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>package learning.spring.helloworld;

public class HelloPointcut {
    @Pointcut("target(learning.spring.helloworld.Hello)")
    public void helloType() {} // &#30446;&#26631;&#23545;&#35937;&#26159;learning.spring.helloworld.Hello&#31867;&#22411;

    @Pointcut("execution(public * say())")
    public void sayOperation() {} // &#25191;&#34892;public&#30340;say()&#26041;&#27861;

    @Pointcut("helloType() &amp;&amp; sayOperation()") // &#22797;&#29992;&#20854;&#20182;&#20999;&#20837;&#28857;
    public void sayHello() {} // &#25191;&#34892;Hello&#31867;&#22411;&#20013;public&#30340;say()&#26041;&#27861;
}</code></pre><p><code>@Pointcut</code> &#27880;&#35299;&#20013;&#20351;&#29992;&#30340;&#23601;&#26159; AspectJ 5 &#30340;&#34920;&#36798;&#24335;&#65292;&#20854;&#20013;&#19968;&#20123;&#24120;&#29992;&#30340; PCD&#65288;pointcut designator&#65292;&#20999;&#20837;&#28857;&#26631;&#35782;&#31526;&#65289;&#22914;&#34920; 3-3 &#25152;&#31034;&#12290;</p><p><strong>&#34920; 3-3&#12288;<code>@Pointcut</code> &#20013;&#30340;&#19968;&#20123;&#24120;&#29992; PCD</strong></p><table border="1" width="90%">
<thead>
<tr>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">PCD</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#35828;&#26126;</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>execution</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#26368;&#24120;&#29992;&#30340;&#19968;&#20010; PCD&#65292;&#29992;&#26469;&#21305;&#37197;&#29305;&#23450;&#26041;&#27861;&#30340;&#25191;&#34892;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>within</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#21305;&#37197;&#29305;&#23450;&#33539;&#22260;&#20869;&#30340;&#31867;&#22411;&#65292;&#21487;&#20197;&#29992;&#36890;&#37197;&#31526;&#26469;&#21305;&#37197;&#26576;&#20010; Java &#21253;&#20869;&#30340;&#25152;&#26377;&#31867;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>this</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">Spring AOP &#20195;&#29702;&#23545;&#35937;&#36825;&#20010; Bean &#26412;&#36523;&#35201;&#21305;&#37197;&#26576;&#20010;&#32473;&#23450;&#30340;&#31867;&#22411;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>target</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#30446;&#26631;&#23545;&#35937;&#35201;&#21305;&#37197;&#26576;&#20010;&#32473;&#23450;&#30340;&#31867;&#22411;&#65292;&#27604; <code>this</code> &#26356;&#24120;&#29992;&#19968;&#20123;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>args</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#20256;&#20837;&#30340;&#26041;&#27861;&#21442;&#25968;&#35201;&#21305;&#37197;&#26576;&#20010;&#32473;&#23450;&#30340;&#31867;&#22411;&#65292;&#23427;&#20063;&#21487;&#20197;&#29992;&#20110;&#32465;&#23450;&#35831;&#27714;&#21442;&#25968;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>bean</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">Spring AOP &#29305;&#26377;&#30340;&#19968;&#20010; PCD&#65292;&#21305;&#37197; Bean &#30340; ID &#25110;&#21517;&#31216;&#65292;&#21487;&#20197;&#29992;&#36890;&#37197;&#31526;</p></td>
</tr>
</tbody>
</table><p>&#22240;&#20026; <code>execution</code> &#29992;&#24471;&#38750;&#24120;&#22810;&#65292;&#19979;&#38754;&#35814;&#32454;&#25551;&#36848;&#19968;&#19979;&#23427;&#30340;&#34920;&#36798;&#24335;&#65292;<code>[]</code> &#20195;&#34920;&#21487;&#36873;&#39033;&#65292;<code>&lt;&gt;</code> &#20195;&#34920;&#24517;&#36873;&#39033;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>execution([&#20462;&#39280;&#31526;] &lt;&#36820;&#22238;&#31867;&#22411;&gt; [&#20840;&#38480;&#23450;&#31867;&#21517;.]&lt;&#26041;&#27861;&gt;(&lt;&#21442;&#25968;&gt;) [&#24322;&#24120;])</code></pre><p>&#20854;&#20013;&#65292;</p><ul>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;">&#27599;&#20010;&#37096;&#20998;&#37117;&#21487;&#20197;&#20351;&#29992; <code>*</code> &#36890;&#37197;&#31526;</li>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;">&#31867;&#21517;&#20013;&#20351;&#29992; <code>.*</code> &#34920;&#31034;&#21253;&#20013;&#30340;&#25152;&#26377;&#31867;&#65292;<code>..*</code> &#34920;&#31034;&#24403;&#21069;&#21253;&#19982;&#23376;&#21253;&#20013;&#30340;&#25152;&#26377;&#31867;</li>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;">&#21442;&#25968;&#20027;&#35201;&#20998;&#20026;&#20197;&#19979;&#20960;&#31181;&#24773;&#20917;&#65306;<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>()</code> &#34920;&#31034;&#26041;&#27861;&#26080;&#21442;&#25968;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>(..)</code> &#34920;&#31034;&#26377;&#20219;&#24847;&#20010;&#21442;&#25968;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>(*)</code> &#34920;&#31034;&#26377;&#19968;&#20010;&#20219;&#24847;&#31867;&#22411;&#30340;&#21442;&#25968;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>(String)</code> &#34920;&#31034;&#26377;&#19968;&#20010; <code>String</code> &#31867;&#22411;&#30340;&#21442;&#25968;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>(String,String)</code> &#20195;&#34920;&#26377;&#20004;&#20010; <code>String</code> &#31867;&#22411;&#30340;&#21442;&#25968;</li>
</ul>
</li>
</ul><p>&#22312; Java &#20013;&#65292;&#20026;&#20102;&#26041;&#20415;&#26631;&#35782;&#65292;&#25105;&#20204;&#20063;&#32463;&#24120;&#20351;&#29992;&#27880;&#35299;&#65292;&#22914;&#26524;&#31867;&#19978;&#24102;&#20102;&#29305;&#23450;&#30340;&#27880;&#35299;&#65292;&#20063;&#21487;&#20197;&#29992;&#34920; 3-4 &#20013;&#30340;&#36825;&#20123; PCD&#12290;</p><p><strong>&#34920; 3-4&#12288;&#38024;&#23545;&#27880;&#35299;&#30340;&#24120;&#29992; PCD</strong></p><table border="1" width="90%">
<thead>
<tr>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">PCD</p></th>
<th><p class="&#34920;&#22836;&#21333;&#20803;&#26684;">&#35828;&#26126;</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>@target</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#25191;&#34892;&#30340;&#30446;&#26631;&#23545;&#35937;&#24102;&#26377;&#29305;&#23450;&#31867;&#22411;&#27880;&#35299;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>@args</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#20256;&#20837;&#30340;&#26041;&#27861;&#21442;&#25968;&#24102;&#26377;&#29305;&#23450;&#31867;&#22411;&#27880;&#35299;</p></td>
</tr>
<tr>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;"><code>@annotation</code></p></td>
<td><p class="&#34920;&#26684;&#21333;&#20803;&#26684;">&#25318;&#25130;&#30340;&#26041;&#27861;&#19978;&#24102;&#26377;&#29305;&#23450;&#31867;&#22411;&#27880;&#35299;</p></td>
</tr>
</tbody>
</table><p>&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#25903;&#25345;&#19982;&#12289;&#25110;&#12289;&#38750;&#36816;&#31639;&#65292;&#36816;&#31639;&#31526;&#20998;&#21035;&#20026; &amp;&amp;&#12289;||&#21644; !&#65292;&#36824;&#21487;&#20197;&#36827;&#34892;&#28789;&#27963;&#32452;&#21512;&#12290;</p><p>&#26368;&#21518;&#65292;&#25105;&#20204;&#20877;&#25552;&#20379;&#19968;&#20123;&#31034;&#20363;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>// learning.spring.helloworld&#21450;&#20854;&#23376;&#21253;&#20013;&#25152;&#26377;&#31867;&#37324;&#30340;say&#26041;&#27861;
// &#35813;&#26041;&#27861;&#21487;&#20197;&#36820;&#22238;&#20219;&#24847;&#31867;&#22411;&#65292;&#31532;&#19968;&#20010;&#21442;&#25968;&#24517;&#39035;&#26159;String&#65292;&#21518;&#38754;&#21487;&#20197;&#36319;&#20219;&#24847;&#21442;&#25968;
execution(* learning.spring.helloworld..*.say(String,..))

// learning.spring.helloworld&#21450;&#20854;&#23376;&#21253;
within(learning.spring.helloworld..*)

// &#26041;&#27861;&#30340;&#21442;&#25968;&#20165;&#26377;&#19968;&#20010;String
args(java.lang.String)

// &#30446;&#26631;&#31867;&#22411;&#20026;Hello&#21450;&#20854;&#23376;&#31867;
target(learning.spring.helloworld.Hello+)

// &#31867;&#19978;&#24102;&#26377;@AopNeeded&#27880;&#35299;
@target(learning.spring.helloworld.AopNeeded)</code></pre><blockquote>
<p><strong>&#33590;&#27463;&#26102;&#38388;&#65306;Spring AOP &#19982; AspectJ &#20013; PCD &#30340;&#19981;&#21516;&#20043;&#22788;</strong></p>
<p>Spring AOP &#20013;&#34429;&#28982;&#20351;&#29992;&#20102; AspectJ 5 &#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#20063;&#20849;&#29992;&#20102;&#19981;&#23569; AspectJ &#30340; PCD&#65292;&#20294;&#20854;&#23454;&#20004;&#32773;&#36824;&#26159;&#26377;&#21306;&#21035;&#30340;&#12290;&#27604;&#22914;&#65292;Spring AOP &#20013;&#20165;&#25903;&#25345;&#26377;&#38480;&#30340; PCD&#65292;AspectJ &#20013;&#36824;&#26377;&#24456;&#22810; PCD &#26159; Spring AOP &#19981;&#25903;&#25345;&#30340;&#12290;</p>
<p>&#30001;&#20110; Spring AOP &#30340;&#23454;&#29616;&#22522;&#20110;&#21160;&#24577;&#20195;&#29702;&#65292;&#22240;&#32780;&#21482;&#33021;&#21305;&#37197;&#26222;&#36890;&#26041;&#27861;&#30340;&#25191;&#34892;&#65292;&#20687;&#38745;&#24577;&#21021;&#22987;&#21270;&#12289;&#38745;&#24577;&#26041;&#27861;&#12289;&#26500;&#36896;&#26041;&#27861;&#12289;&#23646;&#24615;&#36171;&#20540;&#31561;&#25805;&#20316;&#37117;&#26159;&#25318;&#25130;&#19981;&#21040;&#30340;&#12290;&#25152;&#20197;&#35828;&#30456;&#27604; AspectJ &#32780;&#35328;&#65292;Spring AOP &#30340;&#21151;&#33021;&#24369;&#24456;&#22810;&#65292;&#20294;&#22312;&#22823;&#37096;&#20998;&#22330;&#26223;&#19979;&#20063;&#22522;&#26412;&#22815;&#29992;&#12290;</p>
<p>&#20986;&#20110;&#19978;&#36848;&#24046;&#24322;&#65292;&#22312;&#34920; 3-4 &#20013;&#25105;&#20204;&#24182;&#27809;&#26377;&#21015;&#20986; <code>@within</code> &#36825;&#20010; PCD&#65292;&#22240;&#20026;&#22312; Spring AOP &#20013;&#65292;<code>@target</code> &#19982; <code>@within</code> &#20004;&#32773;&#22312;&#20351;&#29992;&#19978;&#24863;&#21463;&#19981;&#21040;&#20160;&#20040;&#21306;&#21035;&#12290;&#21069;&#32773;&#35201;&#27714;&#36816;&#34892;&#26102;&#30340;&#30446;&#26631;&#23545;&#35937;&#24102;&#26377;&#27880;&#35299;&#65292;&#36825;&#20010;&#27880;&#35299;&#30340; <code>@Retention</code> &#26159; <code>RetentionPolicy.RUNTIME</code>&#65292;&#21363;&#36816;&#34892;&#26102;&#30340;&#65307;&#21518;&#32773;&#35201;&#27714;&#34987;&#25318;&#25130;&#30340;&#31867;&#19978;&#24102;&#26377; <code>@Retention</code> &#26159; <code>RetentionPolicy.CLASS</code> &#30340;&#27880;&#35299;&#12290;&#20294; Spring AOP &#21482;&#33021;&#25318;&#25130;&#21040;&#38750;&#38745;&#24577; <code>public</code> &#26041;&#27861;&#30340;&#25191;&#34892;&#65292;&#20004;&#20010; PCD &#30340;&#25928;&#26524;&#19968;&#26679;&#65292;&#25152;&#20197;&#36824;&#26159;&#32769;&#32769;&#23454;&#23454;&#29992; <code>@target</code> &#21543;&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">8</span></p>
</blockquote><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">8</span>&#20851;&#20110; Spring AOP &#20013; <code>@target</code> &#19982; <code>@within</code> &#30340;&#24046;&#24322;&#65292;StackOverflow &#19978;&#26377;&#19968;&#31687;&#21517;&#20026;&#8220;Difference between @target and @within (Spring AOP)&#8221;&#30340;&#25991;&#31456;&#35828;&#24471;&#27604;&#36739;&#28165;&#26970;&#65292;&#24863;&#20852;&#36259;&#30340;&#21516;&#23398;&#21487;&#20197;&#21442;&#32771;&#12290;</p><h3 id="nav_point_49">3.2.2&#12288;&#22768;&#26126;&#36890;&#30693;</h3><p>Spring AOP &#20013;&#26377;&#22810;&#31181;&#36890;&#30693;&#31867;&#22411;&#65292;&#21487;&#20197;&#24110;&#21161;&#25105;&#20204;&#22312;&#26041;&#27861;&#30340;&#21508;&#20010;&#25191;&#34892;&#38454;&#27573;&#36827;&#34892;&#25318;&#25130;&#65292;&#20363;&#22914;&#65292;&#21487;&#20197;&#22312;&#26041;&#27861;&#25191;&#34892;&#21069;&#12289;&#36820;&#22238;&#21518;&#12289;&#25243;&#20986;&#24322;&#24120;&#21518;&#28155;&#21152;&#29305;&#23450;&#30340;&#25805;&#20316;&#65292;&#20063;&#21487;&#20197;&#23436;&#20840;&#26367;&#20195;&#26041;&#27861;&#30340;&#23454;&#29616;&#65292;&#29978;&#33267;&#20026;&#19968;&#20010;&#31867;&#28155;&#21152;&#21407;&#20808;&#27809;&#26377;&#30340;&#25509;&#21475;&#23454;&#29616;&#12290;</p><ol>
<li><p><strong>&#21069;&#32622;&#36890;&#30693;</strong></p>
<p><code>@Before</code> &#27880;&#35299;&#21487;&#20197;&#29992;&#26469;&#22768;&#26126;&#19968;&#20010;&#21069;&#32622;&#36890;&#30693;&#65292;&#27880;&#35299;&#20013;&#21487;&#20197;&#24341;&#29992;&#20107;&#20808;&#23450;&#20041;&#22909;&#30340;&#20999;&#20837;&#28857;&#65292;&#20063;&#21487;&#20197;&#30452;&#25509;&#20256;&#20837;&#19968;&#20010;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#22312;&#34987;&#25318;&#25130;&#21040;&#30340;&#26041;&#27861;&#24320;&#22987;&#25191;&#34892;&#21069;&#65292;&#20250;&#20808;&#25191;&#34892;&#36890;&#30693;&#20013;&#30340;&#20195;&#30721;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Aspect
public class BeforeAspect {
    @Before("learning.spring.helloworld.HelloPointcut.sayHello()")
    public void before() {
        System.out.println("Before Advice");
    }
    // &#21516;&#19968;&#20010;&#20999;&#38754;&#31867;&#37324;&#36824;&#21487;&#20197;&#26377;&#20854;&#20182;&#36890;&#30693;&#26041;&#27861;
    // &#36825;&#23601;&#26159;&#19968;&#20010;&#26222;&#36890;&#30340;Java&#31867;&#65292;&#27809;&#26377;&#22826;&#22810;&#38480;&#21046;
}</code></pre>
<p>&#21069;&#32622;&#36890;&#30693;&#30340;&#26041;&#27861;&#27809;&#26377;&#36820;&#22238;&#20540;&#65292;&#22240;&#20026;&#23427;&#22312;&#34987;&#25318;&#25130;&#30340;&#26041;&#27861;&#21069;&#25191;&#34892;&#65292;&#23601;&#31639;&#26377;&#36820;&#22238;&#20540;&#20063;&#27809;&#22320;&#26041;&#20351;&#29992;&#65292;&#20294;&#26159;&#23427;&#21487;&#20197;&#23545;&#34987;&#25318;&#25130;&#26041;&#27861;&#30340;&#21442;&#25968;&#36827;&#34892;&#21152;&#24037;&#65292;&#36890;&#36807; <code>args</code> &#36825;&#20010; PCD &#33021;&#26126;&#30830;&#21442;&#25968;&#65292;&#24182;&#23558;&#20854;&#32465;&#23450;&#21040;&#21069;&#32622;&#36890;&#30693;&#26041;&#27861;&#30340;&#21442;&#25968;&#19978;&#12290;&#20363;&#22914;&#65292;&#35201;&#22312; <code>sayHello(AtomicInteger)</code> &#36825;&#20010;&#26041;&#27861;&#21069;&#23545; <code>AtomicInteger</code> &#31867;&#22411;&#30340;&#21442;&#25968;&#36827;&#34892;&#25968;&#20540;&#35843;&#25972;&#65292;&#23601;&#21487;&#20197;&#36825;&#26679;&#20570;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Before("learning.spring.helloworld.HelloPointcut.sayHello() &amp;&amp; args(count)")
public void before(AtomicInteger count) {
    // &#25805;&#20316;count
}</code></pre>
<p>&#35201;&#26159;&#21516;&#26102;&#23384;&#22312;&#22810;&#20010;&#36890;&#30693;&#20316;&#29992;&#20110;&#21516;&#19968;&#22788;&#65292;&#21487;&#20197;&#35753;&#20999;&#38754;&#31867;&#23454;&#29616; <code>Ordered</code> &#25509;&#21475;&#65292;&#25110;&#32773;&#22312;&#19978;&#38754;&#28155;&#21152; <code>@Order</code> &#27880;&#35299;&#12290;&#25351;&#23450;&#30340;&#20540;&#36234;&#20302;&#65292;&#20248;&#20808;&#32423;&#21017;&#36234;&#39640;&#65292;&#22312;&#26368;&#32456;&#30340;&#20195;&#29702;&#23545;&#35937;&#25191;&#34892;&#26102;&#20063;&#20250;&#20808;&#25191;&#34892;&#20248;&#20808;&#32423;&#39640;&#30340;&#36923;&#36753;&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#21518;&#32622;&#36890;&#30693;</strong></p>
<p>&#22312;&#26041;&#27861;&#25191;&#34892;&#21518;&#65292;&#21487;&#33021;&#27491;&#24120;&#36820;&#22238;&#65292;&#20063;&#21487;&#33021;&#25243;&#20986;&#20102;&#24322;&#24120;&#12290;&#22914;&#26524;&#24819;&#35201;&#25318;&#25130;&#27491;&#24120;&#36820;&#22238;&#30340;&#35843;&#29992;&#65292;&#21487;&#20197;&#20351;&#29992;</p>
<p><code>@AfterReturing</code> &#27880;&#35299;&#12290;&#20363;&#22914;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@AfterReturning("execution(public * say(..))")
public void after() {}

@AfterReturning(pointcut = "execution(public * say(..))", returning = "words")
public void printWords(String words) {
    System.out.println("Say something: " + words);
}</code></pre>
<p><code>printWords()</code> &#26041;&#27861;&#30340;&#21442;&#25968; <code>words</code> &#23601;&#26159;&#34987;&#25318;&#25130;&#26041;&#27861;&#30340;&#36820;&#22238;&#20540;&#65292;&#32780;&#19988;&#27492;&#22788;&#38480;&#23450;&#20102;&#35813;&#36890;&#30693;&#21482;&#25318;&#25130;&#36820;&#22238;&#20540;&#26159; <code>String</code> &#31867;&#22411;&#30340;&#35843;&#29992;&#12290;&#38656;&#35201;&#25552;&#37266;&#30340;&#26159;&#65292;<code>returning</code> &#20013;&#32473;&#23450;&#30340;&#21517;&#23383;&#24517;&#39035;&#19982;&#26041;&#27861;&#30340;&#21442;&#25968;&#21517;&#20445;&#25345;&#19968;&#33268;&#12290;</p>
<p>&#22914;&#26524;&#24819;&#35201;&#25318;&#25130;&#25243;&#20986;&#24322;&#24120;&#30340;&#35843;&#29992;&#65292;&#21487;&#20197;&#20351;&#29992; <code>@AfterThrowing</code> &#27880;&#35299;&#65292;&#36825;&#20010;&#27880;&#35299;&#30340;&#29992;&#27861;&#19982; <code>@AfterReturing</code> &#26497;&#20026;&#31867;&#20284;&#12290;&#20363;&#22914;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@AfterThrowing("execution(public * say(..))")
public void afterThrow() {}

@AfterThrowing(pointcut = "execution(public * say(..))", throwing = "exception")
public void printException(Exception exception) {}</code></pre>
<p>&#22914;&#26524;&#19981;&#20851;&#27880;&#25191;&#34892;&#26159;&#21542;&#25104;&#21151;&#65292;&#21482;&#26159;&#24819;&#22312;&#26041;&#27861;&#32467;&#26463;&#21518;&#20570;&#20123;&#21160;&#20316;&#65292;&#21487;&#20197;&#20351;&#29992; <code>@After</code> &#27880;&#35299;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@After("execution(public * say(..))")
public void afterAdvice() {}</code></pre>
<p>&#28155;&#21152;&#20102; <code>@After</code> &#27880;&#35299;&#30340;&#26041;&#27861;&#24517;&#39035;&#35201;&#33021;&#22815;&#22788;&#29702;&#27491;&#24120;&#19982;&#24322;&#24120;&#36825;&#20004;&#31181;&#24773;&#20917;&#65292;&#20294;&#23427;&#21448;&#33719;&#21462;&#19981;&#21040;&#36820;&#22238;&#20540;&#25110;&#24322;&#24120;&#23545;&#35937;&#65292;&#25152;&#20197;&#19968;&#33324;&#21482;&#34987;&#29992;&#26469;&#20570;&#19968;&#20123;&#36164;&#28304;&#28165;&#29702;&#30340;&#24037;&#20316;&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#29615;&#32469;&#36890;&#30693;</strong></p>
<p>&#36824;&#26377;&#19968;&#31181;&#36890;&#30693;&#31867;&#22411;&#26159;&#29615;&#32469;&#36890;&#30693;&#65292;&#23427;&#30340;&#21151;&#33021;&#27604;&#36739;&#24378;&#22823;&#65292;&#19981;&#20165;&#21487;&#20197;&#22312;&#26041;&#27861;&#25191;&#34892;&#21069;&#21518;&#21152;&#20837;&#33258;&#24049;&#30340;&#36923;&#36753;&#65292;&#29978;&#33267;&#21487;&#20197;&#23436;&#20840;&#26367;&#25442;&#26041;&#27861;&#26412;&#36523;&#30340;&#36923;&#36753;&#65292;&#25110;&#32773;&#26367;&#25442;&#35843;&#29992;&#21442;&#25968;&#12290;&#25105;&#20204;&#21487;&#20197;&#28155;&#21152; @Around &#27880;&#35299;&#26469;&#22768;&#26126;&#29615;&#32469;&#36890;&#30693;&#65292;&#36825;&#20010;&#26041;&#27861;&#30340;&#31614;&#21517;&#38656;&#35201;&#29305;&#21035;&#27880;&#24847;&#65292;&#23427;&#30340;&#31532;&#19968;&#20010;&#21442;&#25968;&#24517;&#39035;&#26159; ProceedingJoinPoint &#31867;&#22411;&#30340;&#65292;&#26041;&#27861;&#30340;&#36820;&#22238;&#31867;&#22411;&#26159;&#34987;&#25318;&#25130;&#26041;&#27861;&#30340;&#36820;&#22238;&#31867;&#22411;&#65292;&#25110;&#32773;&#30452;&#25509;&#29992; Object &#31867;&#22411;&#12290;</p>
<p>&#20363;&#22914;&#65292;&#25105;&#20204;&#24076;&#26395;&#32479;&#35745; <code>say()</code> &#26041;&#27861;&#30340;&#25191;&#34892;&#26102;&#38388;&#65292;&#21487;&#20197;&#20687;&#20195;&#30721;&#31034;&#20363; 3-6 &#37027;&#26679;&#26469;&#22768;&#26126;&#29615;&#32469;&#36890;&#30693;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-6</strong>&#12288;&#32479;&#35745;&#26041;&#27861;&#32791;&#26102;&#30340;&#29615;&#32469;&#36890;&#30693;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Aspect
public class TimerAspect {
    @Around("execution(public * say(..))")
    public Object recordTime(ProceedingJoinPoint pjp) throws Throwable {
        long start = System.currentTimeMillis();
        try {
            return pjp.proceed();
        } finally {
            long end = System.currentTimeMillis();
            System.out.println("Total time: " + (end - start) + "ms");
        }
    }
}</code></pre>
<p>&#20854;&#20013;&#30340; <code>pjp.proceed()</code> &#23601;&#26159;&#35843;&#29992;&#20855;&#20307;&#30340;&#36830;&#25509;&#28857;&#36827;&#34892;&#30340;&#22788;&#29702;&#65292;<code>proceed()</code> &#26041;&#27861;&#20063;&#25509;&#21463; <code>Ojbect[]</code> &#21442;&#25968;&#65292;&#21487;&#20197;&#26367;&#20195;&#21407;&#20808;&#30340;&#21442;&#25968;&#12290;</p>
<p>&#29615;&#32469;&#36890;&#30693;&#34429;&#28982;&#24456;&#24378;&#22823;&#65292;&#20294;&#22312;&#26085;&#24120;&#24320;&#21457;&#36807;&#31243;&#20013;&#65292;&#25105;&#20204;&#36873;&#25321;&#33021;&#28385;&#36275;&#38656;&#27714;&#30340;&#36890;&#30693;&#31867;&#22411;&#23601;&#22909;&#65292;&#22914;&#26524; <code>@After</code> &#22815;&#29992;&#65292;&#37027;&#23601;&#19981;&#29992; <code>@Around</code> &#20102;&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#24341;&#20837;&#36890;&#30693;</strong></p>
<p>&#19982;&#21069;&#38754;&#20171;&#32461;&#30340;&#20960;&#31181;&#30456;&#27604;&#65292;&#19979;&#38754;&#35201;&#20171;&#32461;&#30340;&#26368;&#21518;&#19968;&#31181; Spring AOP &#36890;&#30693;&#19981;&#22826;&#24120;&#29992;&#12290;&#25105;&#20204;&#21487;&#20197;&#20026; Bean &#28155;&#21152;&#26032;&#30340;&#25509;&#21475;&#65292;&#24182;&#20026;&#26032;&#22686;&#30340;&#26041;&#27861;&#25552;&#20379;&#40664;&#35748;&#23454;&#29616;&#65292;&#36825;&#31181;&#25805;&#20316;&#34987;&#31216;&#20026;<strong>&#24341;&#20837;</strong>&#65288;Introduction&#65289;<span class="&#27880;&#37322;&#32534;&#21495;">9</span>&#12290;&#22312;&#20999;&#38754;&#31867;&#37324;&#22768;&#26126;&#19968;&#20010;&#25104;&#21592;&#23646;&#24615;&#65292;&#35813;&#23646;&#24615;&#30340;&#31867;&#22411;&#23601;&#26159;&#35201;&#24341;&#20837;&#30340;&#31867;&#22411;&#65292;&#22312;&#19978;&#38754;&#28155;&#21152; <code>@DeclareParents</code> &#27880;&#35299;&#23601;&#21487;&#20197;&#22768;&#26126;&#24341;&#20837;&#65292;&#21487;&#20197;&#20687;&#19979;&#38754;&#36825;&#26679;&#20026; <code>Hello</code> &#21450;&#20854;&#23376;&#31867;&#23454;&#29616; <code>GoodBye</code> &#25509;&#21475;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Aspect
public class MyAspect {
    @DeclareParents(value = "learning.spring.helloworld.Hello+", defaultImpl = DefaultGoodByeImpl.class)
    private GoodBye goodBye;
}</code></pre>
<p>&#24341;&#20837;&#20854;&#23454;&#26159;&#38024;&#23545;&#31867;&#22411;&#36827;&#34892;&#30340;&#22686;&#24378;&#65292;<code>value</code> &#20013;&#20165;&#21487;&#22635;&#20837;&#35201;&#21305;&#37197;&#30340;&#31867;&#22411;&#65292;&#21487;&#20197;&#20351;&#29992; AspectJ &#31867;&#22411;&#21305;&#37197;&#27169;&#24335;&#12290;&#24341;&#20837;&#22768;&#26126;&#21518;&#65292;&#22312; Spring &#23481;&#22120;&#20013;&#21462;&#21040;&#30340; Bean &#23601;&#24050;&#32463;&#23436;&#25104;&#20102;&#22686;&#24378;&#65292;&#21738;&#24597;&#22312;&#21069;&#32622;&#36890;&#30693;&#20013;&#20063;&#26159;&#22914;&#27492;&#12290;</p>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">9</span>&#20063;&#26377;&#30340;&#22320;&#26041;&#31216;&#20026;&#24341;&#20171;&#12290;</p><h3 id="nav_point_50">3.2.3&#12288;&#22522;&#20110; <code>@AspectJ</code> &#30340;&#31034;&#20363;</h3><p>&#20026;&#20102;&#20415;&#20110;&#22823;&#23478;&#33021;&#26356;&#22909;&#22320;&#25484;&#25569; Spring AOP &#30340;&#29992;&#27861;&#65292;&#26412;&#33410;&#20026;&#22823;&#23478;&#20934;&#22791;&#20102;&#19968;&#20010;&#22522;&#20110; <code>@AspectJ</code> &#27880;&#35299;&#30340; AOP &#31034;&#20363; <span class="&#27880;&#37322;&#32534;&#21495;">10</span>&#65292;&#22914;&#20195;&#30721;&#31034;&#20363; 3-7 &#25152;&#31034;&#65292;&#20551;&#35774;&#36825;&#37324;&#25105;&#20204;&#26377;&#19968;&#20010; <code>Hello</code> &#25509;&#21475;&#21450;&#20854;&#23545;&#24212;&#23454;&#29616; <code>SpringHello</code>&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">10</span>&#23436;&#25972;&#20195;&#30721;&#25918;&#22312;&#20102;&#26412;&#20070;&#37197;&#22871;&#20195;&#30721;&#31034;&#20363;&#30340; ch3/helloworld-annotation-sample &#30446;&#24405;&#20013;&#12290;&#22914;&#26524;&#24819;&#35201;&#33258;&#24049;&#21160;&#25163;&#32534;&#20889;&#65292;&#39033;&#30446;&#30340; Maven POM &#25991;&#20214;&#20013;&#38656;&#35201;&#24341;&#20837; <code>spring-context</code>&#12289;<code>spring-aop</code> &#21644; <code>spring-aspects</code> &#36825;&#20960;&#20010;&#20381;&#36182;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-7</strong>&#12288;<code>Hello</code> &#25509;&#21475;&#21450;&#20854;&#23454;&#29616;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public interface Hello {
    // &#20026;&#20102;&#26041;&#20415;&#28436;&#31034;&#25913;&#21464;&#21442;&#25968;&#20869;&#23481;&#65292;&#27492;&#22788;&#20351;&#29992;StringBuffer
    String sayHello(StringBuffer words);
}

@Component
public class SpringHello implements Hello {
    @Override
    public String sayHello(StringBuffer words) {
        return "Hello! " + words;
    }
}</code></pre><p>&#31532;&#19968;&#20010;&#20999;&#38754;&#25318;&#25130; <code>Hello</code> &#31867;&#22411;&#20013;&#30340;&#26041;&#27861;&#25191;&#34892;&#65292;&#25105;&#20204;&#22312;&#20256;&#20837;&#30340; <code>StringBuffer</code> &#20013;&#36861;&#21152;&#20102;&#19968;&#27573;&#25991;&#23383;&#65292;&#20026;&#20102;&#28436;&#31034;&#22810;&#20010;&#36890;&#30693;&#30340;&#25191;&#34892;&#39034;&#24207;&#65292;&#36824;&#22686;&#21152;&#20102; <code>@Order</code> &#27880;&#35299;&#65292;&#22914;&#20195;&#30721;&#31034;&#20363; 3-8 &#25152;&#31034;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-8</strong>&#12288;<code>HelloAspect</code> &#20999;&#38754;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Aspect
@Component
@Order(1)
public class HelloAspect {
    @Before("target(learning.spring.helloworld.Hello) &amp;&amp; args(words)")
    public void addWords(StringBuffer words) {
        words.append("Welcome to Spring! ");
    }
}</code></pre><p>&#31532;&#20108;&#20010;&#20999;&#38754; <code>SayAspect</code> &#20013;&#26377;&#19977;&#37096;&#20998;&#20869;&#23481;&#65288;&#22914;&#20195;&#30721;&#31034;&#20363; 3-9 &#25152;&#31034;&#65289;&#65306;</p><p>(1) &#25318;&#25130;&#25152;&#26377; <code>say</code> &#25171;&#22836;&#30340;&#26041;&#27861;&#65292;&#22312; <code>StringBuffer</code> &#21442;&#25968;&#20013;&#36861;&#21152;&#30446;&#21069;&#20026;&#27490;&#35828;&#36807;&#30340;&#35805;&#30340;&#35745;&#25968; <span class="&#27880;&#37322;&#32534;&#21495;">11</span>&#65307;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">11</span>&#27492;&#22788;&#21487;&#20197;&#20851;&#27880;&#20004;&#20010; <code>@Before</code> &#36890;&#30693;&#30340;&#25191;&#34892;&#39034;&#24207;&#12290;&#27492;&#22806;&#65292;&#36825;&#37324;&#24182;&#27809;&#26377;&#32771;&#34385;&#24182;&#21457;&#30340;&#24773;&#20917;&#65292;&#22240;&#27492;&#35745;&#25968;&#26159;&#19981;&#20934;&#30830;&#30340;&#65292;&#20165;&#20570;&#28436;&#31034;&#20043;&#29992;&#12290;</p><p>(2) &#20026; <code>learning.spring.helloworld</code> &#21253;&#20869;&#30340;&#31867;&#24341;&#20837;&#20102;&#19968;&#20010; <code>GoodBye</code> &#25509;&#21475;&#65307;</p><p>(3) &#36890;&#36807;&#29615;&#32469;&#36890;&#30693;&#25913;&#21464;&#20102; <code>sayHello()</code> &#26041;&#27861;&#30340;&#25191;&#34892;&#32467;&#26524;&#65292;&#36861;&#21152;&#20102;&#23545;&#24341;&#20837;&#30340; <code>GoodBye</code> &#25509;&#21475;&#30340;&#35843;&#29992;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-9</strong>&#12288;<code>SayAspect</code> &#20999;&#38754;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Aspect
@Component
@Order(2)
public class SayAspect {
    @DeclareParents(value = "learning.spring.helloworld.*",
                    defaultImpl = DefaultGoodBye.class)
    private GoodBye bye;
    private int counter = 0;

    @Before("execution(* say*(..)) &amp;&amp; args(words)")
    public void countSentence(StringBuffer words) {
        words.append("[" + ++counter + "]\n");
    }

    @Around("execution(* sayHello(..)) &amp;&amp; this(bye)")
    public String addSay(ProceedingJoinPoint pjp, GoodBye bye)
        throws Throwable {
        return pjp.proceed() + bye.sayBye();
    }

    public void reset() {
        counter = 0;
    }

    public int getCounter() {
        return counter;
    }
}</code></pre><p>&#36825;&#20010;&#20999;&#38754;&#20013;&#25152;&#24341;&#20837;&#30340; <code>GoodBye</code> &#25509;&#21475;&#21450;&#20854;&#40664;&#35748;&#23454;&#29616;&#20869;&#23481;&#22914;&#20195;&#30721;&#31034;&#20363; 3-10 &#25152;&#31034;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-10</strong>&#12288;<code>GoodBye</code> &#25509;&#21475;&#21450;&#20854;&#23454;&#29616;&#30340;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public interface GoodBye {
    String sayBye();
}

public class DefaultGoodBye implements GoodBye {
    @Override
    public String sayBye() {
        return "Bye! ";
    }
}</code></pre><p>&#20026;&#20102;&#39564;&#35777;&#36825;&#20010;&#31034;&#20363;&#30340;&#36816;&#34892;&#32467;&#26524;&#26159;&#21542;&#22914;&#25105;&#20204;&#39044;&#26399;&#30340;&#37027;&#26679;&#65292;&#21487;&#20197;&#32534;&#20889;&#19968;&#20010;&#25191;&#34892;&#31867;&#65292;&#30452;&#25509;&#21435;&#35843;&#29992; <code>SpringHello</code> &#30340; <code>sayHello()</code> &#26041;&#27861;&#12290;&#20294;&#22312;&#23454;&#38469;&#24037;&#20316;&#20013;&#65292;&#22823;&#23478;&#35201;&#20889;&#30340;&#20195;&#30721;&#36828;&#27604;&#20363;&#23376;&#20013;&#30340;&#22797;&#26434;&#65292;&#32780;&#19988;&#24456;&#22810;&#26102;&#20505;&#38656;&#35201;&#36827;&#34892;&#21508;&#31181;&#27979;&#35797;&#26469;&#20570;&#39564;&#35777;&#8212;&#8212;&#26377;&#20102;&#20805;&#20998;&#30340;&#21333;&#20803;&#27979;&#35797;&#65292;&#25165;&#33021;&#20445;&#38556;&#20195;&#30721;&#36136;&#37327;&#12290;&#22240;&#27492;&#65292;&#20174;&#26412;&#33410;&#24320;&#22987;&#65292;&#25105;&#20204;&#30340;&#31034;&#20363;&#20013;&#20250;&#21152;&#20837;&#27979;&#35797;&#29992;&#20363;&#26469;&#39564;&#35777;&#20195;&#30721;&#26159;&#21542;&#31526;&#21512;&#39044;&#26399;&#12290;&#25509;&#19979;&#26469;&#65292;&#23601;&#35753;&#25105;&#20204;&#26469;&#30475;&#30475;&#36825;&#20004;&#31181;&#26041;&#24335;&#30340;&#20195;&#30721;&#35813;&#22914;&#20309;&#32534;&#20889;&#12290;</p><ol>
<li><p><strong>&#30452;&#25509;&#36816;&#34892;&#20195;&#30721;</strong></p>
<p>&#25105;&#20204;&#36890;&#36807; <code>AnnotationConfigApplicationContext</code> &#21487;&#20197;&#26500;&#24314;&#19968;&#20010;&#22522;&#20110;&#27880;&#35299;&#30340; Spring &#23481;&#22120;&#65292;&#20877;&#37197;&#21512;&#31616;&#21333;&#30340; Java &#37197;&#32622;&#31867;&#65292;&#36825;&#20010;&#20195;&#30721;&#23601;&#33021;&#36816;&#34892;&#20102;&#65292;&#22914;&#20195;&#30721;&#31034;&#20363; 3-11 &#25152;&#31034;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-11</strong>&#12288;<code>Application</code> &#31867;&#30340;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@Configuration
@EnableAspectJAutoProxy
@ComponentScan("learning.spring.helloworld")
public class Application {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext applicationContext =
                new AnnotationConfigApplicationContext(Application.class);

        Hello hello = applicationContext.getBean("springHello", Hello.class);
        System.out.println(hello.sayHello(new StringBuffer("My Friend. ")));
        System.out.println(hello.sayHello(new StringBuffer("My Dear Friend. ")));
    }
}</code></pre>
<p>&#19978;&#36848;&#20195;&#30721;&#30340;&#25191;&#34892;&#36755;&#20986;&#22914;&#19979;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>Hello! My Friend. Welcome to Spring! [1]
Bye!
Hello! My Dear Friend. Welcome to Spring! [2]
Bye!</code></pre>
<p>&#160;</p>
</li>
<li><p><strong>&#21333;&#20803;&#27979;&#35797;</strong></p>
<p>&#30452;&#25509;&#36816;&#34892;&#20195;&#30721;&#65292;&#28982;&#21518;&#36890;&#36807;&#32905;&#30524;&#26597;&#30475;&#36755;&#20986;&#20869;&#23481;&#26469;&#21028;&#26029;&#36923;&#36753;&#26159;&#21542;&#27491;&#30830;&#65292;&#36825;&#31181;&#26041;&#27861;&#34429;&#28982;&#31616;&#21333;&#30452;&#35266;&#65292;&#20294;&#19981;&#20855;&#22791;&#22312;&#22823;&#35268;&#27169;&#39033;&#30446;&#20013;&#20351;&#29992;&#30340;&#26465;&#20214;&#8212;&#8212;&#27599;&#27425;&#25913;&#21160;&#20195;&#30721;&#37117;&#35201;&#20154;&#32905;&#27979;&#35797;&#65292;&#26082;&#19981;&#39640;&#25928;&#65292;&#21448;&#28010;&#36153;&#20154;&#21147;&#36164;&#28304;&#12290;&#25152;&#20197;&#65292;&#33021;&#29992;&#20195;&#30721;&#26469;&#39564;&#35777;&#30340;&#20107;&#65292;&#25105;&#20204;&#23601;&#35201;&#25226;&#23427;&#20204;&#20889;&#25104;&#33258;&#21160;&#21270;&#27979;&#35797;&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">12</span></p>
<p>Maven &#24037;&#31243;&#40664;&#35748;&#23558;&#29983;&#20135;&#20195;&#30721;&#21644;&#27979;&#35797;&#20195;&#30721;&#20998;&#24320;&#20102;&#65292;&#29983;&#20135;&#20195;&#30721;&#22312; <code>main</code> &#30446;&#24405;&#20013;&#65292;&#32780;&#27979;&#35797;&#20195;&#30721;&#21017;&#20889;&#22312; <code>test</code> &#30446;&#24405;&#20013;&#12290;&#20026;&#20102;&#22312;&#39033;&#30446;&#20013;&#20351;&#29992; JUnit 5 &#36827;&#34892;&#21333;&#20803;&#27979;&#35797;&#65292;pom.xml &#25991;&#20214;&#38656;&#35201;&#24341;&#20837; <code>spring-test</code> &#21644; <code>junit-jupiter</code> &#20381;&#36182;&#65292;&#23601;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;<span class="&#27880;&#37322;&#32534;&#21495;">13</span></p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;dependencies&gt;
    &lt;!-- &#30465;&#30053;&#20854;&#20182;&#20869;&#23481; --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
        &lt;version&gt;5.3.15&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
        &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
        &lt;version&gt;5.8.2&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
<p>&#19979;&#38754;&#25105;&#20204;&#32534;&#20889;&#19968;&#20010; <code>ApplicationTest</code> &#31867;&#65292;&#36890;&#36807;&#20854;&#20013;&#30340;&#26029;&#35328;&#65288;assertion&#65289;&#26469;&#21028;&#26029;&#32467;&#26524;&#65292;&#22914;&#20195;&#30721;&#31034;&#20363; 3-12 &#25152;&#31034;&#12290;</p>
<blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-12</strong>&#12288;<code>ApplicationTest</code> &#31867;&#30340;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@ExtendWith(SpringExtension.class)
@ContextConfiguration(classes = Application.class)
// &#36825;&#20010;@SpringJUnitConfig&#21487;&#20197;&#20195;&#26367;&#19978;&#36848;&#20004;&#34892;
// @SpringJUnitConfig(Application.class)
public class ApplicationTest {
    @Autowired
    private Hello hello;
    @Autowired
    private SayAspect sayAspect;

    @BeforeEach
    public void setUp() {
        // Spring&#23481;&#22120;&#26159;&#21516;&#19968;&#20010;&#65292;&#22240;&#27492;SayAspect&#20063;&#26159;&#21516;&#19968;&#20010;
        // &#37325;&#32622;&#35745;&#25968;&#22120;&#65292;&#26041;&#20415;&#36827;&#34892;&#26029;&#35328;&#21028;&#26029;
        sayAspect.reset();
    }

    @Test
    @DisplayName("springHello&#19981;&#20026;&#31354;")
    public void testNotEmpty() {
        assertNotNull(hello);
    }

    @Test
    @DisplayName("springHello&#26159;&#21542;&#20026;GoodBye&#31867;&#22411;")
    public void testIntroduction() {
        assertTrue(hello instanceof GoodBye);
    }

    @Test
    @DisplayName("&#36890;&#30693;&#26159;&#21542;&#22343;&#24050;&#25191;&#34892;")
    public void testAdvice() {
        StringBuffer words = new StringBuffer("Test. ");
        String sentence = hello.sayHello(words);
        assertEquals("Test. Welcome to Spring! [1]\n", words.toString());
        assertEquals("Hello! Test. Welcome to Spring! [1]\nBye! ", sentence);
    }

    @Test
    @DisplayName("&#35828;&#20004;&#21477;&#35805;&#65292;&#26816;&#26597;&#35745;&#25968;")
    public void testMultipleSpeaking() {
        assertEquals("Hello! Test. Welcome to Spring! [1]\nBye! ",
                     hello.sayHello(new StringBuffer("Test. ")));
        assertEquals("Hello! Test. Welcome to Spring! [2]\nBye! ",
                     hello.sayHello(new StringBuffer("Test. ")));
    }
}</code></pre>
<p>&#22312; IDEA &#20013;&#25191;&#34892;&#27979;&#35797;&#21518;&#65292;&#21487;&#20197;&#30475;&#21040;&#22914;&#22270; 3-2 &#30340;&#27979;&#35797;&#32467;&#26524;&#12290;&#22914;&#26524;&#26576;&#39033;&#27979;&#35797;&#22833;&#36133;&#65292;&#37027;&#20040;&#23545;&#24212;&#27979;&#35797;&#23601;&#19981;&#20250;&#26377;&#32511;&#33394;&#30340;&#23545;&#21246;&#12290;&#22823;&#23478;&#21487;&#20197;&#36890;&#36807;&#28857;&#20987;&#36873;&#20013;&#26576;&#39033;&#27979;&#35797;&#65292;&#26597;&#30475;&#20854;&#20855;&#20307;&#25191;&#34892;&#24773;&#20917;&#12290;</p>
<p class="p-img"><img alt="{%}" src="file:///[PrimaryStorage]local_pic/XueTouSpring_CongRuMenDaoXiangMuShiZhan/image00759.jpeg"/></p>
<p class="p-img-title"><strong>&#22270; 3-2&#12288;IDEA &#20013;&#30340;&#27979;&#35797;&#32467;&#26524;</strong></p>
<p>&#20063;&#21487;&#20197;&#22312;&#21629;&#20196;&#34892;&#20013;&#36890;&#36807; Maven &#26469;&#25191;&#34892;&#27979;&#35797;&#65292;&#30001;&#20110; JUnit 5 &#23545; Maven &#21450;&#20854;&#25554;&#20214;&#30340;&#29256;&#26412;&#26377;&#35201;&#27714;&#65292;&#27979;&#35797;&#32773;&#26368;&#22909;&#23433;&#35013; 3.6.0 &#29256;&#26412;&#20197;&#19978;&#30340; Maven&#65292;&#24182;&#22312; pom.xml &#20013;&#20462;&#25913; maven-surefire-plugin &#30340;&#29256;&#26412;&#65292;&#27604;&#22914;&#20351;&#29992; 2.22.0 &#20197;&#19978;&#30340;&#29256;&#26412;&#65292;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;build&gt;
    &lt;plugins&gt;
        &lt;!-- &#20026;&#20102;&#25903;&#25345;JUnit 5&#65292; &#20351;&#29992;2.22.0&#30340;&#25554;&#20214; --&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
            &lt;version&gt;2.22.0&lt;/version&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
<p>&#38543;&#21518;&#22312;&#24037;&#31243;&#30446;&#24405;&#20013;&#25191;&#34892; <code>mvn test</code> &#21629;&#20196;&#65292;&#22914;&#26524;&#19968;&#20999;&#39034;&#21033;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#22312;&#36755;&#20986;&#20013;&#30475;&#21040;&#31867;&#20284;&#22914;&#19979;&#30340;&#20869;&#23481;&#65288;&#22914;&#26524;&#26377;&#26029;&#35328;&#22833;&#36133;&#65292;&#20063;&#20250;&#22312;&#36755;&#20986;&#20013;&#26377;&#25152;&#25552;&#31034;&#65289;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.523 s - in learning.spring.
    helloworld.ApplicationTest
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</li>
</ol><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">12</span>&#30446;&#21069;&#20027;&#27969;&#30340; Java &#21333;&#20803;&#27979;&#35797;&#26694;&#26550;&#26159; JUnit &#21644; TestNG&#12290;&#20174;&#20351;&#29992;&#20154;&#25968;&#19978;&#30475;&#65292;JUnit 4 &#29992;&#24471;&#27604;&#36739;&#24191;&#27867;&#65307;&#32780;&#20174;&#21151;&#33021;&#19978;&#26469;&#35828;&#65292;JUnit 5 &#21644; TestNG &#26356;&#20026;&#20016;&#23500;&#12290;&#27492;&#22806;&#65292;Spring Framework 5 &#20063;&#25903;&#25345; JUnit 5&#65292;&#22240;&#27492;&#26412;&#20070;&#30340;&#31034;&#20363;&#20250;&#20351;&#29992; JUnit 5&#12290;&#20851;&#20110; JUnit 5 &#30340;&#29992;&#27861;&#65292;&#26412;&#20070;&#19981;&#20570;&#35828;&#26126;&#65292;&#31616;&#21333;&#30340;&#20351;&#29992;&#20250;&#30452;&#25509;&#25918;&#22312;&#20363;&#23376;&#20013;&#65292;&#32780;&#22797;&#26434;&#30340;&#29992;&#27861;&#65292;&#35831;&#22823;&#23478;&#21442;&#32771;&#23448;&#26041;&#25991;&#26723;&#12290;&#20851;&#20110; Spring Framework &#30340;&#27979;&#35797;&#25903;&#25345;&#65292;&#23558;&#20250;&#31359;&#25554;&#22312;&#26412;&#20070;&#30340;&#21508;&#20010;&#31456;&#33410;&#37324;&#65292;&#19981;&#23433;&#25490;&#29420;&#31435;&#31456;&#33410;&#35828;&#26126;&#12290;</p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">13</span>&#36825;&#37324;&#30340;&#29256;&#26412;&#35270;&#23454;&#38469;&#24773;&#20917;&#32780;&#23450;&#65292;&#22312;&#20351;&#29992;&#20102; Spring Boot &#21518;&#65292;&#21487;&#20197;&#35753; Spring Boot &#26469;&#31649;&#29702;&#36825;&#20123;&#29256;&#26412;&#12290;</p><h2 id="nav_point_51">3.3&#12288;&#22522;&#20110; XML Schema &#30340;&#37197;&#32622;</h2><p>Spring Framework &#38500;&#20102;&#25903;&#25345;&#20197; <code>@AspectJ</code> &#27880;&#35299;&#30340;&#26041;&#24335;&#26469;&#37197;&#32622; AOP&#65292;&#36824;&#25903;&#25345;&#36890;&#36807; <code>&lt;aop/&gt;</code> XML Schema &#30340;&#26041;&#24335;&#12290;&#22914;&#26524;&#22823;&#23478;&#20064;&#24815;&#20351;&#29992; XML&#65292;&#20063;&#21487;&#20197;&#32771;&#34385;&#37319;&#29992;&#36825;&#31181;&#26041;&#24335;&#12290;</p><p>Spring AOP &#30456;&#20851;&#30340; XML &#37197;&#32622;&#65292;&#37117;&#25918;&#22312; <code>&lt;aop:config/&gt;</code> &#20013;&#65292;&#27604;&#22914;&#35201;&#22768;&#26126;&#20999;&#38754;&#65292;&#23601;&#21487;&#20197;&#20687;&#20195;&#30721;&#31034;&#20363; 3-13 &#37027;&#26679;&#12290;&#20999;&#38754;&#31867;&#30340;&#20869;&#23481;&#21644;&#19978;&#19968;&#33410;&#20171;&#32461;&#30340;&#31867;&#20284;&#65292;&#20294;&#26080;&#39035;&#28155;&#21152;&#27880;&#35299;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-13</strong>&#12288;&#29992; <code>&lt;aop:aspect/&gt;</code> &#22768;&#26126;&#20999;&#38754;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:aop="http://www.springframework.org/schema/aop"
        xsi:schemaLocation="http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd"&gt;

    &lt;aop:config&gt;
        &lt;aop:aspect id="helloAspect" ref="aspectBean"&gt;
            &lt;!-- &#20854;&#20182;&#20869;&#23481;&#30465;&#30053; --&gt;
        &lt;/aop:aspect&gt;
    &lt;/aop:config&gt;

    &lt;bean id="aspectBean" class="..." /&gt;
&lt;/beans&gt;</code></pre><h3 id="nav_point_52">3.3.1&#12288;&#22768;&#26126;&#20999;&#20837;&#28857;</h3><p>&#22312; <code>&lt;aop:config/&gt;</code> &#20013;&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807; <code>&lt;aop:pointcut/&gt;</code> &#26469;&#37197;&#32622;&#20999;&#20837;&#28857;&#12290;&#23427;&#26082;&#21487;&#20197;&#37197;&#32622;&#22312; <code>&lt;aop:config/&gt;</code> &#20013;&#65292;&#20063;&#21487;&#20197;&#20986;&#29616;&#22312; <code>&lt;aop:aspect/&gt;</code> &#20013;&#12290;&#20999;&#20837;&#28857;&#30340; <code>id</code> &#21487;&#20197;&#26041;&#20415;&#22797;&#29992;&#65292;<code>expression</code> &#20013;&#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#23601;&#21644; 3.2.1 &#33410;&#20013;&#20171;&#32461;&#30340;&#19968;&#33268;&#12290;&#20363;&#22914;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:config&gt;
    &lt;aop:aspect id="helloAspect" ref="aspectBean"&gt;
        &lt;aop:pointcut id="helloType" expression="target(learning.spring.helloworld.Hello)" /&gt;
        &lt;!-- &#20854;&#20182;&#20869;&#23481;&#30465;&#30053; --&gt;
    &lt;/aop:aspect&gt;
&lt;/aop:config&gt;</code></pre><p><code>&lt;aop:pointcut/&gt;</code> &#30340; <code>expression</code> &#20013;&#26082;&#21487;&#20197;&#30452;&#25509;&#20889;&#34920;&#36798;&#24335;&#65292;&#20063;&#21487;&#20197;&#20889;&#24102;&#26377; <code>@Pointcut</code> &#27880;&#35299;&#30340;&#20840;&#38480;&#23450;&#26041;&#27861;&#12290;&#34920;&#36798;&#24335;&#21516;&#26679;&#25903;&#25345;&#36816;&#31639;&#65292;&#21487;&#20197;&#29992; <code>&amp;&amp;</code>&#12289;<code>||</code> &#21644; <code>!</code>&#65292;&#25110;&#32773; <code>and</code>&#12289;<code>or</code> &#21644; <code>not</code> &#36827;&#34892;&#32452;&#21512;&#65292;&#32771;&#34385;&#21040; XML &#20013;&#29992;&#21069;&#19968;&#31181;&#26041;&#24335;&#27604;&#36739;&#40635;&#28902;&#65292;&#36825;&#37324;&#24314;&#35758;&#22823;&#23478;&#36824;&#26159;&#23613;&#37327;&#20351;&#29992; <code>and</code>&#12289;<code>or</code> &#21644; <code>not</code>&#12290;&#38656;&#35201;&#27880;&#24847;&#19968;&#28857;&#65292;&#32452;&#21512;&#34920;&#36798;&#24335;&#20013;&#19981;&#33021;&#36890;&#36807; <code>id</code> &#26469;&#24341;&#29992;&#20854;&#20182;&#24050;&#32463;&#23450;&#20041;&#30340;&#20999;&#20837;&#28857;&#12290;</p><h3 id="nav_point_53">3.3.2&#12288;&#22768;&#26126;&#36890;&#30693;</h3><p>&#22312; XML &#20013;&#30340;&#36890;&#30693;&#20063;&#21644; <code>@AspectJ</code> &#27880;&#35299;&#30340;&#31867;&#20284;&#65292;&#21482;&#19981;&#36807;&#25442;&#25104;&#20102; <code>&lt;aop:before/&gt;</code>&#12289;<code>&lt;aop:after-returning/&gt;</code> &#31561; XML &#32780;&#24050;&#12290;&#22914;&#26524;&#26377;&#22810;&#20010;&#36890;&#30693;&#35201;&#25191;&#34892;&#65292;&#21487;&#20197;&#35753;&#20999;&#38754;&#31867;&#23454;&#29616; <code>Ordered</code> &#25509;&#21475;&#25110;&#32773;&#28155;&#21152; <code>@Order</code> &#27880;&#35299;&#65292;<code>&lt;aop:aspect/&gt;</code> &#20013;&#26377;&#19968;&#20010; <code>order</code> &#23646;&#24615;&#20063;&#21487;&#20197;&#37197;&#32622;&#20999;&#38754;&#30340;&#39034;&#24207;&#12290;</p><ol>
<li><p><strong>&#21069;&#32622;&#36890;&#30693;</strong></p>
<p><code>&lt;aop:before/&gt;</code> &#21487;&#20197;&#29992;&#26469;&#22768;&#26126;&#21069;&#32622;&#36890;&#30693;&#65292;<code>method</code> &#23646;&#24615;&#30340;&#20540;&#26159;&#20999;&#38754;&#30340;&#20855;&#20307;&#26041;&#27861;&#65292;&#20854;&#20013;&#21253;&#21547;&#20102;&#21069;&#32622;&#36890;&#30693;&#30340;&#20195;&#30721;&#36923;&#36753;&#65307;<code>pointcut</code> &#23646;&#24615;&#30340;&#20540;&#26159;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#20063;&#21487;&#20197;&#36890;&#36807; <code>pointcut-ref</code> &#23646;&#24615;&#26469;&#20351;&#29992;&#20107;&#20808;&#23450;&#20041;&#22909;&#30340;&#20999;&#20837;&#28857;&#12290;&#20363;&#22914;&#65292;&#20195;&#30721;&#31034;&#20363; 3-7 &#30340;&#21069;&#32622;&#36890;&#30693;&#65292;&#21487;&#20197;&#25913;&#20889;&#20026;&#22914;&#19979; XML &#26684;&#24335;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:aspect id="beforeAspect" ref="beforeAspectBean"&gt;
    &lt;aop:before pointcut="learning.spring.helloworld.HelloPointcut.sayHello()" method="before" /&gt;
&lt;/aop:aspect&gt;</code></pre>
<p>&#22312; <code>pointcut</code> &#20013;&#20063;&#21487;&#20197;&#20351;&#29992;&#32465;&#23450;&#30340;&#26041;&#24335;&#21521;&#26041;&#27861;&#20256;&#36882;&#21442;&#25968;&#65292;&#27604;&#22914;&#29992; <code>args()</code>&#12289;<code>this()</code> &#25110; <code>target()</code>&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#21518;&#32622;&#36890;&#30693;</strong></p>
<p>&#19982;&#22522;&#20110; <code>@AspectJ</code> &#27880;&#35299;&#30340;&#26041;&#24335;&#19968;&#26679;&#65292;&#22522;&#20110; XML Schema &#30340;&#21518;&#32622;&#36890;&#30693;&#21516;&#26679;&#20998;&#20026;&#19977;&#31867;&#12290;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#27491;&#24120;&#36820;&#22238;&#65306;<code>&lt;aop:after-returning/&gt;</code>&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#25243;&#20986;&#24322;&#24120;&#65306;<code>&lt;aop:after-throwing/&gt;</code>&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#26080;&#25152;&#35859;&#27491;&#24120;&#36820;&#22238;&#36824;&#26159;&#25243;&#20986;&#24322;&#24120;&#65306;<code>&lt;aop:after/&gt;</code>&#12290;</li>
</ul>
<p>&#19977;&#20010;&#26631;&#31614;&#20013;&#37117;&#26377; <code>pointcut</code>&#12289;<code>pointcut-ref</code> &#21644; <code>method</code> &#23646;&#24615;&#65292;&#20854;&#20316;&#29992;&#19982; <code>&lt;aop:before/&gt;</code> &#20013;&#20171;&#32461;&#30340;&#19968;&#26679;&#12290;</p>
<p><code>&lt;aop:after-returning/&gt;</code> &#20013;&#36824;&#26377;&#19968;&#20010; <code>returning</code> &#23646;&#24615;&#65292;&#29992;&#26469;&#23558;&#26041;&#27861;&#30340;&#25191;&#34892;&#36820;&#22238;&#20256;&#36882;&#21040;&#36890;&#30693;&#26041;&#27861;&#20013;&#65292;&#23646;&#24615;&#20540;&#38656;&#35201;&#19982;&#26041;&#27861;&#30340;&#21442;&#25968;&#21517;&#19968;&#33268;&#12290;&#24403;&#28982;&#65292;&#25105;&#20204;&#20063;&#21487;&#20197;&#24573;&#30053;&#36825;&#20010;&#23646;&#24615;&#65292;&#19981;&#20851;&#24515;&#36820;&#22238;&#20540;&#12290;3.2.2 &#33410;&#20013;&#30340;&#20363;&#23376;&#21487;&#20197;&#25913;&#20889;&#25104;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:after-returning pointcut="execution(public * say(..))"
                       returning="words"
                       method="printWords" /&gt;</code></pre>
<p><code>&lt;aop:after-throwing/&gt;</code> &#20013;&#20063;&#19982;&#27880;&#35299;&#19968;&#26679;&#65292;&#26377;&#19968;&#20010; <code>throwing</code> &#23646;&#24615;&#65292;&#29992;&#26469;&#21521;&#36890;&#30693;&#26041;&#27861;&#20013;&#20256;&#36882;&#25243;&#20986;&#30340;&#24322;&#24120;&#12290;3.2.2 &#33410;&#20013;&#30340;&#20363;&#23376;&#21516;&#26679;&#21487;&#20197;&#25913;&#20889;&#25104;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:after-throwing pointcut="execution(public * say(..))"
                      method="afterThrow" /&gt;

&lt;aop:after-throwing pointcut="execution(public * say(..))"
                      throwing="exception"
                      method="printException" /&gt;</code></pre>
<p><code>&lt;aop:after/&gt;</code> &#21017;&#30456;&#23545;&#31616;&#21333;&#65292;&#27809;&#26377;&#39069;&#22806;&#30340;&#23646;&#24615;&#21487;&#20197;&#37197;&#32622;&#12290;&#19978;&#38754;&#30340;&#20363;&#23376;&#25913;&#20889;&#20026; XML &#21518;&#23601;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:after pointcut="execution(public * say(..))" method="afterAdvice" /&gt;</code></pre>
<p>&#160;</p>
</li>
<li><p><strong>&#29615;&#32469;&#36890;&#30693;</strong></p>
<p>&#29615;&#32469;&#36890;&#30693;&#30340;&#20195;&#30721;&#23454;&#29616;&#19982;&#20351;&#29992; <code>@AspectJ</code> &#27880;&#35299;&#26102;&#26159;&#19968;&#26679;&#30340;&#65292;&#21482;&#19981;&#36807;&#23558;&#27880;&#35299;&#25442;&#25104;&#20102; <code>&lt;aop:around/&gt;</code> &#30340; XML&#65292;&#20195;&#30721;&#31034;&#20363; 3-8 &#30340;&#22768;&#26126;&#21487;&#20197;&#25913;&#20889;&#25104;&#22914;&#19979; XML&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:around pointcut="execution(public * say(..))" method="recordTime" /&gt;</code></pre>
<p>&#33267;&#20110;&#20855;&#20307;&#30340;&#26041;&#27861;&#23450;&#20041;&#65292;&#21487;&#20197;&#22238;&#39038;&#19968;&#19979; 3.2.2 &#33410;&#20013;&#30340;&#30456;&#20851;&#20869;&#23481;&#21644;&#20195;&#30721;&#31034;&#20363; 3-8&#12290;</p>
<p>&#160;</p>
</li>
<li><p><strong>&#24341;&#20837;&#36890;&#30693;</strong></p>
<p>XML &#20013;&#21516;&#26679;&#20063;&#21487;&#20197;&#22768;&#26126;&#24341;&#20837;&#65292;&#22312; <code>&lt;aop:aspect/&gt;</code> &#20013;&#36890;&#36807; <code>&lt;aop:declare-parents/&gt;</code> &#23601;&#21487;&#20197;&#23454;&#29616;&#21644; <code>@DeclareParents</code> &#27880;&#35299;&#19968;&#26679;&#30340;&#25928;&#26524;&#65292;<code>&lt;aop:declare-parents/&gt;</code> &#37324;&#26377;&#19977;&#20010;&#23646;&#24615;&#12290;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>types-matching</code>&#65306;&#29992;&#26469;&#21305;&#37197;&#31867;&#22411;&#65292;&#27604;&#22914; <code>learning.spring.helloworld.*+</code>&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>implement-interface</code>&#65306;&#35201;&#24341;&#20837;&#30340;&#25509;&#21475;&#12290;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;"><code>default-impl</code>&#65306;&#25509;&#21475;&#30340;&#40664;&#35748;&#23454;&#29616;&#12290;</li>
</ul>
<p>3.2.2 &#33410;&#20013;&#30340; <code>@DeclareParents</code> &#31034;&#20363;&#21487;&#20197;&#25913;&#20889;&#25104;&#19979;&#38754;&#36825;&#26679;&#65306;</p>
<pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:aspect id="myAspect" ref="myAspectBean"&gt;
    &lt;aop:declare-parents types-matching="learning.spring.helloworld.Hello+"
        implement-interface="learning.spring.helloworld.GoodBye"
        default-impl="learning.spring.helloworld.DefaultGoodByeImpl"/&gt;
    &lt;!-- &#20854;&#20182;&#30465;&#30053; --&gt;
&lt;/aop:aspect&gt;</code></pre>
</li>
</ol><h3 id="nav_point_54">3.3.3&#12288;&#36890;&#30693;&#22120;</h3><p>&#22914;&#26524;&#35273;&#24471; XML Schema &#30340;&#37197;&#32622;&#26041;&#24335;&#27604;&#36739;&#32321;&#29712;&#65292;&#22312; <code>&lt;aop:config/&gt;</code> &#20013;&#21448;&#26377; <code>&lt;aop:aspect/&gt;</code>&#65292;&#21448;&#26377; <code>&lt;aop:pointcut/&gt;</code>&#65292;&#36824;&#26377;&#21508;&#31181;&#36890;&#30693;&#12290;&#20026;&#27492;&#65292;Spring Framework &#20026;&#25105;&#20204;&#25552;&#20379;&#20102;&#19968;&#22871;&#36890;&#30693;&#22120;&#65288;advisor&#65289;&#30340; XML &#20803;&#32032;&#65292;&#36890;&#36807; <code>&lt;aop:advisor/&gt;</code> &#21487;&#20197;&#31616;&#21333;&#22320;&#37197;&#32622;&#20986;&#19968;&#20010;&#20165;&#21253;&#21547;&#21333;&#20010;&#36890;&#30693;&#30340;&#20999;&#38754;&#65292;&#36890;&#30693;&#22120;&#20013;&#24341;&#29992;&#30340; Bean &#35201;&#23454;&#29616;&#22914;&#19979;&#30340; AOP &#36890;&#30693;&#25509;&#21475;&#12290;</p><ul>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;"><code>MethodInterceptor</code>&#65306;&#29615;&#32469;&#36890;&#30693;&#12290;</li>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;"><code>MethodBeforeAdvice</code>&#65306;&#21069;&#32622;&#36890;&#30693;&#12290;</li>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;"><code>AfterReturningAdvice</code>&#65306;&#27491;&#24120;&#36820;&#22238;&#30340;&#21518;&#32622;&#36890;&#30693;&#12290;</li>
<li class="&#31532;1&#32423;&#26080;&#24207;&#21015;&#34920;"><code>ThrowsAdvice</code>&#65306;&#25243;&#20986;&#24322;&#24120;&#30340;&#21518;&#32622;&#36890;&#30693;&#12290;</li>
</ul><p>&#38543;&#21518;&#65292;&#21487;&#20197;&#20687;&#19979;&#38754;&#36825;&#26679;&#26469;&#23450;&#20041;&#36890;&#30693;&#22120;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;aop:config&gt;
    &lt;aop:pointcut id="sayMethod" expression="execution(public * say(..))" /&gt;

    &lt;aop:advisor pointcut-ref="sayMethod" advice-ref="aroundAdvice" /&gt;
&lt;/aop:config&gt;

&lt;bean id="aroundAdvice" class="learning.spring.helloworld.SayMethodInterceptor" /&gt;</code></pre><h3 id="nav_point_55">3.3.4&#12288;&#22522;&#20110; XML Schema &#30340;&#31034;&#20363;</h3><p>&#19982; 3.2 &#33410;&#19968;&#26679;&#65292;&#26412;&#33410;&#20063;&#25552;&#20379;&#20102;&#19968;&#20010;&#31034;&#20363;&#24110;&#21161;&#22823;&#23478;&#29702;&#35299;&#24182;&#25484;&#25569;&#22522;&#20110; XML Schema &#30340; AOP &#20351;&#29992;&#26041;&#24335;&#12290;&#26377;&#20102; 3.2.3 &#33410;&#30340;&#22522;&#30784;&#65292;&#26412;&#33410;&#30340;&#20363;&#23376;&#21487;&#20197;&#22522;&#26412;&#29031;&#25644; 3.2.3 &#33410;&#20013;&#30340;&#20195;&#30721;&#65292;&#21435;&#38500;&#25152;&#26377; <code>@AspectJ</code> &#30456;&#20851;&#30340;&#27880;&#35299;&#65292;&#21516;&#26102;&#23558; Bean &#37197;&#32622;&#26041;&#24335;&#20174;&#27880;&#35299;&#25442;&#25104; XML&#12290;<span class="&#27880;&#37322;&#32534;&#21495;">14</span></p><p class="&#27880;&#37322;&#20869;&#23481;"><span class="&#27880;&#37322;&#32534;&#21495;&#19979;">14</span>&#23436;&#25972;&#20195;&#30721;&#25918;&#22312;&#20102;&#26412;&#20070;&#37197;&#22871;&#20195;&#30721;&#31034;&#20363;&#30340; ch3/helloworld-xml-sample &#30446;&#24405;&#20013;&#12290;</p><p>&#22312;&#39033;&#30446;&#30340; <code>resources</code> &#30446;&#24405;&#20013;&#28155;&#21152;&#19968;&#20010; applicationContext.xml&#65292;&#20869;&#23481;&#22914;&#20195;&#30721;&#31034;&#20363; 3-14 &#25152;&#31034;&#12290;&#21487;&#20197;&#30475;&#21040; XML &#25991;&#20214;&#21487;&#20197;&#23436;&#20840;&#21462;&#20195;&#27880;&#35299;&#26469;&#23454;&#29616; AOP &#30456;&#20851;&#30340;&#37197;&#32622;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-14</strong>&#12288;&#23436;&#25972;&#30340; <code>applicationContext.xml</code> &#25991;&#20214;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:aop="http://www.springframework.org/schema/aop"
        xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        https://www.springframework.org/schema/aop/spring-aop.xsd"&gt;

    &lt;aop:config&gt;
        &lt;aop:aspect ref="helloAspect" order="1"&gt;
            &lt;aop:before pointcut="target(learning.spring.helloworld.Hello) and args(words)"
                        method="addWords"/&gt;
        &lt;/aop:aspect&gt;

        &lt;aop:aspect ref="sayAspect" order="2"&gt;
            &lt;aop:before pointcut="execution(* say*(..)) and args(words)" method="countSentence" /&gt;
            &lt;aop:around pointcut="execution(* sayHello(..)) and this(bye)" method="addSay" /&gt;
            &lt;aop:declare-parents types-matching="learning.spring.helloworld.*"
                implement-interface="learning.spring.helloworld.GoodBye"
                default-impl="learning.spring.helloworld.DefaultGoodBye" /&gt;
        &lt;/aop:aspect&gt;
    &lt;/aop:config&gt;

    &lt;bean id="springHello" class="learning.spring.helloworld.SpringHello" /&gt;
    &lt;bean id="helloAspect" class="learning.spring.helloworld.HelloAspect" /&gt;
    &lt;bean id="sayAspect" class="learning.spring.helloworld.SayAspect" /&gt;

&lt;/beans&gt;</code></pre><p>&#30001;&#20110;&#23481;&#22120;&#30340;&#37197;&#32622;&#20351;&#29992;&#20102; XML &#25991;&#20214;&#65292;&#25152;&#20197;&#22312; <code>Application</code> &#31867;&#20013;&#20063;&#35201;&#20351;&#29992;&#23545;&#24212;&#30340;&#31867;&#26469;&#21152;&#36733;&#23481;&#22120;&#37197;&#32622;&#65292;&#26412;&#27425;&#25105;&#20204;&#36873;&#25321;&#20102; <code>ClassPathXmlApplicationContext</code>&#65292;&#20855;&#20307;&#30340;&#25191;&#34892;&#20195;&#30721;&#22914;&#20195;&#30721;&#31034;&#20363; 3-15 &#25152;&#31034;&#12290;&#36816;&#34892;&#21518;&#21487;&#20197;&#30475;&#21040;&#19982; 3.2.3 &#20013;&#19968;&#26679;&#30340;&#36755;&#20986;&#12290;</p><blockquote>
<p><strong>&#20195;&#30721;&#31034;&#20363; 3-15</strong>&#12288;<code>Application</code> &#31867;&#30340;&#20195;&#30721;&#29255;&#27573;</p>
</blockquote><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>public class Application {
    public static void main(String[] args) {
        ApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");

        Hello hello = applicationContext.getBean("springHello", Hello.class);
        System.out.println(hello.sayHello(new StringBuffer("My Friend. ")));
        System.out.println(hello.sayHello(new StringBuffer("My Dear Friend. ")));
    }
}</code></pre><p>&#23545;&#20110;&#21333;&#20803;&#27979;&#35797;&#65292;&#25105;&#20204;&#38656;&#35201;&#20570;&#30340;&#25913;&#21160;&#20063;&#38750;&#24120;&#23567;&#65292;&#20043;&#21069;&#30340; <code>@ContextConfiguration</code> &#20013;&#32473;&#30340;&#26159; Java &#37197;&#32622;&#31867;&#65292;&#36825;&#27425;&#23558;&#20854;&#25913;&#20026;&#25552;&#20379; CLASSPATH &#20013;&#30340; XML &#37197;&#32622;&#25991;&#20214;&#65292;&#20854;&#20313;&#19981;&#21160;&#65292;&#20855;&#20307;&#22914;&#19979;&#25152;&#31034;&#65306;</p><pre class="&#20195;&#30721;&#26080;&#34892;&#21495;"><code>@ExtendWith(SpringExtension.class)
@ContextConfiguration("classpath:applicationContext.xml")
public class ApplicationTest {
    // &#30465;&#30053;
}</code></pre><blockquote>
<p><strong>&#33590;&#27463;&#26102;&#38388;&#65306;&#36229;&#31616;&#27905;&#30340; JUnit &#21333;&#20803;&#27979;&#35797;&#20837;&#38376;</strong></p>
<p>&#22312;&#36825;&#20004;&#33410;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#37117;&#20351;&#29992;&#20102; JUnit 5 &#26469;&#36827;&#34892;&#33258;&#21160;&#21270;&#27979;&#35797;&#12290;&#26377;&#20102;&#33258;&#21160;&#21270;&#27979;&#35797;&#30340;&#20445;&#38556;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#22312;&#27599;&#27425;&#20462;&#25913;&#20195;&#30721;&#21518;&#24555;&#36895;&#36827;&#34892;&#39564;&#35777;&#65292;&#36825;&#26679;&#26082;&#33021;&#20445;&#38556;&#36136;&#37327;&#65292;&#21448;&#33021;&#33410;&#30465;&#22823;&#37327;&#20154;&#21147;&#12290;&#22240;&#27492;&#65292;&#24456;&#26377;&#24517;&#35201;&#20026;&#31995;&#32479;&#32534;&#20889;&#27979;&#35797;&#20195;&#30721;&#65292;&#20854;&#20013;&#21333;&#20803;&#27979;&#35797;&#21644;&#38598;&#25104;&#27979;&#35797;&#32570;&#19968;&#19981;&#21487;&#12290;</p>
<p>&#36890;&#36807;&#20195;&#30721;&#31034;&#20363; 3-12 &#21487;&#20197;&#30475;&#21040;&#65292;&#24102;&#26377; <code>@Test</code> &#27880;&#35299;&#30340;&#26041;&#27861;&#20250;&#34987;&#35270;&#20026;&#27979;&#35797;&#26041;&#27861;&#65292;&#22312;&#27979;&#35797;&#26041;&#27861;&#20013;&#21153;&#24517;&#20351;&#29992;&#26029;&#35328;&#36827;&#34892;&#21028;&#26029;&#65292;&#32780;&#19981;&#35201;&#29992;&#36755;&#20986;&#26085;&#24535;&#30340;&#26041;&#24335;&#36827;&#34892;&#20154;&#24037;&#35266;&#23519;&#65292;&#21542;&#21017;&#27979;&#35797;&#20195;&#30721;&#30340;&#20215;&#20540;&#20250;&#22823;&#25171;&#25240;&#25187;&#12290;<code>org.junit.jupiter.api.Assertions</code> &#31867;&#20013;&#25552;&#20379;&#20102;&#22823;&#37327;&#30340;&#26029;&#35328;&#38745;&#24577;&#26041;&#27861;&#65292;&#27604;&#22914;&#65306;</p>
<ul>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#21028;&#26029;&#20004;&#32773;&#26159;&#21542;&#30456;&#31561;&#30340; <code>assertEquals()</code> &#21644; <code>assertNotEquals()</code>&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#21028;&#26029;&#24067;&#23572;&#20540;&#30340; <code>assertTrue()</code> &#21644; <code>assertFalse()</code>&#65307;</li>
<li class="&#31532;2&#32423;&#26080;&#24207;&#21015;&#34920;">&#21028;&#26029;&#23545;&#35937;&#26159;&#21542;&#20026;&#31354;&#30340; <code>assertNull()</code> &#21644; <code>assertNotNull()</code>&#12290;</li>
</ul>
<p>&#22312;&#27599;&#20010;&#27979;&#35797;&#26041;&#27861;&#25191;&#34892;&#21069;&#21518;&#65292;&#37117;&#21487;&#20197;&#25191;&#34892;&#19968;&#20123;&#21021;&#22987;&#21270;&#21644;&#28165;&#29702;&#30340;&#36923;&#36753;&#65306;&#28155;&#21152;&#20102; <code>@BeforeEach</code> &#21644; <code>@AfterEach</code> &#30340;&#26041;&#27861;&#20250;&#20998;&#21035;&#22312;&#27979;&#35797;&#26041;&#27861;&#25191;&#34892;&#21069;&#21518;&#34987; JUnit &#25191;&#34892;&#65307;&#22914;&#26524;&#35201;&#22312;&#25152;&#26377;&#27979;&#35797;&#26041;&#27861;&#25191;&#34892;&#21069;&#36827;&#34892;&#24635;&#30340;&#21021;&#22987;&#21270;&#65292;&#21487;&#20197;&#20351;&#29992; <code>@BeforeAll</code> &#27880;&#35299;&#65292;&#23545;&#24212;&#30340;&#36824;&#26377;&#25152;&#26377;&#27979;&#35797;&#26041;&#27861;&#25191;&#34892;&#21518;&#25191;&#34892;&#30340; <code>@AfterAll</code>&#12290;</p>
<p>JUnit 5 &#21487;&#20197;&#36890;&#36807; <code>@ExtendWith</code> &#27880;&#35299;&#26469;&#28155;&#21152;&#25193;&#23637;&#65292;&#22312;&#25105;&#20204;&#30340;&#20363;&#23376;&#20013;&#65292;<code>@ExtendWith(SpringExtension.class)</code> &#23601;&#28155;&#21152;&#20102; Spring &#30340;&#27979;&#35797;&#25903;&#25345;&#65292;<code>@ContextConfiguration</code> &#27880;&#35299;&#25351;&#23450;&#20102;&#29992;&#26469;&#21021;&#22987;&#21270; Spring &#23481;&#22120;&#30340;&#37197;&#32622;&#31867;&#25110;&#37197;&#32622;&#25991;&#20214;&#12290;</p>
<p>&#20540;&#24471;&#19968;&#25552;&#30340;&#26159;&#65292;JUnit 4 &#21644; JUnit 5 &#22312; API &#23618;&#38754;&#23384;&#22312;&#19981;&#23569;&#24046;&#24322;&#65292;&#27604;&#22914; <code>@Before</code> &#21644; <code>@After</code> &#20998;&#21035;&#23545;&#24212;&#20102; <code>@BeforeEach</code> &#21644; <code>@AfterEach</code>&#65292;<code>@RunWith</code> &#23545;&#24212;&#20102; <code>@ExtendWith</code>&#65292;&#20004;&#20010;&#29256;&#26412;&#30340; <code>assertXxx()</code> &#38745;&#24577;&#26041;&#27861;&#25918;&#22312;&#20102;&#19981;&#21516;&#30340;&#31867;&#37324;&#31561;&#12290;&#22914;&#26524;&#22823;&#23478;&#36824;&#22312;&#20351;&#29992; JUnit 4&#65292;&#21487;&#20197;&#26597;&#38405;&#23448;&#26041;&#25991;&#26723;&#20102;&#35299;&#20855;&#20307;&#30340;&#29992;&#27861;&#12290;&#37492;&#20110; JUnit 5 &#22312;&#21151;&#33021;&#19978;&#26356;&#32988;&#19968;&#31609;&#65292;&#22914;&#26524;&#21487;&#20197;&#30340;&#35805;&#65292;&#24314;&#35758;&#22823;&#23478;&#36824;&#26159;&#20351;&#29992; JUnit 5&#65292;&#22312;&#26412;&#20070;&#21518;&#38754;&#30340;&#31456;&#33410;&#20063;&#20250;&#26377;&#26356;&#22810;&#20851;&#20110; Spring &#30340;&#27979;&#35797;&#25903;&#25345;&#30340;&#20363;&#23376;&#12290;</p>
</blockquote><h2 id="nav_point_56">3.4&#12288;&#23567;&#32467;</h2><p>&#36890;&#36807;&#26412;&#31456;&#30340;&#23398;&#20064;&#65292;&#30456;&#20449;&#22823;&#23478;&#24050;&#32463;&#23545; Spring AOP &#26377;&#20102;&#19968;&#20010;&#22522;&#26412;&#30340;&#35748;&#35782;&#65306;&#20102;&#35299;&#20102; AOP &#30340;&#26680;&#24515;&#27010;&#24565;&#20197;&#21450; Spring Framework &#20013; AOP &#30340;&#23454;&#29616;&#21407;&#29702;&#65307;&#23398;&#20064;&#20102; Spring Framework &#25552;&#20379;&#30340;&#20004;&#31181;&#37197;&#32622;&#26041;&#24335;&#65292;&#22823;&#23478;&#21487;&#20197;&#26681;&#25454;&#23454;&#38469;&#24773;&#20917;&#36873;&#25321;&#20351;&#29992;&#22522;&#20110; <code>@AspectJ</code> &#27880;&#35299;&#30340;&#26041;&#24335;&#65292;&#25110;&#32773;&#22522;&#20110; <code>&lt;aop/&gt;</code>XML Schema &#30340;&#26041;&#24335;&#65288;&#26080;&#35770;&#21738;&#31181;&#26041;&#24335;&#65292;&#20854;&#20013;&#23545;&#20999;&#38754;&#12289;&#20999;&#20837;&#28857;&#21644;&#36890;&#30693;&#30340;&#23450;&#20041;&#22823;&#21516;&#23567;&#24322;&#65289;&#12290;</p><p>&#27492;&#22806;&#65292;&#26412;&#31456;&#30340;&#20004;&#20010; <code>Hello</code> &#31034;&#20363;&#65292;&#37117;&#25552;&#20379;&#20102;&#22522;&#20110; JUnit 5 &#30340;&#33258;&#21160;&#21270;&#27979;&#35797;&#20195;&#30721;&#65292;&#28436;&#31034;&#20102;&#22914;&#20309;&#36890;&#36807;&#21333;&#20803;&#27979;&#35797;&#26469;&#39564;&#35777;&#20195;&#30721;&#30340;&#36923;&#36753;&#12290;&#24076;&#26395;&#22823;&#23478;&#22312;&#26085;&#24120;&#24037;&#20316;&#20013;&#33021;&#26356;&#22810;&#22320;&#20351;&#29992;&#36825;&#31181;&#27979;&#35797;&#26041;&#24335;&#65292;&#26412;&#20070;&#21518;&#32493;&#31456;&#33410;&#20063;&#20250;&#26377;&#26356;&#22810;&#36825;&#26041;&#38754;&#30340;&#20869;&#23481;&#12290;</p><p>&#19979;&#19968;&#31456;&#65292;&#25105;&#20204;&#20250;&#20174; Spring Framework &#36827;&#20837; Spring Boot &#30340;&#39046;&#22495;&#65292;&#20026;&#22823;&#23478;&#20171;&#32461; Spring Boot &#30340;&#20960;&#20010;&#26680;&#24515;&#21151;&#33021;&#12290;</p><br style="page-break-after:always"/><div style="page-break-after:always"></div>